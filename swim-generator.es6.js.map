{"version":3,"file":"swim-generator.es6.js","sources":["../lib/data/warmups.js","../lib/data/cooldowns.js","../lib/workoutGenerator.js","../lib/data/mainSetConfigs.js","../lib/data/mainSets.js","../lib/workoutComponents.js","../lib/css.js","../lib/getThingViaTimeLimit.js","../lib/repeatIntervals.js","../lib/createPattern.js","../lib/index.js"],"sourcesContent":["// Warmup options based on various sources [2, 5, 7, 8, 11, 13, 15, 17, 19, 20]\nconst warmups = [\n    { desc: \"200 no fins, 200 w fins swim\", dist: 400, type: \"swim\" }, //[2]\n    { desc: \"400 warmup (75 kick, 25 under)\", dist: 400, type: \"kick\" }, //[5]\n    { desc: \"250 pull warmup, 250 swim warmup\", dist: 500, type: \"pull/swim\" }, //[20]\n    { desc: \"250 warmup\", dist: 250, type: \"general\" }, //[8, 13]\n    { desc: \"200 warm up\", dist: 200, type: \"general\" }, //[7]\n    { desc: \"500 warmup\", dist: 500, type: \"general\" }, //[11, 17]\n    { desc: \"300 warm up\", dist: 300, type: \"general\" }, //[15]\n    { desc: \"150 warm up\", dist: 150, type: \"general\" }, //[19]\n];\n\n// Option for no warmup, as seen in some sources [1, 9]\nconst noWarmupOption = { desc: \"No warmup bitches\", dist: 0, type: \"none\" }; //[1]\n\nexport { warmups, noWarmupOption };\n","// Cool-down options based on various sources [2, 5, 7, 9, 10, 12, 13, 16, 17, 19-21]\nconst cooldowns = [\n    { desc: \"200 w fins (or combo)\", dist: 200, type: \"fins\" }, //[2]\n    { desc: \"200 swim cooldown\", dist: 200, type: \"swim\" }, //[5]\n    { desc: \"100 cool down\", dist: 100, type: \"general\" }, //[7]\n    { desc: \"300 CD\", dist: 300, type: \"general\" }, //[9]\n    { desc: \"200 CD\", dist: 200, type: \"general\" }, //[10, 16, 21]\n    { desc: \"450 cooldown (300 swim, 150 under)\", dist: 450, type: \"swim/under\" }, //[20]\n    { desc: \"100 cool\", dist: 100, type: \"general\" }, //[17]\n    { desc: \"150 cooldown and 20 minutes of stick skills\", dist: 150, type: \"general\" }, //[19]\n    { desc: \"100 fin swim cooldown\", dist: 100, type: \"fin swim\" }, //[12]\n    { desc: \"250 cool down\", dist: 250, type: \"general\" }, //[13]\n];\n\nexport { cooldowns };\n","// lib/workoutGenerator.js - V3_SCHEMA_UPDATE_MARKER_GENERATOR\nimport _ from 'lodash';\n\n// --- Helper Functions ---\n\nfunction calculateTargetPace(cssSecondsPer100, paceConfig) {\n    if (!paceConfig || typeof cssSecondsPer100 !== 'number') {\n        return cssSecondsPer100;\n    }\n    let pace = cssSecondsPer100;\n    const offset = paceConfig.offset || 0;\n    const randomRange = paceConfig.randomRange || 0;\n    let randomComponent = 0;\n    if (randomRange > 0) {\n        randomComponent = Math.random() * randomRange;\n    }\n    const totalAdjustment = offset + randomComponent;\n    if (paceConfig.operator === \"+\") {\n        pace += totalAdjustment;\n    } else if (paceConfig.operator === \"-\") {\n        pace -= totalAdjustment;\n    }\n    return pace;\n}\n\nfunction formatDescriptiveMessage(template, params) {\n    if (!template) return \"No descriptive message template provided.\";\n    let message = template;\n    for (const key in params) {\n        if (params[key] !== undefined) {\n            message = message.replace(new RegExp(`{${key}}`, 'g'), params[key]);\n        }\n    }\n    message = message.replace(/{[^}]+}/g, '');\n    return message.trim();\n}\n\nfunction formatSetString(setInfo, energySystem, formatConfig) {\n    let structure = formatConfig.baseStructure || \"{reps}x{dist} {activity} ({energySystem} focus) {rest}\";\n    structure = structure.replace(\"{reps}\", setInfo.reps);\n    structure = structure.replace(\"{dist}\", setInfo.dist);\n    structure = structure.replace(\"{activity}\", setInfo.activity || formatConfig.defaultActivity || \"swim\");\n    structure = structure.replace(\"{energySystem}\", energySystem);\n    structure = structure.replace(\"{rest}\", setInfo.restString || \"\");\n    structure = structure.replace(\"{paceDesc}\", setInfo.paceDesc || \"\");\n    structure = structure.replace(\"{notes}\", setInfo.notes || \"\"); // Added notes\n    return structure.trim().replace(/\\s\\s+/g, ' ').replace(/\\s\\(@/g, ' @').replace(/\\s\\(\\s*,/g, ' (').replace(/,\\s*\\)/g, ')').replace(/\\(\\s*\\)/g, ''); // Clean up\n}\n\nfunction getRestString(repDist, restConfig, patternRestValue) {\n    if (!restConfig) return 'r10\"';\n    switch (restConfig.type) {\n        case \"fixed\": return restConfig.value;\n        case \"customFunction\":\n            if (typeof restConfig.customFunction === 'function') return restConfig.customFunction(repDist);\n            return 'r10\"';\n        case \"distanceBased\": {\n            const sortedKeys = Object.keys(restConfig.values).filter(k => k !== 'default').map(Number).sort((a, b) => b - a);\n            for (const keyDist of sortedKeys) {\n                if (repDist >= keyDist) return restConfig.values[keyDist];\n            }\n            return restConfig.values.default || 'r10\"';\n        }\n        case \"patternDefined\": return patternRestValue || \"\";\n        default: return 'r10\"';\n    }\n}\n\n// --- Strategy Implementations ---\n\nfunction generateSet_BestFitSingleRepetition(remainingDistance, strategyConfig, restConfig, energySystem, setFormattingConfig) {\n    const { setDefinitions, selectionPreference } = strategyConfig; // Use setDefinitions\n    const shuffledSetDefinitions = _.shuffle(setDefinitions);\n    let bestOption = { setDef: null, reps: 0, totalYardage: 0, isPreferredShorter: false };\n\n    for (const setDef of shuffledSetDefinitions) { // Iterate over shuffledSetDefinitions\n        const currentDist = setDef.distance;\n        if (setDef.repScheme.type === \"dynamic\" && remainingDistance >= currentDist) {\n            let currentReps = Math.floor(remainingDistance / currentDist);\n            if (currentReps === 0) continue;\n\n            const maxReps = setDef.repScheme.maxReps || Infinity;\n            currentReps = Math.min(currentReps, maxReps);\n            if (setDef.repScheme.minReps) {\n                currentReps = Math.max(currentReps, setDef.repScheme.minReps);\n                if (currentReps * currentDist > remainingDistance) continue; // Not enough for minReps\n            }\n\n\n            if (currentReps > 0) {\n                const currentTotalYardage = currentReps * currentDist;\n                const isCurrentDistPreferredShorter = selectionPreference.shorterRepValue && currentDist === selectionPreference.shorterRepValue;\n\n                if (currentTotalYardage > bestOption.totalYardage) {\n                    bestOption = { setDef, reps: currentReps, totalYardage: currentTotalYardage, isPreferredShorter: isCurrentDistPreferredShorter };\n                } else if (currentTotalYardage === bestOption.totalYardage) {\n                    if (selectionPreference.tiebreakYardage === \"preferShorterRepIfSameYardageThenMoreReps\") {\n                        if (!bestOption.isPreferredShorter && isCurrentDistPreferredShorter) {\n                            bestOption = { setDef, reps: currentReps, totalYardage: currentTotalYardage, isPreferredShorter: isCurrentDistPreferredShorter };\n                        } else if (bestOption.isPreferredShorter === isCurrentDistPreferredShorter && currentReps > bestOption.reps) {\n                            bestOption = { setDef, reps: currentReps, totalYardage: currentTotalYardage, isPreferredShorter: isCurrentDistPreferredShorter };\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    if (bestOption.reps > 0 && bestOption.setDef) {\n        const chosenSetDef = bestOption.setDef;\n        const rest = chosenSetDef.rest || getRestString(chosenSetDef.distance, restConfig); // Prioritize setDef.rest\n        const setInfo = {\n            reps: bestOption.reps,\n            dist: chosenSetDef.distance,\n            restString: rest,\n            activity: chosenSetDef.activity || setFormattingConfig.defaultActivity || \"swim\",\n            paceDesc: chosenSetDef.paceDescription, // Pass through if available\n            notes: chosenSetDef.notes,\n        };\n        return {\n            generatedSets: [setInfo],\n            totalDistance: bestOption.totalYardage,\n            strategySpecificSummary: `${bestOption.reps}x${chosenSetDef.distance}`,\n            restSummary: rest\n        };\n    }\n    return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"No suitable reps found.\" };\n}\n\nfunction generateSet_ClosestFitGeneral(remainingDistance, strategyConfig, restConfig, energySystem, setFormattingConfig) {\n    const { setDefinitions, minRepDistanceForFallback, conservativeAdjustment } = strategyConfig; // Use setDefinitions\n    const shuffledSetDefinitions = _.shuffle(setDefinitions);\n    let bestRepDist = 0;\n    let bestNumReps = 0;\n    let smallestRemainder = Infinity;\n    let chosenSetDef = null;\n\n    for (const setDef of shuffledSetDefinitions) { // Iterate over shuffledSetDefinitions\n        const dist = setDef.distance;\n        if (remainingDistance >= dist) {\n            let currentNumReps = Math.floor(remainingDistance / dist);\n            let currentRemainder = remainingDistance - (currentNumReps * dist);\n            if (currentNumReps > 0) {\n                if (currentRemainder < smallestRemainder) {\n                    smallestRemainder = currentRemainder;\n                    bestRepDist = dist;\n                    bestNumReps = currentNumReps;\n                    chosenSetDef = setDef;\n                } else if (currentRemainder === smallestRemainder) {\n                    if (dist > bestRepDist) {\n                        bestRepDist = dist;\n                        bestNumReps = currentNumReps;\n                        chosenSetDef = setDef;\n                    }\n                }\n            }\n        }\n    }\n\n    if (bestNumReps === 0 && remainingDistance >= minRepDistanceForFallback) {\n        if (remainingDistance >= 50) {\n             bestRepDist = Math.floor(remainingDistance / 50) * 50;\n             if(bestRepDist === 0) bestRepDist = 50;\n        } else {\n             bestRepDist = minRepDistanceForFallback;\n        }\n        if (bestRepDist > 0) bestNumReps = Math.floor(remainingDistance / bestRepDist);\n        if (bestNumReps * bestRepDist > remainingDistance || (bestNumReps === 0 && bestRepDist > 0 && remainingDistance >= bestRepDist) ) {\n            if (remainingDistance >= bestRepDist && bestRepDist > 0) bestNumReps = Math.floor(remainingDistance/bestRepDist);\n            else bestNumReps = 0;\n        }\n        if (bestNumReps > 0) { // Find a matching setDef for fallback or use defaults\n            chosenSetDef = setDefinitions.find(sd => sd.distance === bestRepDist) || { distance: bestRepDist };\n        }\n    }\n\n    if (bestNumReps > 0 && bestRepDist > 0 && conservativeAdjustment && conservativeAdjustment.enabled) {\n        let calculatedDist = bestNumReps * bestRepDist;\n        if (calculatedDist > remainingDistance * conservativeAdjustment.usageThresholdFactor &&\n            bestRepDist >= conservativeAdjustment.minRepDistance &&\n            bestNumReps >= conservativeAdjustment.minReps) {\n            bestNumReps--;\n        }\n    }\n\n    if (bestNumReps > 0 && bestRepDist > 0 && chosenSetDef) {\n        const rest = chosenSetDef.rest || getRestString(bestRepDist, restConfig);\n        const setInfo = {\n            reps: bestNumReps,\n            dist: bestRepDist,\n            restString: rest,\n            activity: chosenSetDef.activity || setFormattingConfig.defaultActivity || \"swim\",\n            paceDesc: chosenSetDef.paceDescription,\n            notes: chosenSetDef.notes,\n        };\n        return {\n            generatedSets: [setInfo],\n            totalDistance: bestNumReps * bestRepDist,\n            strategySpecificSummary: `${bestNumReps}x${bestRepDist}`,\n            restSummary: rest\n        };\n    }\n    return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"No suitable reps found.\" };\n}\n\nfunction generateSet_TargetYardageRepChoice(remainingDistance, strategyConfig, restConfig, energySystem, setFormattingConfig) {\n    const {\n        setTargetDistanceMin,\n        setTargetDistanceMaxDefault,\n        setTargetDistanceMaxCap,\n        setDefinitions, // Use setDefinitions\n        repChoiceLogic\n    } = strategyConfig;\n    const shuffledSetDefinitions = _.shuffle(setDefinitions);\n\n    let actualTargetYardage = Math.min(remainingDistance, setTargetDistanceMaxCap);\n    actualTargetYardage = Math.max(actualTargetYardage, setTargetDistanceMin);\n    if(setTargetDistanceMaxDefault) {\n        actualTargetYardage = Math.min(actualTargetYardage, setTargetDistanceMaxDefault);\n    }\n\n    const availableRepDistances = shuffledSetDefinitions.map(sd => sd.distance).sort((a,b)=>a-b);\n    if (availableRepDistances.length === 0 || actualTargetYardage < availableRepDistances[0]) {\n        return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"Target yardage too low for any rep or no definitions.\" };\n    }\n\n    let chosenSetDef = null;\n    const preferredSetDef = shuffledSetDefinitions.find(sd => sd.distance === repChoiceLogic.preferDistance);\n\n    if (preferredSetDef && actualTargetYardage >= preferredSetDef.distance && actualTargetYardage >= repChoiceLogic.thresholdYardage) {\n        chosenSetDef = preferredSetDef;\n    } else {\n        const sortedAvailableSetDefs = shuffledSetDefinitions.filter(sd => actualTargetYardage >= sd.distance).sort((a,b) => a.distance - b.distance);\n        if(sortedAvailableSetDefs.length > 0) {\n            chosenSetDef = sortedAvailableSetDefs[0];\n        }\n    }\n\n    if (!chosenSetDef) {\n         return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"Could not select rep distance for target.\" };\n    }\n\n    const repDist = chosenSetDef.distance;\n    let numReps = Math.floor(actualTargetYardage / repDist);\n    numReps = Math.max(numReps, 1);\n\n    const currentSetTotalYardage = numReps * repDist;\n\n    if (currentSetTotalYardage > 0) {\n        const rest = chosenSetDef.rest || getRestString(repDist, restConfig);\n        const setInfo = {\n            reps: numReps,\n            dist: repDist,\n            restString: rest,\n            activity: chosenSetDef.activity || setFormattingConfig.defaultActivity || \"sprint\",\n            paceDesc: chosenSetDef.paceDescription,\n            notes: chosenSetDef.notes,\n        };\n        return {\n            generatedSets: [setInfo],\n            totalDistance: currentSetTotalYardage,\n            strategySpecificSummary: `${numReps}x${repDist}`,\n            restSummary: rest\n        };\n    }\n    return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"Calculated zero yardage.\" };\n}\n\nfunction generateSet_MultiBlock(remainingDistance, strategyConfig, restConfig) {\n    const {\n        setTargetDistanceMin,\n        setTargetDistanceMaxCap,\n        targetYardagePerBlockApprox,\n        setDefinitions, // Use setDefinitions\n        drills, // Keep drills separate as it's a pool of choices for activity\n        interBlockRest\n    } = strategyConfig;\n    const shuffledSetDefinitions = _.shuffle(setDefinitions);\n\n    let setsOutput = [];\n    let accumulatedDistInSet = 0;\n    const availableRepDistances = shuffledSetDefinitions.map(sd => sd.distance).sort((a,b) => a-b);\n    if (availableRepDistances.length === 0) {\n        return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"No set definitions provided for MultiBlock.\" };\n    }\n    const smallestRepDist = availableRepDistances[0];\n\n    let targetOverallYardage = Math.min(remainingDistance, setTargetDistanceMaxCap);\n    targetOverallYardage = Math.max(targetOverallYardage, setTargetDistanceMin);\n\n    if (targetOverallYardage < smallestRepDist) {\n        return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"Overall target yardage too low.\" };\n    }\n\n    let numBlocks = Math.max(1, Math.ceil(targetOverallYardage / targetYardagePerBlockApprox));\n    let remainingForBlocksAllocation = targetOverallYardage;\n\n    for (let i = 0; i < numBlocks; i++) {\n        if (remainingForBlocksAllocation <= 0 || accumulatedDistInSet >= targetOverallYardage) break;\n        if (remainingForBlocksAllocation < smallestRepDist) break;\n\n        let distForCurrentBlockTarget = Math.floor(remainingForBlocksAllocation / (numBlocks - i));\n        distForCurrentBlockTarget = Math.min(distForCurrentBlockTarget, remainingForBlocksAllocation);\n\n        if (distForCurrentBlockTarget < smallestRepDist) continue;\n\n        // Select a SetDefinition for the block (randomly from those that fit)\n        const suitableSetDefs = shuffledSetDefinitions.filter(sd => sd.distance <= distForCurrentBlockTarget);\n        if (suitableSetDefs.length === 0) continue;\n        let chosenSetDef = suitableSetDefs[Math.floor(Math.random() * suitableSetDefs.length)];\n\n        // If random choice too large, pick largest that fits (already somewhat handled by filter, but good check)\n        // This part of logic might need refinement if random choice is strictly preferred.\n        // For now, ensure it fits:\n        if (chosenSetDef.distance > distForCurrentBlockTarget) {\n             const possibleSetDefs = suitableSetDefs.sort((a,b) => b.distance - a.distance); // get largest\n             if (possibleSetDefs.length > 0) chosenSetDef = possibleSetDefs[0];\n             else continue;\n        }\n\n        const currentRepDist = chosenSetDef.distance;\n        const maxRepsForThisDist = chosenSetDef.repScheme.maxReps || Infinity; // Max reps for this specific distance\n\n        let numReps = Math.floor(distForCurrentBlockTarget / currentRepDist);\n        numReps = Math.min(numReps, maxRepsForThisDist);\n        numReps = Math.max(numReps, chosenSetDef.repScheme.minReps || 1);\n\n        if (numReps * currentRepDist > distForCurrentBlockTarget) {\n             numReps = Math.floor(distForCurrentBlockTarget / currentRepDist);\n        }\n        if (numReps === 0) continue;\n\n        const currentBlockActualYardage = numReps * currentRepDist;\n        if (currentBlockActualYardage > 0) {\n            const blockRepRest = chosenSetDef.rest || getRestString(currentRepDist, restConfig);\n            const drillType = chosenSetDef.activity || drills[Math.floor(Math.random() * drills.length)]; // Prefer activity from setDef\n\n            setsOutput.push({\n                reps: numReps, dist: currentRepDist, activity: drillType, restString: blockRepRest, type: 'mainSetItem',\n                paceDesc: chosenSetDef.paceDescription, notes: chosenSetDef.notes,\n            });\n            accumulatedDistInSet += currentBlockActualYardage;\n            remainingForBlocksAllocation -= currentBlockActualYardage;\n\n            if (i < numBlocks - 1 && remainingForBlocksAllocation >= smallestRepDist && accumulatedDistInSet < targetOverallYardage) {\n                const restSecondsVal = interBlockRest.minSeconds + Math.floor(Math.random() * (interBlockRest.maxSeconds - interBlockRest.minSeconds + 1));\n                const formattedBlockRestText = typeof interBlockRest.format === 'function' ?\n                    interBlockRest.format(restSecondsVal) : `${restSecondsVal}s rest`;\n                setsOutput.push({ type: 'blockRestItem', text: formattedBlockRestText });\n            }\n        }\n    }\n\n    if (accumulatedDistInSet > 0) {\n        return {\n            generatedSets: setsOutput,\n            totalDistance: accumulatedDistInSet,\n            strategySpecificSummary: `${setsOutput.filter(s=>s.type==='mainSetItem').length} block(s), total ${accumulatedDistInSet}yds`,\n            restSummary: \"Varied\"\n        };\n    }\n    return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"No blocks generated.\" };\n}\n\nfunction generateSet_PatternBased(remainingDistance, strategyConfig, restConfig, setFormattingConfig) {\n    const { setDefinitions, selectionLogic, fallbackStrategy } = strategyConfig; // Use setDefinitions\n    const shuffledSetDefinitions = _.shuffle(setDefinitions);\n    let viablePatterns = [];\n    // console.log('[PatternBased] Initial remainingDistance:', remainingDistance);\n    // console.log('[PatternBased] Shuffled setDefinitions:', JSON.stringify(shuffledSetDefinitions, null, 2));\n\n    for (const setDef of shuffledSetDefinitions) { // Iterate shuffledSetDefinitions\n        // console.log('[PatternBased] Considering setDef:', JSON.stringify(setDef, null, 2));\n        if (setDef.repScheme.type === 'dynamic' && setDef.distance) {\n            // console.log('[PatternBased] Is dynamic');\n            if (remainingDistance >= setDef.distance) {\n                let numReps = Math.floor(remainingDistance / setDef.distance);\n                if (setDef.repScheme.maxReps) numReps = Math.min(numReps, setDef.repScheme.maxReps);\n                if (setDef.repScheme.minReps) numReps = Math.max(numReps, setDef.repScheme.minReps);\n\n                if (numReps > 0 && (numReps * setDef.distance <= remainingDistance) ) {\n                    viablePatterns.push({\n                        ...setDef, // Includes original distance, rest, paceDesc, etc.\n                        reps: numReps,\n                        // dist: setDef.distance, // Already in setDef\n                            totalDistance: numReps * setDef.distance, // Corrected property name\n                        id: setDef.id || `${numReps}x${setDef.distance}` // Use existing ID or format\n                    });\n                }\n            }\n        } else if (setDef.repScheme.type === 'fixed' && setDef.totalDistance) {\n            // console.log('[PatternBased] Is fixed type');\n            if (remainingDistance >= setDef.totalDistance) {\n                // console.log('[PatternBased] Adding fixed setDef to viablePatterns:', JSON.stringify(setDef));\n                // For fixed, reps and dist are already defined in setDef.repScheme.fixedReps and setDef.distance\n                viablePatterns.push({ ...setDef, reps: setDef.repScheme.fixedReps });\n            } else {\n                // console.log('[PatternBased] Fixed setDef totalDistance too high:', setDef.totalDistance);\n            }\n        }\n    }\n    // console.log('[PatternBased] ViablePatterns:', JSON.stringify(viablePatterns, null, 2));\n\n    let bestFitSet = null;\n    if (viablePatterns.length > 0) {\n        // console.log('[PatternBased] Viable patterns found. SelectionLogic:', selectionLogic);\n        if (selectionLogic === \"maxAchievedDistance\") {\n             viablePatterns.sort((a, b) => {\n                if (b.totalDistance !== a.totalDistance) return b.totalDistance - a.totalDistance;\n                // Approx original index for tie-breaking (now randomized due to shuffledSetDefinitions)\n                // Ensure 'a' and 'b' passed to findIndex are from the original shuffledSetDefinitions if 'id' is not unique enough\n                // or if viablePatterns objects are modified copies that break === identity.\n                // However, given typical use, matching by 'id' should be robust enough.\n                return shuffledSetDefinitions.findIndex(sd => sd.id === a.id) - shuffledSetDefinitions.findIndex(sd => sd.id === b.id);\n            });\n            bestFitSet = viablePatterns[0];\n        } else if (selectionLogic === \"prioritizeMaxDistanceThenRandom\") {\n            let maxDist = 0;\n            // Ensure using totalDistance, which is the correct property name from setDef\n            viablePatterns.forEach(p => { if (p.totalDistance > maxDist) maxDist = p.totalDistance; });\n            const bestDistancePatterns = viablePatterns.filter(p => p.totalDistance === maxDist);\n            if (bestDistancePatterns.length > 0) {\n                bestFitSet = bestDistancePatterns[Math.floor(Math.random() * bestDistancePatterns.length)];\n            }\n        } else {\n            bestFitSet = viablePatterns[0];\n        }\n    }\n\n    if (!bestFitSet && fallbackStrategy && fallbackStrategy.setDefinitions && remainingDistance >= fallbackStrategy.minRepDistance) { // Check fallbackStrategy.setDefinitions\n        // If fallbackStrategy.setDefinitions are derived from the main setDefinitions, they should be shuffled too.\n        // Assuming they might be a distinct list, we shuffle them here if they exist.\n        // If they are guaranteed to be a subset of the already shuffled main list, this specific shuffle might be redundant\n        // but harmless. If they are a completely separate list, this is necessary.\n        const shuffledFallbackSetDefinitions = fallbackStrategy.setDefinitions ? _.shuffle(fallbackStrategy.setDefinitions) : [];\n\n        if (fallbackStrategy.type === \"simpleRepsMaxDistance\") {\n            let bestFallbackOption = null;\n            let maxFallbackYardage = 0;\n            for (const fbSetDef of shuffledFallbackSetDefinitions) { // Iterate shuffledFallbackSetDefinitions\n                if (remainingDistance >= fbSetDef.distance) {\n                    let numReps = Math.floor(remainingDistance / fbSetDef.distance);\n                    if (fbSetDef.repScheme && fbSetDef.repScheme.maxReps) { // Assume fallback options are dynamic\n                       numReps = Math.min(numReps, fbSetDef.repScheme.maxReps);\n                    }\n                    if (fbSetDef.repScheme && fbSetDef.repScheme.minReps) {\n                        numReps = Math.max(numReps, fbSetDef.repScheme.minReps);\n                    }\n\n                    if (numReps > 0 && (numReps * fbSetDef.distance <= remainingDistance)) {\n                        const currentYardage = numReps * fbSetDef.distance;\n                        if (currentYardage > maxFallbackYardage) {\n                            maxFallbackYardage = currentYardage;\n                            bestFallbackOption = {\n                                ...fbSetDef,\n                                reps: numReps,\n                                totalDistance: currentYardage, // Corrected here\n                                id: fbSetDef.id || `${numReps}x${fbSetDef.distance} (fallback)`\n                            };\n                            // console.log(`[FallbackDebug] Set bestFallbackOption: ${JSON.stringify(bestFallbackOption, null, 2)} with yardage ${currentYardage}`);\n                        }\n                    }\n                }\n            }\n            if (bestFallbackOption) bestFitSet = bestFallbackOption;\n            // console.log(`[FallbackDebug] After loop, bestFallbackOption: ${JSON.stringify(bestFallbackOption, null, 2)}`);\n        }\n    }\n    // console.log(`[FallbackDebug] Before final return, bestFitSet: ${JSON.stringify(bestFitSet, null, 2)}`);\n\n    if (bestFitSet) {\n        // console.log(`[FallbackDebug] bestFitSet IS valid, creating setInfo.`);\n        const rest = bestFitSet.rest || getRestString(bestFitSet.distance, restConfig, bestFitSet.rest);\n        const setInfo = {\n            reps: bestFitSet.reps,\n            dist: bestFitSet.distance,\n            restString: rest,\n            paceDesc: bestFitSet.paceDescription,\n            activity: bestFitSet.activity || setFormattingConfig.defaultActivity || \"swim\",\n            notes: bestFitSet.notes,\n        };\n        return {\n            generatedSets: [setInfo], totalDistance: bestFitSet.totalDistance, // Corrected from totalDist\n            strategySpecificSummary: bestFitSet.id || `${bestFitSet.reps}x${bestFitSet.distance}`,\n            restSummary: rest, paceDescription: bestFitSet.paceDescription\n        };\n    }\n    return { generatedSets: [], totalDistance: 0, strategySpecificSummary: \"No pattern or fallback matched.\" };\n}\n\n// --- Main Generator Function ---\nexport function generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, config) {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = 0;\n    let descriptiveMessage = \"\";\n\n    if (!config) {\n        return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: \"Error: Workout configuration not provided.\" };\n    }\n\n    targetPacePer100 = calculateTargetPace(cssSecondsPer100, config.paceConfig);\n\n    const getMinRepDistForType = (cfg) => {\n        if (!cfg || !cfg.strategyConfig) return cfg?.minTotalDistanceForSet || 0;\n\n        let minDist = Infinity;\n        if (cfg.strategyConfig.setDefinitions && cfg.strategyConfig.setDefinitions.length > 0) {\n            cfg.strategyConfig.setDefinitions.forEach(sd => {\n                if (sd.distance < minDist) minDist = sd.distance;\n            });\n        }\n        // Check fallback definitions too, if they exist\n        if (cfg.strategyConfig.fallbackStrategy && cfg.strategyConfig.fallbackStrategy.setDefinitions && cfg.strategyConfig.fallbackStrategy.setDefinitions.length > 0) {\n             cfg.strategyConfig.fallbackStrategy.setDefinitions.forEach(sd => {\n                if (sd.distance < minDist) minDist = sd.distance;\n            });\n        }\n        // If still Infinity, means no distances found, use fallbackStrategy.minRepDistance or overall minTotalDistanceForSet\n        if (minDist === Infinity) {\n            minDist = cfg.strategyConfig.fallbackStrategy?.minRepDistance || cfg.minTotalDistanceForSet || 0;\n        }\n        // Final fallback to minTotalDistanceForSet if all else fails or gives 0 but minTotalDistanceForSet is higher\n        return Math.max(minDist, cfg.minTotalDistanceForSet || 0) ;\n    };\n\n\n    if (config.minTotalDistanceForSet && remainingDistanceForMainSet < config.minTotalDistanceForSet) {\n        descriptiveMessage = formatDescriptiveMessage(config.descriptiveMessages.tooShort, {\n            workoutTypeName: config.workoutTypeName,\n            minRepDistForType: String(getMinRepDistForType(config)), // Updated to use the new logic\n            remainingDistance: String(remainingDistanceForMainSet)\n        });\n        return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage };\n    }\n\n    let strategyResult;\n    const strategyFnMap = {\n        \"bestFitSingleRepetition\": generateSet_BestFitSingleRepetition,\n        \"closestFitGeneral\": generateSet_ClosestFitGeneral,\n        \"targetYardageWithRepChoice\": generateSet_TargetYardageRepChoice,\n        \"multiBlock\": generateSet_MultiBlock,\n        \"patternBased\": generateSet_PatternBased,\n    };\n\n    const strategyFn = strategyFnMap[config.setGenerationStrategy];\n\n    if (typeof strategyFn === 'function') {\n        if (config.setGenerationStrategy === \"patternBased\") {\n            strategyResult = strategyFn(remainingDistanceForMainSet, config.strategyConfig, config.restConfig, config.setFormatting);\n        } else if (config.setGenerationStrategy === \"multiBlock\") {\n            strategyResult = strategyFn(remainingDistanceForMainSet, config.strategyConfig, config.restConfig);\n        } else {\n            strategyResult = strategyFn(remainingDistanceForMainSet, config.strategyConfig, config.restConfig, energySystem, config.setFormatting);\n        }\n    } else {\n        descriptiveMessage = `Error: Unknown/unimplemented strategy: ${config.setGenerationStrategy || 'undefined'}`;\n        return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage };\n    }\n\n    if (strategyResult && strategyResult.generatedSets && strategyResult.generatedSets.length > 0 && strategyResult.totalDistance > 0) {\n        mainSetTotalDist = strategyResult.totalDistance;\n        strategyResult.generatedSets.forEach(item => {\n            if (item.type === 'blockRestItem') {\n                sets.push(item.text);\n            } else {\n                 sets.push(formatSetString(item, energySystem, config.setFormatting));\n            }\n        });\n\n        let paceSummaryText = \"CSS\";\n        if (config.paceConfig) {\n            const pc = config.paceConfig;\n            if (pc.offset === 0 && !pc.randomRange) { /* paceSummaryText already \"CSS\" */ }\n            else if (pc.operator && (pc.offset || pc.randomRange)) {\n                 let basePaceDesc = \"CSS \";\n                 let offsetPart = \"\";\n                 if (pc.offset) {\n                    offsetPart = `${pc.operator}${pc.offset}`;\n                 }\n                 if (pc.randomRange) {\n                    const rangeEnd = pc.offset + pc.randomRange;\n                    if (pc.offset && Math.abs(rangeEnd) !== Math.abs(pc.offset)) {\n                        offsetPart += `-${Math.abs(rangeEnd)}`;\n                    } else if (!pc.offset) {\n                        offsetPart = `${pc.operator}0-${Math.abs(pc.randomRange)}`;\n                    }\n                 }\n                 paceSummaryText = basePaceDesc + offsetPart + \"s/100m\";\n            }\n        }\n\n        descriptiveMessage = formatDescriptiveMessage(config.descriptiveMessages.success, {\n            workoutTypeName: config.workoutTypeName,\n            setSummary: strategyResult.strategySpecificSummary || \"Set generated\",\n            energySystem: energySystem,\n            totalDistance: String(mainSetTotalDist),\n            paceDescription: strategyResult.paceDescription || paceSummaryText,\n            restSummary: strategyResult.restSummary || \"Varied rest\",\n        });\n\n    } else {\n        mainSetTotalDist = 0;\n        descriptiveMessage = formatDescriptiveMessage(config.descriptiveMessages.fail, {\n            workoutTypeName: config.workoutTypeName,\n            energySystem: energySystem,\n            remainingDistance: String(remainingDistanceForMainSet),\n            details: strategyResult?.strategySpecificSummary || \"No sets generated by strategy.\"\n        });\n    }\n\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage };\n}\n","// lib/data/mainSetConfigs.js - V3_SCHEMA_UPDATE_MARKER_CONFIGS\n\n// Helper function for SP2 Rest (from MAX_SPRINT.js)\nconst getSp2RestString = (repDist) => {\n    let minSec, maxSec;\n    if (repDist === 25) {\n        minSec = 60; maxSec = 180;\n    } else if (repDist === 50) {\n        minSec = 180; maxSec = 300;\n    } else { // Should not happen\n        minSec = 60; maxSec = 120;\n    }\n    const totalSeconds = minSec + Math.floor(Math.random() * (maxSec - minSec + 1));\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = totalSeconds % 60;\n    let restString = \"\";\n    if (minutes > 0) restString += `${minutes}'`;\n    if (seconds > 0) restString += `${seconds}\"`;\n    else if (minutes === 0 && seconds === 0) restString = '10\"';\n    if (minutes > 0 && seconds === 0) { /* e.g. 3' */ }\n    return `r${restString}`;\n};\n\n// Helper function for SP1 Rest (from SPEED_ENDURANCE.js)\nconst getSp1Rest = (repDist) => {\n    let baseRestSeconds;\n    if (repDist === 100) baseRestSeconds = 10;\n    else if (repDist === 75) baseRestSeconds = 7.5;\n    else if (repDist === 50) baseRestSeconds = 5;\n    else if (repDist === 25) baseRestSeconds = 2.5;\n    else baseRestSeconds = 5;\n    const multiplier = 2 + Math.random();\n    let restSeconds = Math.round((baseRestSeconds * multiplier) / 5) * 5;\n    restSeconds = Math.max(restSeconds, 5);\n    if (repDist === 100) restSeconds = Math.max(restSeconds, 20);\n    return `r${restSeconds}\"`;\n};\n\n// Unified SetDefinition Schema (for reference in this file)\n// {\n//     id: String (optional),\n//     distance: Number,\n//     repScheme: {\n//         type: \"dynamic\" | \"fixed\",\n//         maxReps: Number (if type=\"dynamic\"),\n//         fixedReps: Number (if type=\"fixed\"),\n//         minReps: Number (optional for \"dynamic\")\n//     },\n//     rest: String (optional),\n//     paceDescription: String (optional),\n//     activity: String (optional, defaults to \"swim\"),\n//     notes: String (optional),\n//     totalDistance: Number (optional, for type=\"fixed\")\n// }\n\nexport const ENDURANCE_BASE_CONFIG = {\n    workoutTypeName: \"EN1\",\n    minTotalDistanceForSet: 500,\n    paceConfig: { baseMetric: \"css\", offset: 5, randomRange: 10, operator: \"+\" },\n    setGenerationStrategy: \"bestFitSingleRepetition\",\n    strategyConfig: {\n        setDefinitions: [\n            { distance: 500, repScheme: { type: \"dynamic\", maxReps: 12 }, activity: \"swim/kick\" },\n            { distance: 600, repScheme: { type: \"dynamic\", maxReps: 10 }, activity: \"swim/kick\" },\n            { distance: 700, repScheme: { type: \"dynamic\", maxReps: 8 }, activity: \"swim/kick\" },\n            { distance: 800, repScheme: { type: \"dynamic\", maxReps: 7 }, activity: \"swim/kick\" },\n            { distance: 900, repScheme: { type: \"dynamic\", maxReps: 6 }, activity: \"swim/kick\" },\n            { distance: 1000, repScheme: { type: \"dynamic\", maxReps: 6 }, activity: \"swim/kick\" },\n        ],\n        selectionPreference: {\n            tiebreakYardage: \"preferShorterRepIfSameYardageThenMoreReps\",\n            shorterRepValue: 500\n        }\n    },\n    restConfig: { type: \"fixed\", value: 'r60\"' },\n    setFormatting: { baseStructure: \"{reps}x{dist} {activity} ({energySystem} focus) {rest}\", defaultActivity: \"swim/kick\" },\n    descriptiveMessages: {\n        success: \"EN1: {setSummary} ({energySystem}), CSS +5-15s/100m pace guide, 60\\\" rest.\",\n        tooShort: \"EN1: Too short. Min rep distance {minRepDistForType}, available: {remainingDistance}.\",\n        fail: \"EN1: Could not fit EN1 reps for {energySystem}. Available: {remainingDistance}.\"\n    }\n};\n\nexport const GENERAL_ENDURANCE_CONFIG = {\n    workoutTypeName: \"General Endurance\",\n    minTotalDistanceForSet: 25,\n    paceConfig: { baseMetric: \"css\", offset: 0, operator: \"+\" },\n    setGenerationStrategy: \"closestFitGeneral\",\n    strategyConfig: {\n        setDefinitions: [\n            { distance: 500, repScheme: { type: \"dynamic\", maxReps: Infinity} },\n            { distance: 400, repScheme: { type: \"dynamic\", maxReps: Infinity} },\n            { distance: 300, repScheme: { type: \"dynamic\", maxReps: Infinity} },\n            { distance: 200, repScheme: { type: \"dynamic\", maxReps: Infinity} },\n            { distance: 100, repScheme: { type: \"dynamic\", maxReps: Infinity} },\n            { distance: 50, repScheme: { type: \"dynamic\", maxReps: Infinity} },\n        ],\n        minRepDistanceForFallback: 25,\n        conservativeAdjustment: { enabled: true, usageThresholdFactor: 0.80, minRepDistance: 200, minReps: 3 }\n    },\n    restConfig: { type: \"distanceBased\", values: { 300: 'r45\"', 200: 'r30\"', 100: 'r20\"', default: 'r15\"' } },\n    setFormatting: { baseStructure: \"{reps}x{dist} swim ({energySystem} focus) {rest}\", defaultActivity: \"swim\" },\n    descriptiveMessages: {\n        success: \"General Endurance ({energySystem}) default set. {setSummary}\",\n        tooShort: \"General Endurance ({energySystem}) set - too short. Available: {remainingDistance}.\",\n        fail: \"General Endurance ({energySystem}): Could not fit set. Available: {remainingDistance}.\"\n    }\n};\n\nexport const MAX_SPRINT_CONFIG = {\n    workoutTypeName: \"SP2\",\n    minTotalDistanceForSet: 25,\n    paceConfig: { baseMetric: \"css\", offset: 10, randomRange: 5, operator: \"-\" },\n    setGenerationStrategy: \"targetYardageWithRepChoice\",\n    strategyConfig: {\n        setTargetDistanceMin: 300,\n        setTargetDistanceMaxDefault: 600,\n        setTargetDistanceMaxCap: 4500,\n        setDefinitions: [\n            { distance: 25, repScheme: { type: \"dynamic\", maxReps: Infinity }, activity: \"UW sprint\", notes: \"breath at wall\" },\n            { distance: 50, repScheme: { type: \"dynamic\", maxReps: Infinity }, activity: \"UW sprint\", notes: \"breath at wall\" },\n        ],\n        repChoiceLogic: { preferDistance: 50, thresholdYardage: 150 }\n    },\n    restConfig: { type: \"customFunction\", customFunction: getSp2RestString },\n    setFormatting: { baseStructure: \"{reps}x{dist} {activity} ({energySystem} focus, {notes}) {rest}\", defaultActivity: \"UW sprint\" },\n    descriptiveMessages: {\n        success: \"SP2: Lactate Production ({energySystem}), Near Max Effort. Set: {setSummary}. Total ~{totalDistance}yds.\",\n        tooShort: \"SP2: Too short. Min rep 25. Available: {remainingDistance}.\",\n        fail: \"SP2: Could not fit SP2 set. Available: {remainingDistance} (target yardage for SP2 is typically 300-600).\"\n    }\n};\n\nexport const SPEED_ENDURANCE_CONFIG = {\n    workoutTypeName: \"SP1\",\n    minTotalDistanceForSet: 25,\n    paceConfig: { baseMetric: \"css\", offset: 3, randomRange: 2, operator: \"-\" },\n    setGenerationStrategy: \"multiBlock\",\n    strategyConfig: {\n        setTargetDistanceMin: 400,\n        setTargetDistanceMaxCap: 4500,\n        targetYardagePerBlockApprox: 800,\n        setDefinitions: [\n            { distance: 25, repScheme: { type: \"dynamic\", maxReps: 16 } },\n            { distance: 50, repScheme: { type: \"dynamic\", maxReps: 16 } },\n            { distance: 75, repScheme: { type: \"dynamic\", maxReps: 16 } },\n            { distance: 100, repScheme: { type: \"dynamic\", maxReps: 16 } },\n        ],\n        drills: [\"swim\", \"kb\", \"FU\", \"HUHO\"],\n        interBlockRest: {\n            minSeconds: 60,\n            maxSeconds: 120,\n            format: (seconds) => {\n                const minutes = Math.floor(seconds / 60);\n                const secs = seconds % 60;\n                let timeStr;\n                if (minutes > 0) {\n                    timeStr = (secs === 0) ? `${minutes}min` : `${minutes}min ${secs}s`;\n                } else {\n                    timeStr = `${secs}s`;\n                }\n                return `${timeStr} rest between SP1 blocks`;\n            }\n        }\n    },\n    restConfig: { type: \"customFunction\", customFunction: getSp1Rest },\n    setFormatting: { baseStructure: \"{reps}x{dist} {activity} ({energySystem} focus) {rest}\" },\n    descriptiveMessages: {\n        success: \"SP1: Lactate Tolerance ({energySystem}), CSS -3-5s. Total ~{totalDistance}yds.\",\n        tooShort: \"SP1: Too short. Min rep 25. Available: {remainingDistance}.\",\n        fail: \"SP1: Could not fit SP1 set. Available: {remainingDistance} (target yardage for SP1 is typically 400-800).\"\n    }\n};\n\nexport const THRESHOLD_DEVELOPMENT_CONFIG = {\n    workoutTypeName: \"EN3\",\n    minTotalDistanceForSet: 400,\n    paceConfig: { baseMetric: \"css\", offset: 1, randomRange: 1, operator: \"-\" },\n    setGenerationStrategy: \"patternBased\",\n    strategyConfig: {\n        setDefinitions: [\n            { id: 'Nx400_css_r50', distance: 400, repScheme: { type: \"dynamic\", maxReps: 18 }, rest: 'r50\"', paceDescription: 'CSS' },\n            { id: 'Nx500_css_r60', distance: 500, repScheme: { type: \"dynamic\", maxReps: 14 }, rest: 'r60\"', paceDescription: 'CSS' },\n            { id: 'Nx600_css_r90', distance: 600, repScheme: { type: \"dynamic\", maxReps: 12 }, rest: 'r90\"', paceDescription: 'CSS' },\n        ],\n        selectionLogic: \"maxAchievedDistance\",\n        fallbackStrategy: {\n            type: \"simpleRepsMaxDistance\",\n            setDefinitions: [\n                { distance: 600, repScheme: { type: \"dynamic\", maxReps: 6 }, rest: 'r90\"', paceDescription: 'CSS -1-2s' },\n                { distance: 500, repScheme: { type: \"dynamic\", maxReps: 6 }, rest: 'r60\"', paceDescription: 'CSS -1-2s' },\n                { distance: 400, repScheme: { type: \"dynamic\", maxReps: 6 }, rest: 'r45\"', paceDescription: 'CSS -1-2s' }\n            ],\n            minRepDistance: 400,\n        }\n    },\n    restConfig: { type: \"patternDefined\" },\n    setFormatting: { baseStructure: \"{reps}x{dist} {energySystem} focus swim @ {paceDesc} {rest}\", defaultActivity: \"swim\" },\n    descriptiveMessages: {\n        success: \"EN3: {setSummary} ({energySystem}) @ {paceDescription}.\",\n        tooShort: \"EN3: Too short for EN3 sets (min rep {minRepDistForType}). Available: {remainingDistance}.\",\n        fail: \"EN3: Could not fit standard or fallback EN3 set for {energySystem}. Available: {remainingDistance}.\"\n    }\n};\n\nexport const THRESHOLD_SUSTAINED_CONFIG = {\n    workoutTypeName: \"EN2\",\n    minTotalDistanceForSet: 100,\n    paceConfig: { baseMetric: \"css\", offset: 0, operator: \"+\" },\n    setGenerationStrategy: \"patternBased\",\n    strategyConfig: {\n        setDefinitions: [\n            { id: '18x100_css_r10', distance: 100, repScheme: { type: 'fixed', fixedReps: 18 }, totalDistance: 1800, rest: 'r10\"', paceDescription: 'CSS' },\n            { id: '10x200_css_r20', distance: 200, repScheme: { type: 'fixed', fixedReps: 10 }, totalDistance: 2000, rest: 'r20\"', paceDescription: 'CSS' },\n            { id: 'Nx400_css_r40', distance: 400, repScheme: { type: 'dynamic', maxReps: 18 }, rest: 'r40\"', paceDescription: 'CSS' },\n            { id: 'Nx500_css_r50', distance: 500, repScheme: { type: 'dynamic', maxReps: 14 }, rest: 'r50\"', paceDescription: 'CSS' },\n            { id: 'Nx600_css_r60', distance: 600, repScheme: { type: 'dynamic', maxReps: 12 }, rest: 'r60\"', paceDescription: 'CSS' },\n            { id: 'Nx800_css_r90', distance: 800, repScheme: { type: 'dynamic', maxReps: 8 }, rest: 'r90\"', paceDescription: 'CSS' },\n            { id: 'Nx1000_css_r90', distance: 1000, repScheme: { type: 'dynamic', maxReps: 6 }, rest: 'r90\"', paceDescription: 'CSS' }\n        ],\n        selectionLogic: \"prioritizeMaxDistanceThenRandom\",\n        fallbackStrategy: {\n            type: \"simpleRepsMaxDistance\",\n            setDefinitions: [\n                { distance: 200, repScheme: { type: \"dynamic\", maxReps: 40 }, rest: 'r20\"', paceDescription: 'CSS' },\n                { distance: 100, repScheme: { type: \"dynamic\", maxReps: 60 }, rest: 'r10\"', paceDescription: 'CSS' }\n            ],\n            minRepDistance: 100,\n        }\n    },\n    restConfig: { type: \"patternDefined\" },\n    setFormatting: { baseStructure: \"{reps}x{dist} {energySystem} focus swim @ {paceDesc} {rest}\", defaultActivity: \"swim\" },\n    descriptiveMessages: {\n        success: \"EN2: {setSummary} ({energySystem}) @ CSS.\",\n        tooShort: \"EN2: Too short for EN2 sets. Available: {remainingDistance}.\",\n        fail: \"EN2: Could not fit standard EN2 set for {energySystem}. Available: {remainingDistance}.\"\n    }\n};\n\nexport const ALL_WORKOUT_CONFIGS = {\n    ENDURANCE_BASE: ENDURANCE_BASE_CONFIG,\n    GENERAL_ENDURANCE: GENERAL_ENDURANCE_CONFIG,\n    MAX_SPRINT: MAX_SPRINT_CONFIG,\n    SPEED_ENDURANCE: SPEED_ENDURANCE_CONFIG,\n    THRESHOLD_DEVELOPMENT: THRESHOLD_DEVELOPMENT_CONFIG,\n    THRESHOLD_SUSTAINED: THRESHOLD_SUSTAINED_CONFIG\n};\n\n// Further comments removed.\n","// lib/data/mainSets.js\nimport { generateMainSetFromConfig } from '../workoutGenerator.js';\nimport {\n    ALL_WORKOUT_CONFIGS\n    // ENDURANCE_BASE_CONFIG,\n    // GENERAL_ENDURANCE_CONFIG,\n    // MAX_SPRINT_CONFIG,\n    // SPEED_ENDURANCE_CONFIG,\n    // THRESHOLD_DEVELOPMENT_CONFIG,\n    // THRESHOLD_SUSTAINED_CONFIG\n} from './mainSetConfigs.js';\n\n// The individual functions are now replaced by calls to the generator\n\nexport const ENDURANCE_BASE = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    return generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, ALL_WORKOUT_CONFIGS.ENDURANCE_BASE);\n};\n\nexport const GENERAL_ENDURANCE = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    return generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, ALL_WORKOUT_CONFIGS.GENERAL_ENDURANCE);\n};\n\nexport const MAX_SPRINT = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    return generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, ALL_WORKOUT_CONFIGS.MAX_SPRINT);\n};\n\nexport const SPEED_ENDURANCE = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    return generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, ALL_WORKOUT_CONFIGS.SPEED_ENDURANCE);\n};\n\nexport const THRESHOLD_DEVELOPMENT = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    return generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, ALL_WORKOUT_CONFIGS.THRESHOLD_DEVELOPMENT);\n};\n\nexport const THRESHOLD_SUSTAINED = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    return generateMainSetFromConfig(energySystem, cssSecondsPer100, remainingDistanceForMainSet, ALL_WORKOUT_CONFIGS.THRESHOLD_SUSTAINED);\n};\n\n// This object is used by other parts of the application to select a main set function.\n// It now correctly points to the new wrapper functions.\nexport const mainSetFunctions = {\n    ENDURANCE_BASE: ENDURANCE_BASE,\n    GENERAL_ENDURANCE: GENERAL_ENDURANCE,\n    MAX_SPRINT: MAX_SPRINT,\n    SPEED_ENDURANCE: SPEED_ENDURANCE,\n    THRESHOLD_DEVELOPMENT: THRESHOLD_DEVELOPMENT,\n    THRESHOLD_SUSTAINED: THRESHOLD_SUSTAINED,\n};\n","/**\n * Selects a warmup routine.\n * There's a 90% chance of selecting a warmup from the availableWarmups array,\n * and a 10% chance of selecting the noWarmupOption.\n *\n * @param {Array<Object>} availableWarmups - An array of warmup objects. Each object should have at least 'desc' and 'dist' properties.\n * @param {Object} noWarmupOption - An object representing the option of no warmup. Should have 'desc' and 'dist'.\n * @returns {Object} The selected warmup object.\n */\nfunction selectWarmup(availableWarmups, noWarmupOption) {\n    const useWarmup = Math.random() > 0.1; // 90% chance of including a warmup\n\n    if (useWarmup && availableWarmups && availableWarmups.length > 0) {\n        return availableWarmups[Math.floor(Math.random() * availableWarmups.length)];\n    } else {\n        return noWarmupOption;\n    }\n}\n\n/**\n * Selects a cooldown routine randomly from the available options.\n *\n * @param {Array<Object>} availableCooldowns - An array of cooldown objects. Each object should have at least 'desc' and 'dist' properties.\n * @returns {Object|null} The selected cooldown object, or null if no cooldowns are available or an error occurs.\n */\nfunction selectCooldown(availableCooldowns) {\n    if (availableCooldowns && availableCooldowns.length > 0) {\n        return availableCooldowns[Math.floor(Math.random() * availableCooldowns.length)];\n    }\n    return null; // Or return a default cooldown if preferred\n}\n\n/**\n * Generates the main set for a workout based on the energy system.\n *\n * @param {string} energySystem - The energy system focus (e.g., 'EN1', 'EN2').\n * @param {number} cssSecondsPer100 - Critical Swim Speed in seconds per 100 units.\n * @param {number} remainingDistanceForMainSet - The distance available for the main set.\n * @param {string} workoutType - The type of workout (e.g., 'THRESHOLD_SUSTAINED').\n * @param {string} energySystem - The energy system focus (e.g., 'EN1', 'EN2').\n * @param {number} cssSecondsPer100 - Critical Swim Speed in seconds per 100 units.\n * @param {number} remainingDistanceForMainSet - The distance available for the main set.\n * @param {Object} mainSetDefinitions - Object mapping workout types to generator functions.\n * @returns {{ sets: string[], mainSetTotalDist: number, targetPacePer100: number, descriptiveMessage?: string }}\n *           An object containing the sets, total distance of the main set, target pace,\n *           and an optional descriptive message for unknown or default systems.\n */\nfunction generateMainSet(workoutType, energySystem, cssSecondsPer100, remainingDistanceForMainSet, mainSetDefinitions) {\n    let generator = mainSetDefinitions[workoutType];\n    let messageFromOuterScope;\n\n    if (!generator) {\n        messageFromOuterScope = `Unknown workout type: ${workoutType}. Defaulting to general endurance.`;\n        generator = mainSetDefinitions['GENERAL_ENDURANCE'];\n    }\n\n    // The generator function now expects energySystem as its first param.\n    let mainSetOutput = generator(energySystem, cssSecondsPer100, remainingDistanceForMainSet);\n\n    // Fallback condition: if the selected generator (not GENERAL_ENDURANCE) produced a very small set\n    if (mainSetOutput.mainSetTotalDist < 100 && remainingDistanceForMainSet > 100 && workoutType !== 'GENERAL_ENDURANCE') {\n        let fallbackMessage = \"(Fallback to general endurance due to low generated distance for selected workout type).\";\n\n        const originalMessage = mainSetOutput.descriptiveMessage; // Message from the original, tiny set\n        mainSetOutput = mainSetDefinitions['GENERAL_ENDURANCE'](energySystem, cssSecondsPer100, remainingDistanceForMainSet); // Rerun with GENERAL_ENDURANCE\n\n        // Construct descriptive message for fallback\n        let finalFallbackMessage = fallbackMessage;\n        if (originalMessage) { // If the original (tiny) set had a message\n            finalFallbackMessage = originalMessage + \" \" + fallbackMessage;\n        } else if (mainSetOutput.descriptiveMessage) { // If GENERAL_ENDURANCE set has a message\n            finalFallbackMessage = fallbackMessage + \" \" + mainSetOutput.descriptiveMessage;\n        }\n        mainSetOutput.descriptiveMessage = finalFallbackMessage;\n    } else {\n        // No fallback, or it was a direct 'GENERAL_ENDURANCE' call.\n        // If messageFromOuterScope was set (i.e., unknown workout type), it takes precedence\n        // unless the generator provided its own more specific message.\n        if (messageFromOuterScope) {\n            if (!mainSetOutput.descriptiveMessage) {\n                mainSetOutput.descriptiveMessage = messageFromOuterScope;\n            } else {\n                // If generator (GENERAL_ENDURANCE in this case) set a message, and it was an unknown type,\n                // combine or prioritize. For now, \"Unknown type\" message is more specific to the situation.\n                mainSetOutput.descriptiveMessage = messageFromOuterScope + \" Original generator message: \" + mainSetOutput.descriptiveMessage;\n            }\n        } else if (workoutType === 'GENERAL_ENDURANCE' && !mainSetOutput.descriptiveMessage) {\n            // If it was a direct 'GENERAL_ENDURANCE' call and the generator provided no message (unlikely with current data)\n            mainSetOutput.descriptiveMessage = `General Endurance (${energySystem}) set.`;\n        }\n    }\n    return mainSetOutput;\n}\n\nconst workoutFunctions = {\n    selectWarmup,\n    selectCooldown,\n    generateMainSet\n};\n\nexport default workoutFunctions;\n","import { warmups, noWarmupOption } from './data/warmups.js';\nimport { cooldowns } from './data/cooldowns.js';\nimport { mainSetFunctions } from './data/mainSets.js';\nimport workoutComponents from './workoutComponents.js';\n\n// Helper function to convert MM:SS time string to total seconds per 100 units\nexport function parseCssTimeToSeconds(cssTimeStr) {\n    if (typeof cssTimeStr !== 'string') {\n        return null;\n    }\n    const parts = cssTimeStr.split(':');\n    if (parts.length === 2) {\n        const minutes = parseInt(parts[0], 10);\n        const seconds = parseFloat(parts[1]);\n        if (isNaN(minutes) || isNaN(seconds)) {\n            return null;\n        }\n        return minutes * 60 + seconds;\n    }\n    return null; // Invalid format\n}\n\n// Helper function to format total seconds per 100 units back to MM:SS\nexport function formatSecondsToMmSs(totalSeconds) {\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = (totalSeconds % 60).toFixed(1); // One decimal for seconds\n    return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;\n}\n\n/**\n * Generates a random workout based on distance, energy system, and CSS time.\n * @param {number} totalDistanceYards - The approximate total desired workout distance in yards.\n * @param {string} energySystem - The energy system focus (e.g., 'EN1', 'EN2', 'EN3', 'SP1', 'SP2').\n * @param {string} cssTimeMmSs - The Critical Swim Speed in MM:SS format (e.g., '1:10').\n * @param {string} workoutType - The type of workout (e.g., 'threshold', 'anaerobic').\n * @returns {string} A formatted string describing the generated workout.\n */\nfunction generateWorkout(totalDistanceYards, energySystem, cssTimeMmSs, workoutType) {\n    const VERY_SHORT_WORKOUT_THRESHOLD = 600; // yards\n    // noWarmupOption is imported and can be used directly or cloned if description needs change for this specific case\n    // const noWarmupForShortOption = { ...noWarmupOption, desc: \"No warmup (short workout)\" };\n\n    const cssSecondsPer100 = parseCssTimeToSeconds(cssTimeMmSs);\n    if (cssSecondsPer100 === null) {\n        return \"Error: Invalid CSS time format. Please use MM:SS (e.g., '1:10').\";\n    }\n\n    let workoutDetails = [];\n    let currentDistanceCovered = 0;\n    const mainSetUnits = \"yards\"; // Assuming SCY based on sources unless specified otherwise [7, 9, 16]\n\n    // --- 1. Warmup Selection ---\n    let selectedWarmup;\n    if (totalDistanceYards < VERY_SHORT_WORKOUT_THRESHOLD) {\n        selectedWarmup = { ...noWarmupOption, desc: \"No warmup (short workout)\" };\n    } else {\n        // Re-introducing adaptive warmup logic for non-very-short workouts, with the specified modification\n        selectedWarmup = workoutComponents.selectWarmup(warmups, noWarmupOption); // Initial selection\n        if (selectedWarmup && selectedWarmup.dist > 0) {\n            const minMainSetThreshold = 200;\n            let maxAllowedWarmupDist = totalDistanceYards - minMainSetThreshold;\n\n            // Apply the more stringent percentage cap: 0.4 (40%) instead of 0.6\n            maxAllowedWarmupDist = Math.min(maxAllowedWarmupDist, totalDistanceYards * 0.4);\n\n            if (maxAllowedWarmupDist < 0 && totalDistanceYards > 0) {\n                 maxAllowedWarmupDist = totalDistanceYards * 0.4; // Fallback for small total distances if threshold makes it negative\n                                                                  // This 0.4 is different from the one above.\n                                                                  // Let's keep it as it was for this specific fallback:\n                 // maxAllowedWarmupDist = totalDistanceYards * 0.4; // This logic was for very small total distances\n                 // The logic from file before reset was:\n                 // if (maxAllowedWarmupDist < 0 && totalDistanceYards > 0) { maxAllowedWarmupDist = totalDistanceYards * 0.4; }\n                 // This specific 0.4 should remain if it's for the negative guard, distinct from the primary cap.\n                 // Re-evaluating based on typical structure: the primary cap (now 0.4) applies first.\n                 // Then, specific conditions for very small distances adjust if it results in negative or too small.\n                 // The previous adaptive logic was:\n                 // maxAllowedWarmupDist = Math.min(maxAllowedWarmupDist, totalDistanceYards * 0.6); // This is now 0.4\n                 // if (maxAllowedWarmupDist < 0 && totalDistanceYards > 0) { maxAllowedWarmupDist = totalDistanceYards * 0.4; }\n                 // The above line (totalDistanceYards * 0.4) was a fallback if the (totalDistanceYards - minMainSetThreshold) was negative.\n                 // It seems the logic should be:\n                 // 1. max = total - threshold\n                 // 2. max = min(max, total * NEW_PRIMARY_CAP (0.4))\n                 // 3. if max < 0 (because total was small), max = total * FALLBACK_CAP_FOR_SMALL_TOTAL (e.g. 0.4 or 0.5)\n                 // 4. if max < 50 (and total >=50), max = 50.\n                 // Let's stick to the prompt's direct change on the percentage line first.\n                 // The other parts of the adaptive logic are:\n            } // End of the \"maxAllowedWarmupDist < 0\" check\n\n            if (maxAllowedWarmupDist < 50 && totalDistanceYards >= 50) {\n                 maxAllowedWarmupDist = 50;\n            }\n            // Add a final guard if maxAllowedWarmupDist somehow ended up negative (e.g. if totalDistanceYards was < 50 but > 0)\n            if (maxAllowedWarmupDist < 0) maxAllowedWarmupDist = 0;\n\n\n            if (selectedWarmup.dist > maxAllowedWarmupDist) {\n                const suitableWarmups = warmups.filter(wu => wu.dist <= maxAllowedWarmupDist && wu.dist > 0);\n                if (suitableWarmups.length > 0) {\n                    selectedWarmup = suitableWarmups[Math.floor(Math.random() * suitableWarmups.length)];\n                } else {\n                    selectedWarmup = noWarmupOption;\n                }\n            }\n        } else if (!selectedWarmup || selectedWarmup.dist === 0) {\n            selectedWarmup = noWarmupOption;\n        }\n    }\n\n    if (selectedWarmup) {\n        workoutDetails.push(`WU: ${selectedWarmup.desc}`);\n        currentDistanceCovered += selectedWarmup.dist;\n    }\n\n    // --- 2. Main Set Generation ---\n    let mainSetDescription = \"Main Set:\";\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100;\n    let remainingDistanceForMainSet = totalDistanceYards - currentDistanceCovered;\n\n// Map energySystem to workoutType keys\nconst energySystemToWorkoutType = {\n    'EN1': 'ENDURANCE_BASE',\n    'EN2': 'THRESHOLD_SUSTAINED',\n    'EN3': 'THRESHOLD_DEVELOPMENT',\n    'SP1': 'SPEED_ENDURANCE',\n    'SP2': 'MAX_SPRINT',\n    // Add other mappings if necessary, or a default\n};\n\nlet internalWorkoutType = energySystemToWorkoutType[energySystem.toUpperCase()];\n\nif (!internalWorkoutType) {\n    // console.warn(`Unknown energySystem: ${energySystem}. Defaulting to GENERAL_ENDURANCE if workoutType param is also not specific.`);\n    // If the original workoutType parameter was provided and is valid, it could be used.\n    // However, the new guidelines are driven by EN1, EN2 etc.\n    // So, if energySystem doesn't map, we might default or rely on the generateMainSet's default.\n    // For now, if energySystem doesn't map, internalWorkoutType will be undefined,\n    // and generateMainSet will default to GENERAL_ENDURANCE.\n    // The original 'workoutType' parameter from generateWorkout's signature is still available if needed as a fallback here.\n    // Let's make it explicit: if energySystem mapping fails, use the passed 'workoutType' parameter.\n    // If that is also undefined, generateMainSet handles the GENERAL_ENDURANCE default.\n    if (workoutType) { // workoutType is the original parameter of generateWorkout\n        internalWorkoutType = workoutType;\n    }\n    // If internalWorkoutType is still undefined, generateMainSet's default to GENERAL_ENDURANCE will occur.\n}\n\n\n// const mainSetResult = workoutComponents.generateMainSet(workoutType, energySystem, cssSecondsPer100, remainingDistanceForMainSet, mainSetFunctions);\n// Replace with:\nconst mainSetResult = workoutComponents.generateMainSet(internalWorkoutType, energySystem, cssSecondsPer100, remainingDistanceForMainSet, mainSetFunctions);\n    sets = mainSetResult.sets;\n    mainSetTotalDist = mainSetResult.mainSetTotalDist;\n    targetPacePer100 = mainSetResult.targetPacePer100;\n\n    if (mainSetResult.descriptiveMessage) {\n        mainSetDescription += ` ${mainSetResult.descriptiveMessage}`;\n    }\n\n    workoutDetails.push(mainSetDescription);\n    sets.forEach(set => {\n        workoutDetails.push(`  - ${set}`);\n    });\n    currentDistanceCovered += mainSetTotalDist;\n\n    // --- 3. Cool-down Selection ---\n    let selectedCooldown;\n    const noCooldownForShortOption = { desc: \"No cooldown (short workout)\", dist: 0, type: \"none\" };\n\n    if (totalDistanceYards < VERY_SHORT_WORKOUT_THRESHOLD) {\n        selectedCooldown = noCooldownForShortOption;\n    } else {\n        // Re-introducing adaptive cooldown logic with the specified modification\n        const generalNoCooldownOption = { desc: \"No cooldown\", dist: 0, type: \"none\" }; // General purpose\n        const distanceAfterMainSet = currentDistanceCovered;\n        const distanceToTarget = totalDistanceYards - distanceAfterMainSet;\n\n        if (distanceAfterMainSet >= totalDistanceYards - 50) {\n            selectedCooldown = generalNoCooldownOption;\n        } else {\n            // Apply the more stringent buffer: 25 instead of 75\n            const suitableCooldowns = cooldowns.filter(cd => cd.dist <= distanceToTarget + 25);\n\n            if (suitableCooldowns.length > 0) {\n                selectedCooldown = suitableCooldowns[Math.floor(Math.random() * suitableCooldowns.length)];\n            } else {\n                selectedCooldown = generalNoCooldownOption;\n            }\n        }\n    }\n\n    if (selectedCooldown) {\n        workoutDetails.push(`CD: ${selectedCooldown.desc}`);\n        currentDistanceCovered += selectedCooldown.dist;\n    }\n\n    // --- 4. Final Details ---\n    workoutDetails.push(`\\nTotal estimated distance: ${currentDistanceCovered} ${mainSetUnits}`);\n    workoutDetails.push(`CSS: ${cssTimeMmSs}`);\n    workoutDetails.push(`Workout Type: ${workoutType}`); // Added Workout Type\n    workoutDetails.push(`Energy System Focus: ${energySystem.toUpperCase()}`);\n    // A rough estimate of average pace, as true average depends on actual interval times and rest\n    workoutDetails.push(`Estimated AVG pace for main set: ${formatSecondsToMmSs(targetPacePer100)} / 100 ${mainSetUnits}`);\n\n    return workoutDetails.join('\\n');\n}\n\nexport { generateWorkout }; // Keep generateWorkout exported as it's likely the main API\n\n// --- Example Usage ---\n// console.log(generateWorkout(3000, 'EN3', '1:20'));\n// console.log(generateWorkout(2000, 'SP1', '1:10'));\n// console.log(generateWorkout(1500, 'SP2', '1:15'));\n// console.log(generateWorkout(2500, 'EN2', '1:12'));\n// console.log(generateWorkout(1800, 'EN1', '1:25'));","import _ from 'lodash';\n\nexport function getThingViaTimeLimit(key, secondsLeft, things, number = 1) {\n  let filteredThings = _.filter(things, thing => (thing[key] * number) <= secondsLeft);\n  return _.sample(filteredThings);\n}\n","import _ from 'lodash';\nimport {getThingViaTimeLimit} from './getThingViaTimeLimit';\nimport swims from './data/swims.json';\n\nexport function repeatIntervals(secondsLeft, generatedPattern) {\n  if (secondsLeft < 20) {\n    // console.log(`weird amount of time left: ${secondsLeft}. returning original pattern`);\n    return generatedPattern;\n  }\n\n  let seconds = 0;\n  let selectedSwim = getThingViaTimeLimit(\"time\", secondsLeft, swims);\n\n  // console.log(`repeating interval of type ${selectedSwim.name}`)\n\n  while (seconds + selectedSwim.time <= secondsLeft) {\n    let timeLeft = secondsLeft - seconds;\n    let maxRepetition = Math.floor(timeLeft / selectedSwim.time);\n\n    // attempt to keep max length 200 or less\n    maxRepetition = (maxRepetition * selectedSwim.interval) > 40 ?\n      Math.floor(40 / selectedSwim.interval) :\n      maxRepetition;\n\n    let intervalLength = _.random(1, maxRepetition);\n    let secondsToAdd = selectedSwim.time * intervalLength;\n\n    // console.log('adding swim', selectedSwim);\n\n    seconds += secondsToAdd;\n    generatedPattern.seconds += secondsToAdd;\n    generatedPattern.intervals.push(\n      {\n        type: selectedSwim.name,\n        length: selectedSwim.interval * 25 * intervalLength,\n        number: 1,\n        time: secondsToAdd\n      }\n    );\n  }\n\n  return generatedPattern;\n}\n","import _ from 'lodash';\nimport swims from './data/swims.json';\n\nfunction getSwimByLength(secondsLeft, intervalLength, number) {\n  if (secondsLeft < 20 * number) {\n    // console.log(`weird amount of time left: ${secondsLeft}. returning null`);\n    return null;\n  }\n\n  let selectSwim;\n  let numThings = 0;\n\n  let filteredSwims = _.cloneDeep(swims);\n\n  while (!selectSwim) {\n    numThings++;\n    selectSwim = _.sample(filteredSwims);\n\n    if ((selectSwim.time * number) > secondsLeft) {\n      // console.log(`swim too long ${selectSwim.time} ${number} ${secondsLeft}`);\n      filteredSwims = _.filter(filteredSwims, swim => swim.time < selectSwim.time);\n      selectSwim = null;\n    } else if ((selectSwim.interval > intervalLength) || (intervalLength % selectSwim.interval !== 0)) {\n      // console.log(`interval too long ${selectSwim.interval} ${intervalLength}`);\n      filteredSwims = _.filter(filteredSwims, swim => swim.interval < selectSwim.interval);\n      selectSwim = null;\n    }\n\n    if (numThings > 20) {throw new Error(`fuck ${secondsLeft} ${intervalLength} ${number}`);}\n  }\n\n  return selectSwim;\n}\n\nfunction createSwimGroupCount(selectedPattern) {\n  return _.reduce(selectedPattern.pattern, (result, set) => {\n    let swimLength = set.interval[1];\n\n    if(!result[set.group]) {\n      result[set.group] = { number: 1, intervalLength: swimLength}\n    } else {\n      result[set.group].number += 1;\n      result[set.group].intervalLength = _.min([result[set.group].intervalLength, swimLength]);\n    }\n\n    return result;\n  }, {});\n}\n\nfunction mapSwimGroupsToSwims(secondsLeft, selectedPattern, groupsWithCount) {\n  let groupsWithSwim = {};\n\n  let sets = selectedPattern.pattern.length;\n\n  // Find a swim which will fit the pattern and the time remaining\n  _.forEach(groupsWithCount, (groupSize, key) => {\n    let intervalSize = selectedPattern.intervalSize;\n    let otherSetTimes = (sets - groupSize.number) * intervalSize * 20;\n    let selectedSwim = getSwimByLength(\n      secondsLeft - otherSetTimes,\n      groupSize.intervalLength,\n      groupSize.number * intervalSize\n    );\n\n    groupsWithSwim[key] = selectedSwim;\n  });\n\n  return groupsWithSwim;\n}\n\nexport function createSwimsFromPattern(secondsLeft, generatedPattern, selectedPattern) {\n  if (secondsLeft < 20) {\n    // console.log(`weird amount of time left: ${secondsLeft}. returning original pattern`);\n    return generatedPattern;\n  }\n\n  let groupsWithCount = createSwimGroupCount(selectedPattern);\n  let groupsWithSwim = mapSwimGroupsToSwims(secondsLeft, selectedPattern, groupsWithCount);\n\n  // once we've figured out which swims go where, generate the intervals\n  _.forEach(selectedPattern.pattern, pattern => {\n    let selectedSwim = groupsWithSwim[pattern.group];\n    let numIntervals = pattern.interval[0];\n    let swimLength = pattern.interval[1];\n\n    // Some swims are > 1 lap\n    let intervalMultiplier = swimLength / selectedSwim.interval;\n    let totalSwimTime = selectedSwim.time * numIntervals * (intervalMultiplier);\n\n    generatedPattern.seconds += totalSwimTime;\n    generatedPattern.intervals.push(\n      {\n        type: selectedSwim.name,\n        length: swimLength * 25,\n        number: numIntervals,\n        time: selectedSwim.time * intervalMultiplier\n      }\n    );\n  });\n\n  return generatedPattern;\n}\n","import _ from 'lodash';\nimport patterns from './data/patterns.json';\nimport { generateWorkout as generateCssWorkout } from './css.js';\nimport {getThingViaTimeLimit} from './getThingViaTimeLimit';\nimport {repeatIntervals} from './repeatIntervals';\nimport {createSwimsFromPattern} from './createPattern';\n\nfunction isSameType(intervalA, intervalB) {\n  return intervalA.type === intervalB.type\n    && intervalA.length === intervalB.length\n    && intervalA.time === intervalB.time;\n}\n\nfunction doubleLengths(pattern) {\n  // console.log('doubleLengths');\n  pattern.seconds *= 2;\n\n  _.forEach(pattern.intervals, interval => {\n    interval.length *= 2;\n    interval.time *= 2;\n  });\n}\n\nfunction doubleIntervals(pattern) {\n  // console.log('doubleIntervals');\n  pattern.seconds *= 2;\n\n  _.forEach(pattern.intervals, interval => {\n    interval.number *= 2;\n  });\n}\n\nfunction condenseWorkout(pattern) {\n  pattern.intervals = pattern.intervals.reduce((memo, interval) => {\n    let intervalsLength = memo.length;\n\n    if(intervalsLength === 0) {\n      memo.push(interval);\n      return memo;\n    }\n\n    if (isSameType(memo[intervalsLength -1], interval)) {\n      // console.log('condensing', memo[intervalsLength - 1], interval);\n      memo[intervalsLength - 1].number += interval.number;\n    } else {\n      memo.push(interval)\n    }\n\n    return memo;\n  }, []);\n\n  // console.log(pattern);\n\n  return pattern;\n}\n\nexport { generateCssWorkout };\n\nexport function generatePattern(seconds, generatedPattern = { seconds: 0, intervals: [] }) {\n  if (seconds < 20) {\n    // console.log(`weird amount of time left: ${seconds}. returning generated pattern`);\n    return generatedPattern;\n  }\n\n  // console.log('generatePattern');\n\n  let timeLeft = seconds - generatedPattern.seconds;\n  let selectedPattern = getThingViaTimeLimit(\"minTime\", timeLeft, patterns);\n\n  // console.log(`attempting to generate ${selectedPattern.name} pattern, which needs ${selectedPattern.minTime}, and has ${timeLeft}`)\n\n  if (selectedPattern.repeat === true) {\n    return repeatIntervals(timeLeft, generatedPattern);\n  } else {\n    return createSwimsFromPattern(timeLeft, generatedPattern, selectedPattern);\n  }\n}\n\nexport function generateWorkout(seconds) {\n  if (!seconds) { throw new Error('Give me time!'); }\n\n  let pattern = generatePattern(seconds);\n\n  while ((pattern.seconds < (seconds / 2)) && (pattern.seconds >= 20)) {\n    switch(_.random(1,3)) {\n      case 1:\n        doubleLengths(pattern);\n        break;\n      case 2:\n        doubleIntervals(pattern);\n        break;\n      case 3:\n        // add new workout to pattern\n        generatePattern(seconds, pattern);\n        break;\n    }\n  }\n\n  while (seconds - pattern.seconds >= 20) {\n    generatePattern(seconds, pattern);\n  }\n\n  pattern = condenseWorkout(pattern);\n\n  return pattern;\n}\n"],"names":["warmups","desc","dist","type","noWarmupOption","cooldowns","calculateTargetPace","cssSecondsPer100","paceConfig","pace","offset","randomRange","randomComponent","Math","random","totalAdjustment","operator","formatDescriptiveMessage","template","params","message","key","undefined","replace","RegExp","concat","trim","formatSetString","setInfo","energySystem","formatConfig","structure","baseStructure","reps","activity","defaultActivity","restString","paceDesc","notes","getRestString","repDist","restConfig","patternRestValue","value","customFunction","sortedKeys","Object","keys","values","filter","k","map","Number","sort","a","b","_iterator","_createForOfIteratorHelper","_step","s","n","done","keyDist","err","e","f","generateSet_BestFitSingleRepetition","remainingDistance","strategyConfig","setFormattingConfig","setDefinitions","selectionPreference","shuffledSetDefinitions","_","shuffle","bestOption","setDef","totalYardage","isPreferredShorter","_iterator2","_step2","currentDist","distance","repScheme","currentReps","floor","maxReps","Infinity","min","minReps","max","currentTotalYardage","isCurrentDistPreferredShorter","shorterRepValue","tiebreakYardage","chosenSetDef","rest","paceDescription","generatedSets","totalDistance","strategySpecificSummary","restSummary","generateSet_ClosestFitGeneral","minRepDistanceForFallback","conservativeAdjustment","bestRepDist","bestNumReps","smallestRemainder","_iterator3","_step3","currentNumReps","currentRemainder","find","sd","enabled","calculatedDist","usageThresholdFactor","minRepDistance","generateSet_TargetYardageRepChoice","setTargetDistanceMin","setTargetDistanceMaxDefault","setTargetDistanceMaxCap","repChoiceLogic","actualTargetYardage","availableRepDistances","length","preferredSetDef","preferDistance","thresholdYardage","sortedAvailableSetDefs","numReps","currentSetTotalYardage","generateSet_MultiBlock","targetYardagePerBlockApprox","drills","interBlockRest","setsOutput","accumulatedDistInSet","smallestRepDist","targetOverallYardage","numBlocks","ceil","remainingForBlocksAllocation","_loop","distForCurrentBlockTarget","i","suitableSetDefs","possibleSetDefs","currentRepDist","maxRepsForThisDist","currentBlockActualYardage","blockRepRest","drillType","push","restSecondsVal","minSeconds","maxSeconds","formattedBlockRestText","format","text","_ret","generateSet_PatternBased","selectionLogic","fallbackStrategy","viablePatterns","_iterator4","_step4","_objectSpread","id","fixedReps","bestFitSet","findIndex","maxDist","forEach","p","bestDistancePatterns","shuffledFallbackSetDefinitions","bestFallbackOption","maxFallbackYardage","_iterator5","_step5","fbSetDef","currentYardage","generateMainSetFromConfig","remainingDistanceForMainSet","config","sets","mainSetTotalDist","targetPacePer100","descriptiveMessage","getMinRepDistForType","cfg","minTotalDistanceForSet","minDist","_cfg$strategyConfig$f","descriptiveMessages","tooShort","workoutTypeName","minRepDistForType","String","strategyResult","strategyFnMap","strategyFn","setGenerationStrategy","setFormatting","item","paceSummaryText","pc","basePaceDesc","offsetPart","rangeEnd","abs","success","setSummary","_strategyResult","fail","details","getSp2RestString","minSec","maxSec","totalSeconds","minutes","seconds","getSp1Rest","baseRestSeconds","multiplier","restSeconds","round","ENDURANCE_BASE_CONFIG","baseMetric","GENERAL_ENDURANCE_CONFIG","MAX_SPRINT_CONFIG","SPEED_ENDURANCE_CONFIG","secs","timeStr","THRESHOLD_DEVELOPMENT_CONFIG","THRESHOLD_SUSTAINED_CONFIG","ALL_WORKOUT_CONFIGS","ENDURANCE_BASE","GENERAL_ENDURANCE","MAX_SPRINT","SPEED_ENDURANCE","THRESHOLD_DEVELOPMENT","THRESHOLD_SUSTAINED","mainSetFunctions","selectWarmup","availableWarmups","useWarmup","selectCooldown","availableCooldowns","generateMainSet","workoutType","mainSetDefinitions","generator","messageFromOuterScope","mainSetOutput","fallbackMessage","originalMessage","finalFallbackMessage","workoutFunctions","parseCssTimeToSeconds","cssTimeStr","parts","split","parseInt","parseFloat","isNaN","formatSecondsToMmSs","toFixed","generateWorkout","totalDistanceYards","cssTimeMmSs","VERY_SHORT_WORKOUT_THRESHOLD","workoutDetails","currentDistanceCovered","mainSetUnits","selectedWarmup","workoutComponents","minMainSetThreshold","maxAllowedWarmupDist","suitableWarmups","wu","mainSetDescription","energySystemToWorkoutType","internalWorkoutType","toUpperCase","mainSetResult","set","selectedCooldown","noCooldownForShortOption","generalNoCooldownOption","distanceAfterMainSet","distanceToTarget","suitableCooldowns","cd","join","getThingViaTimeLimit","secondsLeft","things","number","arguments","filteredThings","thing","sample","repeatIntervals","generatedPattern","selectedSwim","swims","time","timeLeft","maxRepetition","interval","intervalLength","secondsToAdd","intervals","name","getSwimByLength","selectSwim","numThings","filteredSwims","cloneDeep","swim","Error","createSwimGroupCount","selectedPattern","reduce","pattern","result","swimLength","group","mapSwimGroupsToSwims","groupsWithCount","groupsWithSwim","groupSize","intervalSize","otherSetTimes","createSwimsFromPattern","numIntervals","intervalMultiplier","totalSwimTime","isSameType","intervalA","intervalB","doubleLengths","doubleIntervals","condenseWorkout","memo","intervalsLength","generatePattern","patterns","repeat"],"mappings":"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"}