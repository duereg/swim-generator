{"version":3,"file":"swim-generator.umd.js","sources":["../lib/data/warmups.js","../lib/data/cooldowns.js","../lib/data/mainSets/ENDURANCE_BASE.js","../lib/data/mainSets/THRESHOLD_SUSTAINED.js","../lib/data/mainSets/THRESHOLD_DEVELOPMENT.js","../lib/data/mainSets/SPEED_ENDURANCE.js","../lib/data/mainSets/MAX_SPRINT.js","../lib/data/mainSets/GENERAL_ENDURANCE.js","../lib/data/mainSets.js","../lib/workoutComponents.js","../lib/css.js","../lib/getThingViaTimeLimit.js","../lib/repeatIntervals.js","../lib/createPattern.js","../lib/index.js"],"sourcesContent":["// Warmup options based on various sources [2, 5, 7, 8, 11, 13, 15, 17, 19, 20]\nconst warmups = [\n    { desc: \"200 no fins, 200 w fins swim\", dist: 400, type: \"swim\" }, //[2]\n    { desc: \"400 warmup (75 kick, 25 under)\", dist: 400, type: \"kick\" }, //[5]\n    { desc: \"250 pull warmup, 250 swim warmup\", dist: 500, type: \"pull/swim\" }, //[20]\n    { desc: \"250 warmup\", dist: 250, type: \"general\" }, //[8, 13]\n    { desc: \"200 warm up\", dist: 200, type: \"general\" }, //[7]\n    { desc: \"500 warmup\", dist: 500, type: \"general\" }, //[11, 17]\n    { desc: \"300 warm up\", dist: 300, type: \"general\" }, //[15]\n    { desc: \"150 warm up\", dist: 150, type: \"general\" }, //[19]\n];\n\n// Option for no warmup, as seen in some sources [1, 9]\nconst noWarmupOption = { desc: \"No warmup bitches\", dist: 0, type: \"none\" }; //[1]\n\nexport { warmups, noWarmupOption };\n","// Cool-down options based on various sources [2, 5, 7, 9, 10, 12, 13, 16, 17, 19-21]\nconst cooldowns = [\n    { desc: \"200 w fins (or combo)\", dist: 200, type: \"fins\" }, //[2]\n    { desc: \"200 swim cooldown\", dist: 200, type: \"swim\" }, //[5]\n    { desc: \"100 cool down\", dist: 100, type: \"general\" }, //[7]\n    { desc: \"300 CD\", dist: 300, type: \"general\" }, //[9]\n    { desc: \"200 CD\", dist: 200, type: \"general\" }, //[10, 16, 21]\n    { desc: \"450 cooldown (300 swim, 150 under)\", dist: 450, type: \"swim/under\" }, //[20]\n    { desc: \"100 cool\", dist: 100, type: \"general\" }, //[17]\n    { desc: \"150 cooldown and 20 minutes of stick skills\", dist: 150, type: \"general\" }, //[19]\n    { desc: \"100 fin swim cooldown\", dist: 100, type: \"fin swim\" }, //[12]\n    { desc: \"250 cool down\", dist: 250, type: \"general\" }, //[13]\n];\n\nexport { cooldowns };\n","const en1Distances = [200, 300, 400, 500];\n\nexport const ENDURANCE_BASE = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = cssSecondsPer100 + (Math.random() * 5);\n\n    if (remainingDistanceForMainSet < 25) {\n        return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Endurance Base (${energySystem}) set - too short.` };\n    }\n\n    let en1RepDist = 0;\n    let numEn1Reps = 0;\n\n    if (remainingDistanceForMainSet < 200) { // Path for 25-199 yards\n        const shortEn1Dists = [150, 125, 100, 75, 50, 25]; // Largest to smallest\n        for (const dist of shortEn1Dists) {\n            if (remainingDistanceForMainSet >= dist) {\n                en1RepDist = dist;\n                numEn1Reps = Math.floor(remainingDistanceForMainSet / en1RepDist);\n                break; // Found the largest fitting repDist from short list\n            }\n        }\n    } else if (remainingDistanceForMainSet <= 600) { // Path for 200-600 yards\n        const midEn1Dists = [300, 250, 200, 150, 100, 75, 50]; // Ordered to try larger ones first\n        let bestCurrentRepDist = 0;\n        let bestCurrentNumReps = 0;\n        let smallestRemainderSoFar = Infinity;\n\n        for (const dist of midEn1Dists) {\n            if (remainingDistanceForMainSet >= dist) {\n                let currentNumReps = Math.floor(remainingDistanceForMainSet / dist);\n                // Apply a cap on reps for this mid-range to avoid too many short reps\n                let maxRepsForDist = 5; // Default cap\n                if (dist >= 200) maxRepsForDist = 3;\n                else if (dist >= 150) maxRepsForDist = 4;\n                currentNumReps = Math.min(currentNumReps, maxRepsForDist);\n\n                if (currentNumReps === 0) continue;\n\n                let currentRemainder = remainingDistanceForMainSet - (currentNumReps * dist);\n                if (currentRemainder < smallestRemainderSoFar) {\n                    smallestRemainderSoFar = currentRemainder;\n                    bestCurrentRepDist = dist;\n                    bestCurrentNumReps = currentNumReps;\n                } else if (currentRemainder === smallestRemainderSoFar) {\n                    if (dist > bestCurrentRepDist) { // Prefer larger repDist if remainder is same\n                        bestCurrentRepDist = dist;\n                        bestCurrentNumReps = currentNumReps;\n                    }\n                }\n            }\n        }\n        en1RepDist = bestCurrentRepDist;\n        numEn1Reps = bestCurrentNumReps;\n    } else { // Path for > 600 yards\n        let selectedDist = en1Distances[Math.floor(Math.random() * en1Distances.length)]; // [200,300,400,500]\n        if (selectedDist > remainingDistanceForMainSet) { // Should be rare if remaining > 600\n            for (let j = en1Distances.length - 1; j >= 0; j--) {\n                if (en1Distances[j] <= remainingDistanceForMainSet) {\n                    selectedDist = en1Distances[j];\n                    break;\n                }\n            }\n        }\n        en1RepDist = selectedDist;\n        if (en1RepDist > 0) {\n            numEn1Reps = Math.floor(remainingDistanceForMainSet / en1RepDist);\n            numEn1Reps = Math.min(numEn1Reps, 15); // Cap for standard long distances\n        }\n    }\n\n    if (numEn1Reps > 0 && en1RepDist > 0) {\n        // Final check to prevent exceeding (should be redundant due to Math.floor)\n        if (numEn1Reps * en1RepDist > remainingDistanceForMainSet) {\n            numEn1Reps = Math.floor(remainingDistanceForMainSet / en1RepDist);\n        }\n        if (numEn1Reps > 0) { // Check again after potential adjustment\n            let en1Rest = `r${(Math.floor(Math.random() * (60 - 30 + 1)) + 30)}\"`;\n            sets.push(`${numEn1Reps}x${en1RepDist} ${energySystem} focus swim/kick ${en1Rest}`);\n            mainSetTotalDist = numEn1Reps * en1RepDist;\n        } else { mainSetTotalDist = 0; }\n    } else { mainSetTotalDist = 0; }\n\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: `Endurance Base (${energySystem}) set.` };\n};\n","const en2Distances = [100, 200, 300, 400];\n\nexport const THRESHOLD_SUSTAINED = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = cssSecondsPer100 + (Math.random() * 3 - 1.5);\n\n    if (remainingDistanceForMainSet < 25) {\n         return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Threshold Sustained (${energySystem}) set - too short.` };\n    }\n\n    let en2RepDist = en2Distances[Math.floor(Math.random() * en2Distances.length)];\n\n    if (remainingDistanceForMainSet < en2RepDist) {\n        const possibleDists = en2Distances.filter(d => d <= remainingDistanceForMainSet);\n        if (possibleDists.length > 0) {\n            en2RepDist = possibleDists[possibleDists.length - 1];\n        } else {\n            if (remainingDistanceForMainSet >= 50) {\n                en2RepDist = Math.floor(remainingDistanceForMainSet / 50) * 50;\n                if (en2RepDist === 0) en2RepDist = 50;\n            } else if (remainingDistanceForMainSet >= 25) {\n                en2RepDist = 25;\n            } else {\n                return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Threshold Sustained (${energySystem}) set - too short.` };\n            }\n        }\n    }\n\n    let numEn2Reps = (en2RepDist > 0) ? Math.floor(remainingDistanceForMainSet / en2RepDist) : 0;\n    numEn2Reps = Math.min(numEn2Reps, 25); // Changed cap from 20 to 25\n    numEn2Reps = Math.max(numEn2Reps, 1);\n\n    if (numEn2Reps * en2RepDist > remainingDistanceForMainSet) {\n         numEn2Reps = 0;\n    }\n\n    if (numEn2Reps > 0) {\n        let en2Rest = `r${(Math.floor(Math.random() * (30 - 20 + 1)) + 20)}\"`;\n        sets.push(`${numEn2Reps}x${en2RepDist} ${energySystem} focus swim ${en2Rest}`);\n        mainSetTotalDist = numEn2Reps * en2RepDist;\n    } else {\n        mainSetTotalDist = 0;\n    }\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: `Threshold Sustained (${energySystem}) set.` };\n};\n","const en3Distances = [50, 100, 150, 200];\nconst en3SecondaryDistances = [200, 300, 400];\n\nexport const THRESHOLD_DEVELOPMENT = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = cssSecondsPer100 - (Math.random() * 3);\n    const en3Rest = `r${(Math.floor(Math.random() * (90 - 40 + 1)) + 40)}\"`;\n\n    if (remainingDistanceForMainSet < 50) { // Minimum for EN3 is typically 50\n         return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Threshold Development (${energySystem}) set - too short.` };\n    }\n\n    let en3RepDist = en3Distances[Math.floor(Math.random() * en3Distances.length)];\n\n    if (remainingDistanceForMainSet < en3RepDist) {\n         const possibleDists = en3Distances.filter(d => d <= remainingDistanceForMainSet);\n         if (possibleDists.length > 0) {\n             en3RepDist = possibleDists[possibleDists.length -1];\n         } else { // Should not happen if remainingDistanceForMainSet >= 50 and en3Distances includes 50\n             en3RepDist = 0; // will result in numEn3Reps = 0\n         }\n    }\n\n    let numEn3Reps = (en3RepDist > 0) ? Math.floor(remainingDistanceForMainSet / en3RepDist) : 0;\n    numEn3Reps = Math.min(numEn3Reps, 20);\n    // No Math.max(numEn3Reps, 0) needed as floor will be >=0. If en3RepDist is 0, numEn3Reps is 0.\n\n    if (numEn3Reps > 0) {\n        sets.push(`${numEn3Reps}x${en3RepDist} ${energySystem} focus swim/kb ${en3Rest}`);\n        mainSetTotalDist = numEn3Reps * en3RepDist;\n    }\n\n    let newRemainingDistance = remainingDistanceForMainSet - mainSetTotalDist;\n    if (newRemainingDistance > 400) {\n        let secondaryDist = en3SecondaryDistances[Math.floor(Math.random() * en3SecondaryDistances.length)];\n        if (newRemainingDistance < secondaryDist) { // try to pick a smaller secondary dist\n            const possibleSecDists = en3SecondaryDistances.filter(d => d <= newRemainingDistance);\n            if (possibleSecDists.length > 0) {\n                secondaryDist = possibleSecDists[possibleSecDists.length - 1];\n            } else {\n                secondaryDist = 0; // Cannot fit any secondary\n            }\n        }\n\n        let secondaryReps = 0;\n        if (secondaryDist > 0) {\n            secondaryReps = Math.floor(newRemainingDistance / secondaryDist);\n        }\n        secondaryReps = Math.min(secondaryReps, 10);\n\n        if (secondaryReps > 0) {\n            sets.push(`${secondaryReps}x${secondaryDist} ${energySystem} focus swim ${en3Rest}`);\n            mainSetTotalDist += secondaryReps * secondaryDist;\n        }\n    }\n\n    if (mainSetTotalDist === 0 && remainingDistanceForMainSet >= 50) {\n        let fallbackDist = en3Distances[0]; // Smallest standard EN3 distance (50)\n        if (remainingDistanceForMainSet < fallbackDist) fallbackDist = 0; // Should not happen if initial check is >=50\n\n        if (fallbackDist > 0) {\n             let fallbackReps = Math.floor(remainingDistanceForMainSet / fallbackDist);\n             fallbackReps = Math.min(fallbackReps, 5); // Cap fallback reps\n             if (fallbackReps > 0) {\n                sets.push(`${fallbackReps}x${fallbackDist} ${energySystem} focus swim ${en3Rest}`);\n                mainSetTotalDist = fallbackReps * fallbackDist;\n             }\n        }\n    }\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: `Threshold Development (${energySystem}) set.` };\n};\n","const sp1Distances = [25, 50, 75, 100];\nconst sp1Drills = [\"swim\", \"kb\", \"FU\", \"HUHO\"]; // FU = Fast Underwater, HUHO = Hypoxic Hips Out\n\nexport const SPEED_ENDURANCE = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = cssSecondsPer100 - (5 + Math.random() * 5);\n\n    if (remainingDistanceForMainSet < sp1Distances[0]) { // sp1Distances[0] is typically 25\n        return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Speed Endurance (${energySystem}) set - too short.` };\n    }\n\n    let numBlocks;\n    if (remainingDistanceForMainSet < 600) numBlocks = 1;\n    else if (remainingDistanceForMainSet < 1200) numBlocks = 2;\n    else numBlocks = 3;\n\n    let blockDistRemainingForReps = remainingDistanceForMainSet;\n    let accumulatedDist = 0;\n\n    for (let i = 0; i < numBlocks; i++) {\n        if (blockDistRemainingForReps < sp1Distances[0]) break;\n\n        let targetDistForCurrentBlock = Math.floor(blockDistRemainingForReps / (numBlocks - i));\n        let easyBreakDist = 0;\n        let addEasyBreakString = false;\n\n        if (i < numBlocks - 1 && (blockDistRemainingForReps - targetDistForCurrentBlock) > 100) { // Check if there's room for break AND next block\n            if (Math.random() > 0.5) {\n                if (targetDistForCurrentBlock > 150 && blockDistRemainingForReps - (targetDistForCurrentBlock - 50) >= 50 ) { // Ensure rep part & overall remaining is substantial\n                    easyBreakDist = 50;\n                    targetDistForCurrentBlock -= easyBreakDist;\n                    addEasyBreakString = true;\n                }\n            }\n        }\n\n        if (targetDistForCurrentBlock < sp1Distances[0] && addEasyBreakString) {\n            targetDistForCurrentBlock += easyBreakDist; // Reclaim break dist\n            easyBreakDist = 0;\n            addEasyBreakString = false;\n        }\n\n        if (targetDistForCurrentBlock < sp1Distances[0]) continue;\n\n        let repDist = sp1Distances[Math.floor(Math.random() * sp1Distances.length)];\n        if (repDist > targetDistForCurrentBlock && targetDistForCurrentBlock >= sp1Distances[0]) {\n            for (let j = sp1Distances.length - 1; j >= 0; j--) {\n                if (sp1Distances[j] <= targetDistForCurrentBlock) {\n                    repDist = sp1Distances[j];\n                    break;\n                }\n            }\n            if (repDist > targetDistForCurrentBlock && sp1Distances.length > 0 && sp1Distances[0] <= targetDistForCurrentBlock) {\n                 repDist = sp1Distances[0];\n            } else if (repDist > targetDistForCurrentBlock) { // Target too small even for smallest sp1Distance\n                continue;\n            }\n        } else if (repDist > targetDistForCurrentBlock) { // Initial random was too large, and target is smaller than smallest\n             continue;\n        }\n        if (repDist === 0 && sp1Distances.length > 0) repDist = sp1Distances[0];\n        if (repDist === 0) continue; // Should not happen if sp1Distances is not empty\n\n        let numReps = (repDist > 0) ? Math.floor(targetDistForCurrentBlock / repDist) : 0;\n        numReps = Math.min(numReps, 10); // Changed cap from 12 to 10\n\n        if (numReps > 0) {\n            const currentBlockActualRepDist = numReps * repDist;\n            let rest = `r${(Math.floor(Math.random() * (40 - 30 + 1)) + 30)}\"`;\n            let drillType = sp1Drills[Math.floor(Math.random() * sp1Drills.length)];\n            sets.push(`${numReps}x${repDist} ${drillType} (${energySystem} focus) ${rest}`);\n\n            accumulatedDist += currentBlockActualRepDist;\n            blockDistRemainingForReps -= currentBlockActualRepDist;\n\n            if (addEasyBreakString && easyBreakDist > 0) {\n                if (blockDistRemainingForReps >= easyBreakDist) {\n                    sets.push(\"50 ez + wait for top\");\n                    accumulatedDist += easyBreakDist;\n                    blockDistRemainingForReps -= easyBreakDist;\n                }\n            } else if (i < numBlocks - 1 && blockDistRemainingForReps > sp1Distances[0]) {\n                if (Math.random() > 0.3) sets.push(\"2min rest\");\n            }\n        } else if (easyBreakDist > 0) {\n             if (blockDistRemainingForReps >= easyBreakDist) {\n                sets.push(`${easyBreakDist} ez swim`);\n                accumulatedDist += easyBreakDist;\n                blockDistRemainingForReps -= easyBreakDist;\n             }\n        }\n    }\n    mainSetTotalDist = accumulatedDist;\n\n    if (mainSetTotalDist < remainingDistanceForMainSet * 0.75 && remainingDistanceForMainSet > 200) {\n        sets.length = 0;\n        mainSetTotalDist = 0; // Reset for fallback calculation\n        let fallbackRepDist = (remainingDistanceForMainSet > 400 && sp1Distances.includes(100)) ? 100 : (sp1Distances[1] || 50);\n        if (remainingDistanceForMainSet < fallbackRepDist && sp1Distances.length > 0) fallbackRepDist = (sp1Distances[0] || 25);\n\n        if (fallbackRepDist > 0) {\n            let fallbackNumReps = Math.floor(remainingDistanceForMainSet / fallbackRepDist);\n            fallbackNumReps = Math.min(fallbackNumReps, 16);\n            if (fallbackNumReps > 0) {\n                sets.push(`${fallbackNumReps}x${fallbackRepDist} swim (${energySystem} focus) r30\"`);\n                mainSetTotalDist = fallbackNumReps * fallbackRepDist;\n            }\n        }\n    }\n    if (mainSetTotalDist === 0 && remainingDistanceForMainSet >= sp1Distances[0]) {\n        let fDist = (remainingDistanceForMainSet >= 50 && sp1Distances.includes(50)) ? 50 : sp1Distances[0];\n        if (remainingDistanceForMainSet < fDist) {\n             return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Speed Endurance (${energySystem}) set - too short for fallback.` };\n        }\n        let fReps = Math.floor(remainingDistanceForMainSet/fDist);\n        fReps = Math.min(fReps, (fDist === 50 ? 8:12) );\n        if (fReps > 0) {\n             sets.push(`${fReps}x${fDist} swim (${energySystem} focus) r30\"`);\n             mainSetTotalDist = fReps * fDist;\n        }\n    }\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: `Speed Endurance (${energySystem}) set.` };\n};\n","const sp2Distances = [25, 50];\n\nexport const MAX_SPRINT = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = cssSecondsPer100 - (10 + Math.random() * 15);\n    let numReps = 0;\n    let repDist = 0;\n\n    const has50 = sp2Distances.includes(50);\n    const has25 = sp2Distances.includes(25);\n\n    if (remainingDistanceForMainSet < (has25 ? 25 : (has50 ? 50 : Infinity))) {\n         return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Max Sprint (${energySystem}) set - too short.` };\n    }\n\n    let initialRepDist;\n    if (has50 && remainingDistanceForMainSet >= 750) {\n        initialRepDist = 50;\n    } else if (has25) {\n        initialRepDist = 25;\n    } else if (has50) {\n        initialRepDist = 50;\n    } else {\n         return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `Max Sprint (${energySystem}) set - no valid distances.` };\n    }\n\n    const initialAbsoluteMaxReps = (initialRepDist === 50) ? 24 : 32; // Changed from 30:40\n    let numRepsForInitialDist = 0;\n    if (initialRepDist > 0) {\n        numRepsForInitialDist = Math.min(Math.floor(remainingDistanceForMainSet / initialRepDist), initialAbsoluteMaxReps);\n    }\n\n    let currentCalcDist = numRepsForInitialDist * initialRepDist;\n\n    repDist = initialRepDist;\n    numReps = numRepsForInitialDist;\n\n    if (initialRepDist === 25 && has50) {\n        const potentialReps50 = Math.min(Math.floor(remainingDistanceForMainSet / 50), 24); // Changed cap from 30 to 24\n        const potentialDist50 = potentialReps50 * 50;\n        const isSignificantUndershootWith25s = currentCalcDist < remainingDistanceForMainSet * 0.85;\n\n        if (isSignificantUndershootWith25s && potentialDist50 > currentCalcDist) {\n            repDist = 50;\n            numReps = potentialReps50;\n        }\n    }\n\n    if (numReps === 0 && repDist > 0 && remainingDistanceForMainSet >= repDist) {\n        numReps = 1;\n    }\n\n    if (numReps > 0 && repDist > 0) {\n        mainSetTotalDist = numReps * repDist;\n        const sp2Rest = \"1'r\";\n        sets.push(`${numReps}x${repDist} UW sprint (${energySystem} focus, breath at wall) @ ${sp2Rest}`);\n    } else {\n        mainSetTotalDist = 0;\n        sets = [];\n    }\n\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: `Max Sprint (${energySystem}) set.` };\n};\n","export const GENERAL_ENDURANCE = (energySystem, cssSecondsPer100, remainingDistanceForMainSet) => {\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100 = cssSecondsPer100;\n    const generalDistances = [400, 300, 200, 100, 50];\n    let bestRepDist = 0;\n    let bestNumReps = 0;\n    let smallestRemainder = Infinity;\n\n    if (remainingDistanceForMainSet < 25) { // Smallest possible rep distance\n        return { sets, mainSetTotalDist: 0, targetPacePer100, descriptiveMessage: `General Endurance (${energySystem}) set - too short.` };\n    }\n\n    for (const dist of generalDistances) {\n        if (remainingDistanceForMainSet >= dist) {\n            let currentNumReps = Math.floor(remainingDistanceForMainSet / dist);\n            let currentRemainder = remainingDistanceForMainSet - (currentNumReps * dist);\n            if (currentNumReps > 0) { // Only consider if at least one rep is possible\n                if (currentRemainder < smallestRemainder) {\n                    smallestRemainder = currentRemainder;\n                    bestRepDist = dist;\n                    bestNumReps = currentNumReps;\n                } else if (currentRemainder === smallestRemainder) {\n                    if (dist > bestRepDist) { // Prefer larger rep distance for same remainder\n                        bestRepDist = dist;\n                        bestNumReps = currentNumReps;\n                    }\n                }\n            }\n        }\n    }\n\n    if (bestNumReps === 0 && remainingDistanceForMainSet >= 25) {\n        // If no standard dist fits (e.g. remaining 75), make one up\n        // Try to make it a multiple of 25 or 50.\n        if (remainingDistanceForMainSet >= 50) {\n             bestRepDist = Math.floor(remainingDistanceForMainSet / 50) * 50;\n             if(bestRepDist === 0) bestRepDist = 50; // if remaining is e.g. 70, floor(70/50)*50 = 50\n        } else { // remaining is 25 to 49\n             bestRepDist = 25;\n        }\n        if (bestRepDist > 0) bestNumReps = Math.floor(remainingDistanceForMainSet / bestRepDist);\n        if (bestNumReps * bestRepDist > remainingDistanceForMainSet) bestNumReps = 0; // safety\n    }\n\n    // --- Start of new conservative adjustment logic ---\n    if (bestNumReps > 0 && bestRepDist > 0) {\n        let calculatedDist = bestNumReps * bestRepDist;\n\n        if (calculatedDist > remainingDistanceForMainSet * 0.80 && bestRepDist >= 200 && bestNumReps > 2) {\n            console.log(`DEBUG GENERAL_ENDURANCE: Conservative adjustment. Original reps: ${bestNumReps}x${bestRepDist}. Reducing reps by 1.`);\n            bestNumReps--;\n        }\n    }\n    // --- End of new conservative adjustment logic ---\n\n    if (bestNumReps > 0 && bestRepDist > 0) { // Ensure still valid after potential decrement\n        let restTime = 30;\n        if (bestRepDist >= 400) restTime = 45;\n        else if (bestRepDist >= 200) restTime = 30;\n        else if (bestRepDist >= 100) restTime = 20;\n        else restTime = 15;\n        sets.push(`${bestNumReps}x${bestRepDist} swim (${energySystem} focus) r${restTime}\"`);\n        mainSetTotalDist = bestNumReps * bestRepDist;\n    } else {\n         mainSetTotalDist = 0;\n    }\n    return { sets, mainSetTotalDist, targetPacePer100, descriptiveMessage: `General Endurance (${energySystem}) default set.` };\n};\n","import { ENDURANCE_BASE } from './mainSets/ENDURANCE_BASE.js';\nimport { THRESHOLD_SUSTAINED } from './mainSets/THRESHOLD_SUSTAINED.js';\nimport { THRESHOLD_DEVELOPMENT } from './mainSets/THRESHOLD_DEVELOPMENT.js';\nimport { SPEED_ENDURANCE } from './mainSets/SPEED_ENDURANCE.js';\nimport { MAX_SPRINT } from './mainSets/MAX_SPRINT.js';\nimport { GENERAL_ENDURANCE } from './mainSets/GENERAL_ENDURANCE.js';\n\nconst mainSetDefinitions = {\n    'ENDURANCE_BASE': ENDURANCE_BASE,\n    'THRESHOLD_SUSTAINED': THRESHOLD_SUSTAINED,\n    'THRESHOLD_DEVELOPMENT': THRESHOLD_DEVELOPMENT,\n    'SPEED_ENDURANCE': SPEED_ENDURANCE,\n    'MAX_SPRINT': MAX_SPRINT,\n    'GENERAL_ENDURANCE': GENERAL_ENDURANCE\n};\n\nexport { mainSetDefinitions };\n","/**\n * Selects a warmup routine.\n * There's a 90% chance of selecting a warmup from the availableWarmups array,\n * and a 10% chance of selecting the noWarmupOption.\n *\n * @param {Array<Object>} availableWarmups - An array of warmup objects. Each object should have at least 'desc' and 'dist' properties.\n * @param {Object} noWarmupOption - An object representing the option of no warmup. Should have 'desc' and 'dist'.\n * @returns {Object} The selected warmup object.\n */\nfunction selectWarmup(availableWarmups, noWarmupOption) {\n    const useWarmup = Math.random() > 0.1; // 90% chance of including a warmup\n\n    if (useWarmup && availableWarmups && availableWarmups.length > 0) {\n        return availableWarmups[Math.floor(Math.random() * availableWarmups.length)];\n    } else {\n        return noWarmupOption;\n    }\n}\n\n/**\n * Selects a cooldown routine randomly from the available options.\n *\n * @param {Array<Object>} availableCooldowns - An array of cooldown objects. Each object should have at least 'desc' and 'dist' properties.\n * @returns {Object|null} The selected cooldown object, or null if no cooldowns are available or an error occurs.\n */\nfunction selectCooldown(availableCooldowns) {\n    if (availableCooldowns && availableCooldowns.length > 0) {\n        return availableCooldowns[Math.floor(Math.random() * availableCooldowns.length)];\n    }\n    return null; // Or return a default cooldown if preferred\n}\n\n/**\n * Generates the main set for a workout based on the energy system.\n *\n * @param {string} energySystem - The energy system focus (e.g., 'EN1', 'EN2').\n * @param {number} cssSecondsPer100 - Critical Swim Speed in seconds per 100 units.\n * @param {number} remainingDistanceForMainSet - The distance available for the main set.\n * @param {string} workoutType - The type of workout (e.g., 'THRESHOLD_SUSTAINED').\n * @param {string} energySystem - The energy system focus (e.g., 'EN1', 'EN2').\n * @param {number} cssSecondsPer100 - Critical Swim Speed in seconds per 100 units.\n * @param {number} remainingDistanceForMainSet - The distance available for the main set.\n * @param {Object} mainSetDefinitions - Object mapping workout types to generator functions.\n * @returns {{ sets: string[], mainSetTotalDist: number, targetPacePer100: number, descriptiveMessage?: string }}\n *           An object containing the sets, total distance of the main set, target pace,\n *           and an optional descriptive message for unknown or default systems.\n */\nfunction generateMainSet(workoutType, energySystem, cssSecondsPer100, remainingDistanceForMainSet, mainSetDefinitions) {\n    let generator = mainSetDefinitions[workoutType];\n    let messageFromOuterScope;\n\n    if (!generator) {\n        messageFromOuterScope = `Unknown workout type: ${workoutType}. Defaulting to general endurance.`;\n        generator = mainSetDefinitions['GENERAL_ENDURANCE'];\n    }\n\n    // The generator function now expects energySystem as its first param.\n    let mainSetOutput = generator(energySystem, cssSecondsPer100, remainingDistanceForMainSet);\n\n    // Fallback condition: if the selected generator (not GENERAL_ENDURANCE) produced a very small set\n    if (mainSetOutput.mainSetTotalDist < 100 && remainingDistanceForMainSet > 100 && workoutType !== 'GENERAL_ENDURANCE') {\n        let fallbackMessage = \"(Fallback to general endurance due to low generated distance for selected workout type).\";\n\n        const originalMessage = mainSetOutput.descriptiveMessage; // Message from the original, tiny set\n        mainSetOutput = mainSetDefinitions['GENERAL_ENDURANCE'](energySystem, cssSecondsPer100, remainingDistanceForMainSet); // Rerun with GENERAL_ENDURANCE\n\n        // Construct descriptive message for fallback\n        let finalFallbackMessage = fallbackMessage;\n        if (originalMessage) { // If the original (tiny) set had a message\n            finalFallbackMessage = originalMessage + \" \" + fallbackMessage;\n        } else if (mainSetOutput.descriptiveMessage) { // If GENERAL_ENDURANCE set has a message\n            finalFallbackMessage = fallbackMessage + \" \" + mainSetOutput.descriptiveMessage;\n        }\n        mainSetOutput.descriptiveMessage = finalFallbackMessage;\n    } else {\n        // No fallback, or it was a direct 'GENERAL_ENDURANCE' call.\n        // If messageFromOuterScope was set (i.e., unknown workout type), it takes precedence\n        // unless the generator provided its own more specific message.\n        if (messageFromOuterScope) {\n            if (!mainSetOutput.descriptiveMessage) {\n                mainSetOutput.descriptiveMessage = messageFromOuterScope;\n            } else {\n                // If generator (GENERAL_ENDURANCE in this case) set a message, and it was an unknown type,\n                // combine or prioritize. For now, \"Unknown type\" message is more specific to the situation.\n                mainSetOutput.descriptiveMessage = messageFromOuterScope + \" Original generator message: \" + mainSetOutput.descriptiveMessage;\n            }\n        } else if (workoutType === 'GENERAL_ENDURANCE' && !mainSetOutput.descriptiveMessage) {\n            // If it was a direct 'GENERAL_ENDURANCE' call and the generator provided no message (unlikely with current data)\n            mainSetOutput.descriptiveMessage = `General Endurance (${energySystem}) set.`;\n        }\n    }\n    return mainSetOutput;\n}\n\nconst workoutFunctions = {\n    selectWarmup,\n    selectCooldown,\n    generateMainSet\n};\n\nexport default workoutFunctions;\n","import { warmups, noWarmupOption } from './data/warmups.js';\nimport { cooldowns } from './data/cooldowns.js';\nimport { mainSetDefinitions } from './data/mainSets.js';\nimport workoutComponents from './workoutComponents.js';\n\n// Helper function to convert MM:SS time string to total seconds per 100 units\nexport function parseCssTimeToSeconds(cssTimeStr) {\n    if (typeof cssTimeStr !== 'string') {\n        return null;\n    }\n    const parts = cssTimeStr.split(':');\n    if (parts.length === 2) {\n        const minutes = parseInt(parts[0], 10);\n        const seconds = parseFloat(parts[1]);\n        if (isNaN(minutes) || isNaN(seconds)) {\n            return null;\n        }\n        return minutes * 60 + seconds;\n    }\n    return null; // Invalid format\n}\n\n// Helper function to format total seconds per 100 units back to MM:SS\nexport function formatSecondsToMmSs(totalSeconds) {\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = (totalSeconds % 60).toFixed(1); // One decimal for seconds\n    return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;\n}\n\n/**\n * Generates a random workout based on distance, energy system, and CSS time.\n * @param {number} totalDistanceYards - The approximate total desired workout distance in yards.\n * @param {string} energySystem - The energy system focus (e.g., 'EN1', 'EN2', 'EN3', 'SP1', 'SP2').\n * @param {string} cssTimeMmSs - The Critical Swim Speed in MM:SS format (e.g., '1:10').\n * @param {string} workoutType - The type of workout (e.g., 'threshold', 'anaerobic').\n * @returns {string} A formatted string describing the generated workout.\n */\nfunction generateWorkout(totalDistanceYards, energySystem, cssTimeMmSs, workoutType) {\n    const VERY_SHORT_WORKOUT_THRESHOLD = 600; // yards\n    // noWarmupOption is imported and can be used directly or cloned if description needs change for this specific case\n    // const noWarmupForShortOption = { ...noWarmupOption, desc: \"No warmup (short workout)\" };\n\n    const cssSecondsPer100 = parseCssTimeToSeconds(cssTimeMmSs);\n    if (cssSecondsPer100 === null) {\n        return \"Error: Invalid CSS time format. Please use MM:SS (e.g., '1:10').\";\n    }\n\n    let workoutDetails = [];\n    let currentDistanceCovered = 0;\n    const mainSetUnits = \"yards\"; // Assuming SCY based on sources unless specified otherwise [7, 9, 16]\n\n    // --- 1. Warmup Selection ---\n    let selectedWarmup;\n    if (totalDistanceYards < VERY_SHORT_WORKOUT_THRESHOLD) {\n        selectedWarmup = { ...noWarmupOption, desc: \"No warmup (short workout)\" };\n    } else {\n        // Re-introducing adaptive warmup logic for non-very-short workouts, with the specified modification\n        selectedWarmup = workoutComponents.selectWarmup(warmups, noWarmupOption); // Initial selection\n        if (selectedWarmup && selectedWarmup.dist > 0) {\n            const minMainSetThreshold = 200;\n            let maxAllowedWarmupDist = totalDistanceYards - minMainSetThreshold;\n\n            // Apply the more stringent percentage cap: 0.4 (40%) instead of 0.6\n            maxAllowedWarmupDist = Math.min(maxAllowedWarmupDist, totalDistanceYards * 0.4);\n\n            if (maxAllowedWarmupDist < 0 && totalDistanceYards > 0) {\n                 maxAllowedWarmupDist = totalDistanceYards * 0.4; // Fallback for small total distances if threshold makes it negative\n                                                                  // This 0.4 is different from the one above.\n                                                                  // Let's keep it as it was for this specific fallback:\n                 // maxAllowedWarmupDist = totalDistanceYards * 0.4; // This logic was for very small total distances\n                 // The logic from file before reset was:\n                 // if (maxAllowedWarmupDist < 0 && totalDistanceYards > 0) { maxAllowedWarmupDist = totalDistanceYards * 0.4; }\n                 // This specific 0.4 should remain if it's for the negative guard, distinct from the primary cap.\n                 // Re-evaluating based on typical structure: the primary cap (now 0.4) applies first.\n                 // Then, specific conditions for very small distances adjust if it results in negative or too small.\n                 // The previous adaptive logic was:\n                 // maxAllowedWarmupDist = Math.min(maxAllowedWarmupDist, totalDistanceYards * 0.6); // This is now 0.4\n                 // if (maxAllowedWarmupDist < 0 && totalDistanceYards > 0) { maxAllowedWarmupDist = totalDistanceYards * 0.4; }\n                 // The above line (totalDistanceYards * 0.4) was a fallback if the (totalDistanceYards - minMainSetThreshold) was negative.\n                 // It seems the logic should be:\n                 // 1. max = total - threshold\n                 // 2. max = min(max, total * NEW_PRIMARY_CAP (0.4))\n                 // 3. if max < 0 (because total was small), max = total * FALLBACK_CAP_FOR_SMALL_TOTAL (e.g. 0.4 or 0.5)\n                 // 4. if max < 50 (and total >=50), max = 50.\n                 // Let's stick to the prompt's direct change on the percentage line first.\n                 // The other parts of the adaptive logic are:\n            } // End of the \"maxAllowedWarmupDist < 0\" check\n\n            if (maxAllowedWarmupDist < 50 && totalDistanceYards >= 50) {\n                 maxAllowedWarmupDist = 50;\n            }\n            // Add a final guard if maxAllowedWarmupDist somehow ended up negative (e.g. if totalDistanceYards was < 50 but > 0)\n            if (maxAllowedWarmupDist < 0) maxAllowedWarmupDist = 0;\n\n\n            if (selectedWarmup.dist > maxAllowedWarmupDist) {\n                const suitableWarmups = warmups.filter(wu => wu.dist <= maxAllowedWarmupDist && wu.dist > 0);\n                if (suitableWarmups.length > 0) {\n                    selectedWarmup = suitableWarmups[Math.floor(Math.random() * suitableWarmups.length)];\n                } else {\n                    selectedWarmup = noWarmupOption;\n                }\n            }\n        } else if (!selectedWarmup || selectedWarmup.dist === 0) {\n            selectedWarmup = noWarmupOption;\n        }\n    }\n\n    if (selectedWarmup) {\n        workoutDetails.push(`WU: ${selectedWarmup.desc}`);\n        currentDistanceCovered += selectedWarmup.dist;\n    }\n\n    // --- 2. Main Set Generation ---\n    let mainSetDescription = \"Main Set:\";\n    let sets = [];\n    let mainSetTotalDist = 0;\n    let targetPacePer100;\n    let remainingDistanceForMainSet = totalDistanceYards - currentDistanceCovered;\n\n    const mainSetResult = workoutComponents.generateMainSet(workoutType, energySystem, cssSecondsPer100, remainingDistanceForMainSet, mainSetDefinitions);\n    sets = mainSetResult.sets;\n    mainSetTotalDist = mainSetResult.mainSetTotalDist;\n    targetPacePer100 = mainSetResult.targetPacePer100;\n\n    if (mainSetResult.descriptiveMessage) {\n        mainSetDescription += ` ${mainSetResult.descriptiveMessage}`;\n    }\n\n    workoutDetails.push(mainSetDescription);\n    sets.forEach(set => {\n        workoutDetails.push(`  - ${set}`);\n    });\n    currentDistanceCovered += mainSetTotalDist;\n\n    // --- 3. Cool-down Selection ---\n    let selectedCooldown;\n    const noCooldownForShortOption = { desc: \"No cooldown (short workout)\", dist: 0, type: \"none\" };\n\n    if (totalDistanceYards < VERY_SHORT_WORKOUT_THRESHOLD) {\n        selectedCooldown = noCooldownForShortOption;\n    } else {\n        // Re-introducing adaptive cooldown logic with the specified modification\n        const generalNoCooldownOption = { desc: \"No cooldown\", dist: 0, type: \"none\" }; // General purpose\n        const distanceAfterMainSet = currentDistanceCovered;\n        const distanceToTarget = totalDistanceYards - distanceAfterMainSet;\n\n        if (distanceAfterMainSet >= totalDistanceYards - 50) {\n            selectedCooldown = generalNoCooldownOption;\n        } else {\n            // Apply the more stringent buffer: 25 instead of 75\n            const suitableCooldowns = cooldowns.filter(cd => cd.dist <= distanceToTarget + 25);\n\n            if (suitableCooldowns.length > 0) {\n                selectedCooldown = suitableCooldowns[Math.floor(Math.random() * suitableCooldowns.length)];\n            } else {\n                selectedCooldown = generalNoCooldownOption;\n            }\n        }\n    }\n\n    if (selectedCooldown) {\n        workoutDetails.push(`CD: ${selectedCooldown.desc}`);\n        currentDistanceCovered += selectedCooldown.dist;\n    }\n\n    // --- 4. Final Details ---\n    workoutDetails.push(`\\nTotal estimated distance: ${currentDistanceCovered} ${mainSetUnits}`);\n    workoutDetails.push(`CSS: ${cssTimeMmSs}`);\n    workoutDetails.push(`Workout Type: ${workoutType}`); // Added Workout Type\n    workoutDetails.push(`Energy System Focus: ${energySystem.toUpperCase()}`);\n    // A rough estimate of average pace, as true average depends on actual interval times and rest\n    workoutDetails.push(`Estimated AVG pace for main set: ${formatSecondsToMmSs(targetPacePer100)} / 100 ${mainSetUnits}`);\n\n    return workoutDetails.join('\\n');\n}\n\nexport { generateWorkout }; // Keep generateWorkout exported as it's likely the main API\n\n// --- Example Usage ---\n// console.log(generateWorkout(3000, 'EN3', '1:20'));\n// console.log(generateWorkout(2000, 'SP1', '1:10'));\n// console.log(generateWorkout(1500, 'SP2', '1:15'));\n// console.log(generateWorkout(2500, 'EN2', '1:12'));\n// console.log(generateWorkout(1800, 'EN1', '1:25'));","import _ from 'lodash';\n\nexport function getThingViaTimeLimit(key, secondsLeft, things, number = 1) {\n  let filteredThings = _.filter(things, thing => (thing[key] * number) <= secondsLeft);\n  return _.sample(filteredThings);\n}\n","import _ from 'lodash';\nimport {getThingViaTimeLimit} from './getThingViaTimeLimit';\nimport swims from './data/swims.json';\n\nexport function repeatIntervals(secondsLeft, generatedPattern) {\n  if (secondsLeft < 20) {\n    // console.log(`weird amount of time left: ${secondsLeft}. returning original pattern`);\n    return generatedPattern;\n  }\n\n  // console.log('repeatIntervals');\n\n  let seconds = 0;\n  let selectedSwim = getThingViaTimeLimit(\"time\", secondsLeft, swims);\n\n  // console.log(`repeating interval of type ${selectedSwim.name}`)\n\n  while (seconds + selectedSwim.time <= secondsLeft) {\n    let timeLeft = secondsLeft - seconds;\n    let maxRepetition = Math.floor(timeLeft / selectedSwim.time);\n\n    // attempt to keep max length 200 or less\n    maxRepetition = (maxRepetition * selectedSwim.interval) > 8 ?\n      Math.floor(8 / selectedSwim.interval) :\n      maxRepetition;\n\n    let intervalLength = _.random(1, maxRepetition);\n    let secondsToAdd = selectedSwim.time * intervalLength;\n\n    // console.log('adding swim', selectedSwim);\n\n    seconds += secondsToAdd;\n    generatedPattern.seconds += secondsToAdd;\n    generatedPattern.intervals.push(\n      {\n        type: selectedSwim.name,\n        length: selectedSwim.interval * 25 * intervalLength,\n        number: 1,\n        time: secondsToAdd\n      }\n    );\n  }\n\n  return generatedPattern;\n}\n","import _ from 'lodash';\nimport swims from './data/swims.json';\n\nfunction getSwimByLength(secondsLeft, intervalLength, number) {\n  if (secondsLeft < 20 * number) {\n    // console.log(`weird amount of time left: ${secondsLeft}. returning null`);\n    return null;\n  }\n\n  let selectSwim;\n  let numThings = 0;\n\n  let filteredSwims = _.cloneDeep(swims);\n\n  while (!selectSwim) {\n    numThings++;\n    selectSwim = _.sample(filteredSwims);\n\n    if ((selectSwim.time * number) > secondsLeft) {\n      // console.log(`swim too long ${selectSwim.time} ${number} ${secondsLeft}`);\n      filteredSwims = _.filter(filteredSwims, swim => swim.time < selectSwim.time);\n      selectSwim = null;\n    } else if ((selectSwim.interval > intervalLength) || (intervalLength % selectSwim.interval !== 0)) {\n      // console.log(`interval too long ${selectSwim.interval} ${intervalLength}`);\n      filteredSwims = _.filter(filteredSwims, swim => swim.interval < selectSwim.interval);\n      selectSwim = null;\n    }\n\n    if (numThings > 20) {throw new Error(`fuck ${secondsLeft} ${intervalLength} ${number}`);}\n  }\n\n  return selectSwim;\n}\n\nfunction createSwimGroupCount(selectedPattern) {\n  return _.reduce(selectedPattern.pattern, (result, set) => {\n    let swimLength = set.interval[1];\n\n    if(!result[set.group]) {\n      result[set.group] = { number: 1, intervalLength: swimLength}\n    } else {\n      result[set.group].number += 1;\n      result[set.group].intervalLength = _.min([result[set.group].intervalLength, swimLength]);\n    }\n\n    return result;\n  }, {});\n}\n\nfunction mapSwimGroupsToSwims(secondsLeft, selectedPattern, groupsWithCount) {\n  let groupsWithSwim = {};\n\n  let sets = selectedPattern.pattern.length;\n\n  // Find a swim which will fit the pattern and the time remaining\n  _.forEach(groupsWithCount, (groupSize, key) => {\n    let intervalSize = selectedPattern.intervalSize;\n    let otherSetTimes = (sets - groupSize.number) * intervalSize * 20;\n    let selectedSwim = getSwimByLength(\n      secondsLeft - otherSetTimes,\n      groupSize.intervalLength,\n      groupSize.number * intervalSize\n    );\n\n    groupsWithSwim[key] = selectedSwim;\n  });\n\n  return groupsWithSwim;\n}\n\nexport function createSwimsFromPattern(secondsLeft, generatedPattern, selectedPattern) {\n  if (secondsLeft < 20) {\n    // console.log(`weird amount of time left: ${secondsLeft}. returning original pattern`);\n    return generatedPattern;\n  }\n\n  let groupsWithCount = createSwimGroupCount(selectedPattern);\n  let groupsWithSwim = mapSwimGroupsToSwims(secondsLeft, selectedPattern, groupsWithCount);\n\n  // once we've figured out which swims go where, generate the intervals\n  _.forEach(selectedPattern.pattern, pattern => {\n    let selectedSwim = groupsWithSwim[pattern.group];\n    let numIntervals = pattern.interval[0];\n    let swimLength = pattern.interval[1];\n\n    // Some swims are > 1 lap\n    let intervalMultiplier = swimLength / selectedSwim.interval;\n    let totalSwimTime = selectedSwim.time * numIntervals * (intervalMultiplier);\n\n    generatedPattern.seconds += totalSwimTime;\n    generatedPattern.intervals.push(\n      {\n        type: selectedSwim.name,\n        length: swimLength * 25,\n        number: numIntervals,\n        time: selectedSwim.time * intervalMultiplier\n      }\n    );\n  });\n\n  return generatedPattern;\n}\n","import _ from 'lodash';\nimport patterns from './data/patterns.json';\nimport { generateWorkout as generateCssWorkout } from './css.js';\nimport {getThingViaTimeLimit} from './getThingViaTimeLimit';\nimport {repeatIntervals} from './repeatIntervals';\nimport {createSwimsFromPattern} from './createPattern';\n\nfunction isSameType(intervalA, intervalB) {\n  return intervalA.type === intervalB.type\n    && intervalA.length === intervalB.length\n    && intervalA.time === intervalB.time;\n}\n\nfunction doubleLengths(pattern) {\n  // console.log('doubleLengths');\n  pattern.seconds *= 2;\n\n  _.forEach(pattern.intervals, interval => {\n    interval.length *= 2;\n    interval.time *= 2;\n  });\n}\n\nfunction doubleIntervals(pattern) {\n  // console.log('doubleIntervals');\n  pattern.seconds *= 2;\n\n  _.forEach(pattern.intervals, interval => {\n    interval.number *= 2;\n  });\n}\n\nfunction condenseWorkout(pattern) {\n  pattern.intervals = pattern.intervals.reduce((memo, interval) => {\n    let intervalsLength = memo.length;\n\n    if(intervalsLength === 0) {\n      memo.push(interval);\n      return memo;\n    }\n\n    if (isSameType(memo[intervalsLength -1], interval)) {\n      // console.log('condensing', memo[intervalsLength - 1], interval);\n      memo[intervalsLength - 1].number += interval.number;\n    } else {\n      memo.push(interval)\n    }\n\n    return memo;\n  }, []);\n\n  // console.log(pattern);\n\n  return pattern;\n}\n\nexport { generateCssWorkout };\n\nexport function generatePattern(seconds, generatedPattern = { seconds: 0, intervals: [] }) {\n  if (seconds < 20) {\n    // console.log(`weird amount of time left: ${seconds}. returning generated pattern`);\n    return generatedPattern;\n  }\n\n  // console.log('generatePattern');\n\n  let timeLeft = seconds - generatedPattern.seconds;\n  let selectedPattern = getThingViaTimeLimit(\"minTime\", timeLeft, patterns);\n\n  // console.log(`attempting to generate ${selectedPattern.name} pattern, which needs ${selectedPattern.minTime}, and has ${timeLeft}`)\n\n  if (selectedPattern.repeat === true) {\n    return repeatIntervals(timeLeft, generatedPattern);\n  } else {\n    return createSwimsFromPattern(timeLeft, generatedPattern, selectedPattern);\n  }\n}\n\nexport function generateWorkout(seconds) {\n  if (!seconds) { throw new Error('Give me time!'); }\n\n  let pattern = generatePattern(seconds);\n\n  while ((pattern.seconds < (seconds / 2)) && (pattern.seconds >= 20)) {\n    switch(_.random(1,3)) {\n      case 1:\n        doubleLengths(pattern);\n        break;\n      case 2:\n        doubleIntervals(pattern);\n        break;\n      case 3:\n        // add new workout to pattern\n        generatePattern(seconds, pattern);\n        break;\n    }\n  }\n\n  while (seconds - pattern.seconds >= 20) {\n    generatePattern(seconds, pattern);\n  }\n\n  pattern = condenseWorkout(pattern);\n\n  return pattern;\n}\n"],"names":["warmups","desc","dist","type","noWarmupOption","cooldowns","en1Distances","ENDURANCE_BASE","energySystem","cssSecondsPer100","remainingDistanceForMainSet","sets","mainSetTotalDist","targetPacePer100","Math","random","descriptiveMessage","concat","en1RepDist","numEn1Reps","shortEn1Dists","_i","_shortEn1Dists","length","floor","midEn1Dists","bestCurrentRepDist","bestCurrentNumReps","smallestRemainderSoFar","Infinity","_i2","_midEn1Dists","currentNumReps","maxRepsForDist","min","currentRemainder","selectedDist","j","en1Rest","push","en2Distances","THRESHOLD_SUSTAINED","en2RepDist","possibleDists","filter","d","numEn2Reps","max","en2Rest","en3Distances","en3SecondaryDistances","THRESHOLD_DEVELOPMENT","en3Rest","en3RepDist","numEn3Reps","newRemainingDistance","secondaryDist","possibleSecDists","secondaryReps","fallbackDist","fallbackReps","sp1Distances","sp1Drills","SPEED_ENDURANCE","numBlocks","blockDistRemainingForReps","accumulatedDist","i","targetDistForCurrentBlock","easyBreakDist","addEasyBreakString","repDist","numReps","currentBlockActualRepDist","rest","drillType","fallbackRepDist","includes","fallbackNumReps","fDist","fReps","sp2Distances","MAX_SPRINT","has50","has25","initialRepDist","initialAbsoluteMaxReps","numRepsForInitialDist","currentCalcDist","potentialReps50","potentialDist50","isSignificantUndershootWith25s","sp2Rest","GENERAL_ENDURANCE","generalDistances","bestRepDist","bestNumReps","smallestRemainder","_generalDistances","calculatedDist","console","log","restTime","mainSetDefinitions","selectWarmup","availableWarmups","useWarmup","selectCooldown","availableCooldowns","generateMainSet","workoutType","generator","messageFromOuterScope","mainSetOutput","fallbackMessage","originalMessage","finalFallbackMessage","workoutFunctions","parseCssTimeToSeconds","cssTimeStr","parts","split","minutes","parseInt","seconds","parseFloat","isNaN","formatSecondsToMmSs","totalSeconds","toFixed","generateWorkout","totalDistanceYards","cssTimeMmSs","VERY_SHORT_WORKOUT_THRESHOLD","workoutDetails","currentDistanceCovered","mainSetUnits","selectedWarmup","_objectSpread","workoutComponents","minMainSetThreshold","maxAllowedWarmupDist","suitableWarmups","wu","mainSetDescription","mainSetResult","forEach","set","selectedCooldown","noCooldownForShortOption","generalNoCooldownOption","distanceAfterMainSet","distanceToTarget","suitableCooldowns","cd","toUpperCase","join","getThingViaTimeLimit","key","secondsLeft","things","number","arguments","undefined","filteredThings","_","thing","sample","repeatIntervals","generatedPattern","selectedSwim","swims","time","timeLeft","maxRepetition","interval","intervalLength","secondsToAdd","intervals","name","getSwimByLength","selectSwim","numThings","filteredSwims","cloneDeep","swim","Error","createSwimGroupCount","selectedPattern","reduce","pattern","result","swimLength","group","mapSwimGroupsToSwims","groupsWithCount","groupsWithSwim","groupSize","intervalSize","otherSetTimes","createSwimsFromPattern","numIntervals","intervalMultiplier","totalSwimTime","isSameType","intervalA","intervalB","doubleLengths","doubleIntervals","condenseWorkout","memo","intervalsLength","generatePattern","patterns","repeat"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA,IAAMA,OAAO,GAAG,CACZ;EAAEC,EAAAA,IAAI,EAAE,8BAA8B;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAO,CAAC;EAAE;EACnE;EAAEF,EAAAA,IAAI,EAAE,gCAAgC;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAO,CAAC;EAAE;EACrE;EAAEF,EAAAA,IAAI,EAAE,kCAAkC;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAY,CAAC;EAAE;EAC5E;EAAEF,EAAAA,IAAI,EAAE,YAAY;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EACpD;EAAEF,EAAAA,IAAI,EAAE,aAAa;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EACrD;EAAEF,EAAAA,IAAI,EAAE,YAAY;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EACpD;EAAEF,EAAAA,IAAI,EAAE,aAAa;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EACrD;EAAEF,EAAAA,IAAI,EAAE,aAAa;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE,CACxD;;EAED;EACA,IAAMC,cAAc,GAAG;EAAEH,EAAAA,IAAI,EAAE,mBAAmB;EAAEC,EAAAA,IAAI,EAAE,CAAC;EAAEC,EAAAA,IAAI,EAAE;EAAO,CAAC,CAAC;;ECb5E;EACA,IAAME,SAAS,GAAG,CACd;EAAEJ,EAAAA,IAAI,EAAE,uBAAuB;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAO,CAAC;EAAE;EAC5D;EAAEF,EAAAA,IAAI,EAAE,mBAAmB;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAO,CAAC;EAAE;EACxD;EAAEF,EAAAA,IAAI,EAAE,eAAe;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EACvD;EAAEF,EAAAA,IAAI,EAAE,QAAQ;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EAChD;EAAEF,EAAAA,IAAI,EAAE,QAAQ;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EAChD;EAAEF,EAAAA,IAAI,EAAE,oCAAoC;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAa,CAAC;EAAE;EAC/E;EAAEF,EAAAA,IAAI,EAAE,UAAU;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EAClD;EAAEF,EAAAA,IAAI,EAAE,6CAA6C;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE;EACrF;EAAEF,EAAAA,IAAI,EAAE,uBAAuB;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAW,CAAC;EAAE;EAChE;EAAEF,EAAAA,IAAI,EAAE,eAAe;EAAEC,EAAAA,IAAI,EAAE,GAAG;EAAEC,EAAAA,IAAI,EAAE;EAAU,CAAC;EAAE,CAC1D;;ECZD,IAAMG,YAAY,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EAElC,IAAMC,cAAc,GAAG,SAAjBA,cAAcA,CAAIC,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAK;IAC3F,IAAIC,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;IACxB,IAAIC,gBAAgB,GAAGJ,gBAAgB,GAAIK,IAAI,CAACC,MAAM,EAAE,GAAG,CAAE;IAE7D,IAAIL,2BAA2B,GAAG,EAAE,EAAE;MAClC,OAAO;EAAEC,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,kBAAA,CAAAC,MAAA,CAAqBT,YAAY,EAAA,oBAAA;OAAsB;EACnI;IAEA,IAAIU,UAAU,GAAG,CAAC;IAClB,IAAIC,UAAU,GAAG,CAAC;IAElB,IAAIT,2BAA2B,GAAG,GAAG,EAAE;EAAE;EACrC,IAAA,IAAMU,aAAa,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;EAClD,IAAA,KAAA,IAAAC,EAAA,GAAA,CAAA,EAAAC,cAAA,GAAmBF,aAAa,EAAAC,EAAA,GAAAC,cAAA,CAAAC,MAAA,EAAAF,EAAA,EAAE,EAAA;EAA7B,MAAA,IAAMnB,IAAI,GAAAoB,cAAA,CAAAD,EAAA,CAAA;QACX,IAAIX,2BAA2B,IAAIR,IAAI,EAAE;EACrCgB,QAAAA,UAAU,GAAGhB,IAAI;UACjBiB,UAAU,GAAGL,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGQ,UAAU,CAAC;EACjE,QAAA,MAAM;EACV;EACJ;EACJ,GAAC,MAAM,IAAIR,2BAA2B,IAAI,GAAG,EAAE;EAAE;EAC7C,IAAA,IAAMe,WAAW,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;MACtD,IAAIC,kBAAkB,GAAG,CAAC;MAC1B,IAAIC,kBAAkB,GAAG,CAAC;MAC1B,IAAIC,sBAAsB,GAAGC,QAAQ;EAErC,IAAA,KAAA,IAAAC,GAAA,GAAA,CAAA,EAAAC,YAAA,GAAmBN,WAAW,EAAAK,GAAA,GAAAC,YAAA,CAAAR,MAAA,EAAAO,GAAA,EAAE,EAAA;EAA3B,MAAA,IAAM5B,KAAI,GAAA6B,YAAA,CAAAD,GAAA,CAAA;QACX,IAAIpB,2BAA2B,IAAIR,KAAI,EAAE;UACrC,IAAI8B,cAAc,GAAGlB,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGR,KAAI,CAAC;EACnE;EACA,QAAA,IAAI+B,cAAc,GAAG,CAAC,CAAC;EACvB,QAAA,IAAI/B,KAAI,IAAI,GAAG,EAAE+B,cAAc,GAAG,CAAC,CAAC,KAC/B,IAAI/B,KAAI,IAAI,GAAG,EAAE+B,cAAc,GAAG,CAAC;UACxCD,cAAc,GAAGlB,IAAI,CAACoB,GAAG,CAACF,cAAc,EAAEC,cAAc,CAAC;UAEzD,IAAID,cAAc,KAAK,CAAC,EAAE;EAE1B,QAAA,IAAIG,gBAAgB,GAAGzB,2BAA2B,GAAIsB,cAAc,GAAG9B,KAAK;UAC5E,IAAIiC,gBAAgB,GAAGP,sBAAsB,EAAE;EAC3CA,UAAAA,sBAAsB,GAAGO,gBAAgB;EACzCT,UAAAA,kBAAkB,GAAGxB,KAAI;EACzByB,UAAAA,kBAAkB,GAAGK,cAAc;EACvC,SAAC,MAAM,IAAIG,gBAAgB,KAAKP,sBAAsB,EAAE;YACpD,IAAI1B,KAAI,GAAGwB,kBAAkB,EAAE;EAAE;EAC7BA,YAAAA,kBAAkB,GAAGxB,KAAI;EACzByB,YAAAA,kBAAkB,GAAGK,cAAc;EACvC;EACJ;EACJ;EACJ;EACAd,IAAAA,UAAU,GAAGQ,kBAAkB;EAC/BP,IAAAA,UAAU,GAAGQ,kBAAkB;EACnC,GAAC,MAAM;EAAE;MACL,IAAIS,YAAY,GAAG9B,YAAY,CAACQ,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAGT,YAAY,CAACiB,MAAM,CAAC,CAAC,CAAC;MACjF,IAAIa,YAAY,GAAG1B,2BAA2B,EAAE;EAAE;EAC9C,MAAA,KAAK,IAAI2B,CAAC,GAAG/B,YAAY,CAACiB,MAAM,GAAG,CAAC,EAAEc,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;EAC/C,QAAA,IAAI/B,YAAY,CAAC+B,CAAC,CAAC,IAAI3B,2BAA2B,EAAE;EAChD0B,UAAAA,YAAY,GAAG9B,YAAY,CAAC+B,CAAC,CAAC;EAC9B,UAAA;EACJ;EACJ;EACJ;EACAnB,IAAAA,UAAU,GAAGkB,YAAY;MACzB,IAAIlB,UAAU,GAAG,CAAC,EAAE;QAChBC,UAAU,GAAGL,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGQ,UAAU,CAAC;QACjEC,UAAU,GAAGL,IAAI,CAACoB,GAAG,CAACf,UAAU,EAAE,EAAE,CAAC,CAAC;EAC1C;EACJ;EAEA,EAAA,IAAIA,UAAU,GAAG,CAAC,IAAID,UAAU,GAAG,CAAC,EAAE;EAClC;EACA,IAAA,IAAIC,UAAU,GAAGD,UAAU,GAAGR,2BAA2B,EAAE;QACvDS,UAAU,GAAGL,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGQ,UAAU,CAAC;EACrE;MACA,IAAIC,UAAU,GAAG,CAAC,EAAE;EAAE;QAClB,IAAImB,OAAO,OAAArB,MAAA,CAAQH,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAI,IAAA,CAAA;EACrEJ,MAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAIE,UAAU,OAAAF,MAAA,CAAIC,UAAU,EAAAD,GAAAA,CAAAA,CAAAA,MAAA,CAAIT,YAAY,EAAA,mBAAA,CAAA,CAAAS,MAAA,CAAoBqB,OAAO,CAAE,CAAC;QACnF1B,gBAAgB,GAAGO,UAAU,GAAGD,UAAU;EAC9C,KAAC,MAAM;EAAEN,MAAAA,gBAAgB,GAAG,CAAC;EAAE;EACnC,GAAC,MAAM;EAAEA,IAAAA,gBAAgB,GAAG,CAAC;EAAE;IAE/B,OAAO;EAAED,IAAAA,IAAI,EAAJA,IAAI;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;MAAEG,kBAAkB,EAAA,kBAAA,CAAAC,MAAA,CAAqBT,YAAY,EAAA,QAAA;KAAU;EACpH,CAAC;;ECrFD,IAAMgC,YAAY,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EAElC,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAIjC,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAK;IAChG,IAAIC,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;EACxB,EAAA,IAAIC,gBAAgB,GAAGJ,gBAAgB,IAAIK,IAAI,CAACC,MAAM,EAAE,GAAG,CAAC,GAAG,GAAG,CAAC;IAEnE,IAAIL,2BAA2B,GAAG,EAAE,EAAE;MACjC,OAAO;EAAEC,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,uBAAA,CAAAC,MAAA,CAA0BT,YAAY,EAAA,oBAAA;OAAsB;EACzI;EAEA,EAAA,IAAIkC,UAAU,GAAGF,YAAY,CAAC1B,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAGyB,YAAY,CAACjB,MAAM,CAAC,CAAC;IAE9E,IAAIb,2BAA2B,GAAGgC,UAAU,EAAE;EAC1C,IAAA,IAAMC,aAAa,GAAGH,YAAY,CAACI,MAAM,CAAC,UAAAC,CAAC,EAAA;QAAA,OAAIA,CAAC,IAAInC,2BAA2B;OAAC,CAAA;EAChF,IAAA,IAAIiC,aAAa,CAACpB,MAAM,GAAG,CAAC,EAAE;QAC1BmB,UAAU,GAAGC,aAAa,CAACA,aAAa,CAACpB,MAAM,GAAG,CAAC,CAAC;EACxD,KAAC,MAAM;QACH,IAAIb,2BAA2B,IAAI,EAAE,EAAE;UACnCgC,UAAU,GAAG5B,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAG,EAAE,CAAC,GAAG,EAAE;EAC9D,QAAA,IAAIgC,UAAU,KAAK,CAAC,EAAEA,UAAU,GAAG,EAAE;EACzC,OAAC,MAAM,IAAIhC,2BAA2B,IAAI,EAAE,EAAE;EAC1CgC,QAAAA,UAAU,GAAG,EAAE;EACnB,OAAC,MAAM;UACH,OAAO;EAAE/B,UAAAA,IAAI,EAAJA,IAAI;EAAEC,UAAAA,gBAAgB,EAAE,CAAC;EAAEC,UAAAA,gBAAgB,EAAhBA,gBAAgB;YAAEG,kBAAkB,EAAA,uBAAA,CAAAC,MAAA,CAA0BT,YAAY,EAAA,oBAAA;WAAsB;EACxI;EACJ;EACJ;EAEA,EAAA,IAAIsC,UAAU,GAAIJ,UAAU,GAAG,CAAC,GAAI5B,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGgC,UAAU,CAAC,GAAG,CAAC;IAC5FI,UAAU,GAAGhC,IAAI,CAACoB,GAAG,CAACY,UAAU,EAAE,EAAE,CAAC,CAAC;IACtCA,UAAU,GAAGhC,IAAI,CAACiC,GAAG,CAACD,UAAU,EAAE,CAAC,CAAC;EAEpC,EAAA,IAAIA,UAAU,GAAGJ,UAAU,GAAGhC,2BAA2B,EAAE;EACtDoC,IAAAA,UAAU,GAAG,CAAC;EACnB;IAEA,IAAIA,UAAU,GAAG,CAAC,EAAE;MAChB,IAAIE,OAAO,OAAA/B,MAAA,CAAQH,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAI,IAAA,CAAA;EACrEJ,IAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAI6B,UAAU,OAAA7B,MAAA,CAAIyB,UAAU,EAAAzB,GAAAA,CAAAA,CAAAA,MAAA,CAAIT,YAAY,EAAA,cAAA,CAAA,CAAAS,MAAA,CAAe+B,OAAO,CAAE,CAAC;MAC9EpC,gBAAgB,GAAGkC,UAAU,GAAGJ,UAAU;EAC9C,GAAC,MAAM;EACH9B,IAAAA,gBAAgB,GAAG,CAAC;EACxB;IACA,OAAO;EAAED,IAAAA,IAAI,EAAJA,IAAI;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;MAAEG,kBAAkB,EAAA,uBAAA,CAAAC,MAAA,CAA0BT,YAAY,EAAA,QAAA;KAAU;EACzH,CAAC;;EC7CD,IAAMyC,YAAY,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EACxC,IAAMC,qBAAqB,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;EAEtC,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAqBA,CAAI3C,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAK;IAClG,IAAIC,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;IACxB,IAAIC,gBAAgB,GAAGJ,gBAAgB,GAAIK,IAAI,CAACC,MAAM,EAAE,GAAG,CAAE;IAC7D,IAAMqC,OAAO,OAAAnC,MAAA,CAAQH,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAI,IAAA,CAAA;IAEvE,IAAIL,2BAA2B,GAAG,EAAE,EAAE;EAAE;MACnC,OAAO;EAAEC,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,yBAAA,CAAAC,MAAA,CAA4BT,YAAY,EAAA,oBAAA;OAAsB;EAC3I;EAEA,EAAA,IAAI6C,UAAU,GAAGJ,YAAY,CAACnC,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAGkC,YAAY,CAAC1B,MAAM,CAAC,CAAC;IAE9E,IAAIb,2BAA2B,GAAG2C,UAAU,EAAE;EACzC,IAAA,IAAMV,aAAa,GAAGM,YAAY,CAACL,MAAM,CAAC,UAAAC,CAAC,EAAA;QAAA,OAAIA,CAAC,IAAInC,2BAA2B;OAAC,CAAA;EAChF,IAAA,IAAIiC,aAAa,CAACpB,MAAM,GAAG,CAAC,EAAE;QAC1B8B,UAAU,GAAGV,aAAa,CAACA,aAAa,CAACpB,MAAM,GAAE,CAAC,CAAC;EACvD,KAAC,MAAM;EAAE;QACL8B,UAAU,GAAG,CAAC,CAAC;EACnB;EACL;EAEA,EAAA,IAAIC,UAAU,GAAID,UAAU,GAAG,CAAC,GAAIvC,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAG2C,UAAU,CAAC,GAAG,CAAC;IAC5FC,UAAU,GAAGxC,IAAI,CAACoB,GAAG,CAACoB,UAAU,EAAE,EAAE,CAAC;EACrC;;IAEA,IAAIA,UAAU,GAAG,CAAC,EAAE;EAChB3C,IAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAIqC,UAAU,OAAArC,MAAA,CAAIoC,UAAU,EAAApC,GAAAA,CAAAA,CAAAA,MAAA,CAAIT,YAAY,EAAA,iBAAA,CAAA,CAAAS,MAAA,CAAkBmC,OAAO,CAAE,CAAC;MACjFxC,gBAAgB,GAAG0C,UAAU,GAAGD,UAAU;EAC9C;EAEA,EAAA,IAAIE,oBAAoB,GAAG7C,2BAA2B,GAAGE,gBAAgB;IACzE,IAAI2C,oBAAoB,GAAG,GAAG,EAAE;EAC5B,IAAA,IAAIC,aAAa,GAAGN,qBAAqB,CAACpC,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAGmC,qBAAqB,CAAC3B,MAAM,CAAC,CAAC;MACnG,IAAIgC,oBAAoB,GAAGC,aAAa,EAAE;EAAE;EACxC,MAAA,IAAMC,gBAAgB,GAAGP,qBAAqB,CAACN,MAAM,CAAC,UAAAC,CAAC,EAAA;UAAA,OAAIA,CAAC,IAAIU,oBAAoB;SAAC,CAAA;EACrF,MAAA,IAAIE,gBAAgB,CAAClC,MAAM,GAAG,CAAC,EAAE;UAC7BiC,aAAa,GAAGC,gBAAgB,CAACA,gBAAgB,CAAClC,MAAM,GAAG,CAAC,CAAC;EACjE,OAAC,MAAM;UACHiC,aAAa,GAAG,CAAC,CAAC;EACtB;EACJ;MAEA,IAAIE,aAAa,GAAG,CAAC;MACrB,IAAIF,aAAa,GAAG,CAAC,EAAE;QACnBE,aAAa,GAAG5C,IAAI,CAACU,KAAK,CAAC+B,oBAAoB,GAAGC,aAAa,CAAC;EACpE;MACAE,aAAa,GAAG5C,IAAI,CAACoB,GAAG,CAACwB,aAAa,EAAE,EAAE,CAAC;MAE3C,IAAIA,aAAa,GAAG,CAAC,EAAE;EACnB/C,MAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAIyC,aAAa,OAAAzC,MAAA,CAAIuC,aAAa,EAAAvC,GAAAA,CAAAA,CAAAA,MAAA,CAAIT,YAAY,EAAA,cAAA,CAAA,CAAAS,MAAA,CAAemC,OAAO,CAAE,CAAC;QACpFxC,gBAAgB,IAAI8C,aAAa,GAAGF,aAAa;EACrD;EACJ;EAEA,EAAA,IAAI5C,gBAAgB,KAAK,CAAC,IAAIF,2BAA2B,IAAI,EAAE,EAAE;EAC7D,IAAA,IAAIiD,YAAY,GAAGV,YAAY,CAAC,CAAC,CAAC,CAAC;MACnC,IAAIvC,2BAA2B,GAAGiD,YAAY,EAAEA,YAAY,GAAG,CAAC,CAAC;;MAEjE,IAAIA,YAAY,GAAG,CAAC,EAAE;QACjB,IAAIC,YAAY,GAAG9C,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGiD,YAAY,CAAC;QACzEC,YAAY,GAAG9C,IAAI,CAACoB,GAAG,CAAC0B,YAAY,EAAE,CAAC,CAAC,CAAC;QACzC,IAAIA,YAAY,GAAG,CAAC,EAAE;EACnBjD,QAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAI2C,YAAY,OAAA3C,MAAA,CAAI0C,YAAY,EAAA1C,GAAAA,CAAAA,CAAAA,MAAA,CAAIT,YAAY,EAAA,cAAA,CAAA,CAAAS,MAAA,CAAemC,OAAO,CAAE,CAAC;UAClFxC,gBAAgB,GAAGgD,YAAY,GAAGD,YAAY;EACjD;EACL;EACJ;IACA,OAAO;EAAEhD,IAAAA,IAAI,EAAJA,IAAI;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;MAAEG,kBAAkB,EAAA,yBAAA,CAAAC,MAAA,CAA4BT,YAAY,EAAA,QAAA;KAAU;EAC3H,CAAC;;ECvED,IAAMqD,YAAY,GAAG,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC;EACtC,IAAMC,SAAS,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;;EAExC,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,CAAIvD,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAK;IAC5F,IAAIC,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;EACxB,EAAA,IAAIC,gBAAgB,GAAGJ,gBAAgB,IAAI,CAAC,GAAGK,IAAI,CAACC,MAAM,EAAE,GAAG,CAAC,CAAC;EAEjE,EAAA,IAAIL,2BAA2B,GAAGmD,YAAY,CAAC,CAAC,CAAC,EAAE;EAAE;MACjD,OAAO;EAAElD,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,mBAAA,CAAAC,MAAA,CAAsBT,YAAY,EAAA,oBAAA;OAAsB;EACpI;EAEA,EAAA,IAAIwD,SAAS;IACb,IAAItD,2BAA2B,GAAG,GAAG,EAAEsD,SAAS,GAAG,CAAC,CAAC,KAChD,IAAItD,2BAA2B,GAAG,IAAI,EAAEsD,SAAS,GAAG,CAAC,CAAC,KACtDA,SAAS,GAAG,CAAC;IAElB,IAAIC,yBAAyB,GAAGvD,2BAA2B;IAC3D,IAAIwD,eAAe,GAAG,CAAC;IAEvB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,SAAS,EAAEG,CAAC,EAAE,EAAE;EAChC,IAAA,IAAIF,yBAAyB,GAAGJ,YAAY,CAAC,CAAC,CAAC,EAAE;EAEjD,IAAA,IAAIO,yBAAyB,GAAGtD,IAAI,CAACU,KAAK,CAACyC,yBAAyB,IAAID,SAAS,GAAGG,CAAC,CAAC,CAAC;MACvF,IAAIE,aAAa,GAAG,CAAC;MACrB,IAAIC,kBAAkB,GAAG,KAAK;MAE9B,IAAIH,CAAC,GAAGH,SAAS,GAAG,CAAC,IAAKC,yBAAyB,GAAGG,yBAAyB,GAAI,GAAG,EAAE;EAAE;EACtF,MAAA,IAAItD,IAAI,CAACC,MAAM,EAAE,GAAG,GAAG,EAAE;EACrB,QAAA,IAAIqD,yBAAyB,GAAG,GAAG,IAAIH,yBAAyB,IAAIG,yBAAyB,GAAG,EAAE,CAAC,IAAI,EAAE,EAAG;EAAE;EAC1GC,UAAAA,aAAa,GAAG,EAAE;EAClBD,UAAAA,yBAAyB,IAAIC,aAAa;EAC1CC,UAAAA,kBAAkB,GAAG,IAAI;EAC7B;EACJ;EACJ;MAEA,IAAIF,yBAAyB,GAAGP,YAAY,CAAC,CAAC,CAAC,IAAIS,kBAAkB,EAAE;QACnEF,yBAAyB,IAAIC,aAAa,CAAC;EAC3CA,MAAAA,aAAa,GAAG,CAAC;EACjBC,MAAAA,kBAAkB,GAAG,KAAK;EAC9B;EAEA,IAAA,IAAIF,yBAAyB,GAAGP,YAAY,CAAC,CAAC,CAAC,EAAE;EAEjD,IAAA,IAAIU,OAAO,GAAGV,YAAY,CAAC/C,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAG8C,YAAY,CAACtC,MAAM,CAAC,CAAC;MAC3E,IAAIgD,OAAO,GAAGH,yBAAyB,IAAIA,yBAAyB,IAAIP,YAAY,CAAC,CAAC,CAAC,EAAE;EACrF,MAAA,KAAK,IAAIxB,CAAC,GAAGwB,YAAY,CAACtC,MAAM,GAAG,CAAC,EAAEc,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;EAC/C,QAAA,IAAIwB,YAAY,CAACxB,CAAC,CAAC,IAAI+B,yBAAyB,EAAE;EAC9CG,UAAAA,OAAO,GAAGV,YAAY,CAACxB,CAAC,CAAC;EACzB,UAAA;EACJ;EACJ;EACA,MAAA,IAAIkC,OAAO,GAAGH,yBAAyB,IAAIP,YAAY,CAACtC,MAAM,GAAG,CAAC,IAAIsC,YAAY,CAAC,CAAC,CAAC,IAAIO,yBAAyB,EAAE;EAC/GG,QAAAA,OAAO,GAAGV,YAAY,CAAC,CAAC,CAAC;EAC9B,OAAC,MAAM,IAAIU,OAAO,GAAGH,yBAAyB,EAAE;EAAE;EAC9C,QAAA;EACJ;EACJ,KAAC,MAAM,IAAIG,OAAO,GAAGH,yBAAyB,EAAE;EAAE;EAC7C,MAAA;EACL;EACA,IAAA,IAAIG,OAAO,KAAK,CAAC,IAAIV,YAAY,CAACtC,MAAM,GAAG,CAAC,EAAEgD,OAAO,GAAGV,YAAY,CAAC,CAAC,CAAC;EACvE,IAAA,IAAIU,OAAO,KAAK,CAAC,EAAE,SAAS;;EAE5B,IAAA,IAAIC,OAAO,GAAID,OAAO,GAAG,CAAC,GAAIzD,IAAI,CAACU,KAAK,CAAC4C,yBAAyB,GAAGG,OAAO,CAAC,GAAG,CAAC;MACjFC,OAAO,GAAG1D,IAAI,CAACoB,GAAG,CAACsC,OAAO,EAAE,EAAE,CAAC,CAAC;;MAEhC,IAAIA,OAAO,GAAG,CAAC,EAAE;EACb,MAAA,IAAMC,yBAAyB,GAAGD,OAAO,GAAGD,OAAO;QACnD,IAAIG,IAAI,OAAAzD,MAAA,CAAQH,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,EAAI,IAAA,CAAA;EAClE,MAAA,IAAI4D,SAAS,GAAGb,SAAS,CAAChD,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAG+C,SAAS,CAACvC,MAAM,CAAC,CAAC;QACvEZ,IAAI,CAAC4B,IAAI,CAAAtB,EAAAA,CAAAA,MAAA,CAAIuD,OAAO,EAAA,GAAA,CAAA,CAAAvD,MAAA,CAAIsD,OAAO,EAAA,GAAA,CAAA,CAAAtD,MAAA,CAAI0D,SAAS,EAAA1D,IAAAA,CAAAA,CAAAA,MAAA,CAAKT,YAAY,cAAAS,MAAA,CAAWyD,IAAI,CAAE,CAAC;EAE/ER,MAAAA,eAAe,IAAIO,yBAAyB;EAC5CR,MAAAA,yBAAyB,IAAIQ,yBAAyB;EAEtD,MAAA,IAAIH,kBAAkB,IAAID,aAAa,GAAG,CAAC,EAAE;UACzC,IAAIJ,yBAAyB,IAAII,aAAa,EAAE;EAC5C1D,UAAAA,IAAI,CAAC4B,IAAI,CAAC,sBAAsB,CAAC;EACjC2B,UAAAA,eAAe,IAAIG,aAAa;EAChCJ,UAAAA,yBAAyB,IAAII,aAAa;EAC9C;EACJ,OAAC,MAAM,IAAIF,CAAC,GAAGH,SAAS,GAAG,CAAC,IAAIC,yBAAyB,GAAGJ,YAAY,CAAC,CAAC,CAAC,EAAE;EACzE,QAAA,IAAI/C,IAAI,CAACC,MAAM,EAAE,GAAG,GAAG,EAAEJ,IAAI,CAAC4B,IAAI,CAAC,WAAW,CAAC;EACnD;EACJ,KAAC,MAAM,IAAI8B,aAAa,GAAG,CAAC,EAAE;QACzB,IAAIJ,yBAAyB,IAAII,aAAa,EAAE;EAC7C1D,QAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAIoD,aAAa,aAAU,CAAC;EACrCH,QAAAA,eAAe,IAAIG,aAAa;EAChCJ,QAAAA,yBAAyB,IAAII,aAAa;EAC7C;EACL;EACJ;EACAzD,EAAAA,gBAAgB,GAAGsD,eAAe;IAElC,IAAItD,gBAAgB,GAAGF,2BAA2B,GAAG,IAAI,IAAIA,2BAA2B,GAAG,GAAG,EAAE;MAC5FC,IAAI,CAACY,MAAM,GAAG,CAAC;MACfX,gBAAgB,GAAG,CAAC,CAAC;MACrB,IAAIgE,eAAe,GAAIlE,2BAA2B,GAAG,GAAG,IAAImD,YAAY,CAACgB,QAAQ,CAAC,GAAG,CAAC,GAAI,GAAG,GAAIhB,YAAY,CAAC,CAAC,CAAQ;EACvH,IAAA,IAAInD,2BAA2B,GAAGkE,eAAe,IAAIf,YAAY,CAACtC,MAAM,GAAG,CAAC,EAAEqD,eAAe,GAAIf,YAAY,CAAC,CAAC,CAAQ;MAEvH,IAAIe,eAAe,GAAG,CAAC,EAAE;QACrB,IAAIE,eAAe,GAAGhE,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGkE,eAAe,CAAC;QAC/EE,eAAe,GAAGhE,IAAI,CAACoB,GAAG,CAAC4C,eAAe,EAAE,EAAE,CAAC;QAC/C,IAAIA,eAAe,GAAG,CAAC,EAAE;EACrBnE,QAAAA,IAAI,CAAC4B,IAAI,CAAAtB,EAAAA,CAAAA,MAAA,CAAI6D,eAAe,EAAA,GAAA,CAAA,CAAA7D,MAAA,CAAI2D,eAAe,EAAA3D,SAAAA,CAAAA,CAAAA,MAAA,CAAUT,YAAY,kBAAc,CAAC;UACpFI,gBAAgB,GAAGkE,eAAe,GAAGF,eAAe;EACxD;EACJ;EACJ;IACA,IAAIhE,gBAAgB,KAAK,CAAC,IAAIF,2BAA2B,IAAImD,YAAY,CAAC,CAAC,CAAC,EAAE;EAC1E,IAAA,IAAIkB,KAAK,GAAIrE,2BAA2B,IAAI,EAAE,IAAImD,YAAY,CAACgB,QAAQ,CAAC,EAAE,CAAC,GAAI,EAAE,GAAGhB,YAAY,CAAC,CAAC,CAAC;MACnG,IAAInD,2BAA2B,GAAGqE,KAAK,EAAE;QACpC,OAAO;EAAEpE,QAAAA,IAAI,EAAJA,IAAI;EAAEC,QAAAA,gBAAgB,EAAE,CAAC;EAAEC,QAAAA,gBAAgB,EAAhBA,gBAAgB;UAAEG,kBAAkB,EAAA,mBAAA,CAAAC,MAAA,CAAsBT,YAAY,EAAA,iCAAA;SAAmC;EAClJ;MACA,IAAIwE,KAAK,GAAGlE,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAACqE,KAAK,CAAC;EACzDC,IAAAA,KAAK,GAAGlE,IAAI,CAACoB,GAAG,CAAC8C,KAAK,EAAGD,KAAK,KAAK,EAAE,GAAG,CAAC,GAAC,EAAI,CAAC;MAC/C,IAAIC,KAAK,GAAG,CAAC,EAAE;EACVrE,MAAAA,IAAI,CAAC4B,IAAI,CAAAtB,EAAAA,CAAAA,MAAA,CAAI+D,KAAK,EAAA,GAAA,CAAA,CAAA/D,MAAA,CAAI8D,KAAK,EAAA9D,SAAAA,CAAAA,CAAAA,MAAA,CAAUT,YAAY,kBAAc,CAAC;QAChEI,gBAAgB,GAAGoE,KAAK,GAAGD,KAAK;EACrC;EACJ;IACA,OAAO;EAAEpE,IAAAA,IAAI,EAAJA,IAAI;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;MAAEG,kBAAkB,EAAA,mBAAA,CAAAC,MAAA,CAAsBT,YAAY,EAAA,QAAA;KAAU;EACrH,CAAC;;EC3HD,IAAMyE,YAAY,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EAEtB,IAAMC,UAAU,GAAG,SAAbA,UAAUA,CAAI1E,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAK;IACvF,IAAIC,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;EACxB,EAAA,IAAIC,gBAAgB,GAAGJ,gBAAgB,IAAI,EAAE,GAAGK,IAAI,CAACC,MAAM,EAAE,GAAG,EAAE,CAAC;IACnE,IAAIyD,OAAO,GAAG,CAAC;IACf,IAAID,OAAO,GAAG,CAAC;EAEf,EAAA,IAAMY,KAAK,GAAGF,YAAY,CAACJ,QAAQ,CAAC,EAAE,CAAC;EACvC,EAAA,IAAMO,KAAK,GAAGH,YAAY,CAACJ,QAAQ,CAAC,EAAE,CAAC;EAEvC,EAAA,IAAInE,2BAA2B,IAAI0E,KAAK,GAAG,EAAE,GAAID,KAAK,GAAG,EAAE,GAAGtD,QAAS,CAAC,EAAE;MACrE,OAAO;EAAElB,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,cAAA,CAAAC,MAAA,CAAiBT,YAAY,EAAA,oBAAA;OAAsB;EAChI;EAEA,EAAA,IAAI6E,cAAc;EAClB,EAAA,IAAIF,KAAK,IAAIzE,2BAA2B,IAAI,GAAG,EAAE;EAC7C2E,IAAAA,cAAc,GAAG,EAAE;KACtB,MAAM,IAAID,KAAK,EAAE;EACdC,IAAAA,cAAc,GAAG,EAAE;KACtB,MAAM,IAAIF,KAAK,EAAE;EACdE,IAAAA,cAAc,GAAG,EAAE;EACvB,GAAC,MAAM;MACF,OAAO;EAAE1E,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,cAAA,CAAAC,MAAA,CAAiBT,YAAY,EAAA,6BAAA;OAA+B;EACzI;IAEA,IAAM8E,sBAAsB,GAAID,cAAc,KAAK,EAAE,GAAI,EAAE,GAAG,EAAE,CAAC;IACjE,IAAIE,qBAAqB,GAAG,CAAC;IAC7B,IAAIF,cAAc,GAAG,CAAC,EAAE;EACpBE,IAAAA,qBAAqB,GAAGzE,IAAI,CAACoB,GAAG,CAACpB,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAG2E,cAAc,CAAC,EAAEC,sBAAsB,CAAC;EACtH;EAEA,EAAA,IAAIE,eAAe,GAAGD,qBAAqB,GAAGF,cAAc;EAE5Dd,EAAAA,OAAO,GAAGc,cAAc;EACxBb,EAAAA,OAAO,GAAGe,qBAAqB;EAE/B,EAAA,IAAIF,cAAc,KAAK,EAAE,IAAIF,KAAK,EAAE;EAChC,IAAA,IAAMM,eAAe,GAAG3E,IAAI,CAACoB,GAAG,CAACpB,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;EACnF,IAAA,IAAMgF,eAAe,GAAGD,eAAe,GAAG,EAAE;EAC5C,IAAA,IAAME,8BAA8B,GAAGH,eAAe,GAAG9E,2BAA2B,GAAG,IAAI;EAE3F,IAAA,IAAIiF,8BAA8B,IAAID,eAAe,GAAGF,eAAe,EAAE;EACrEjB,MAAAA,OAAO,GAAG,EAAE;EACZC,MAAAA,OAAO,GAAGiB,eAAe;EAC7B;EACJ;IAEA,IAAIjB,OAAO,KAAK,CAAC,IAAID,OAAO,GAAG,CAAC,IAAI7D,2BAA2B,IAAI6D,OAAO,EAAE;EACxEC,IAAAA,OAAO,GAAG,CAAC;EACf;EAEA,EAAA,IAAIA,OAAO,GAAG,CAAC,IAAID,OAAO,GAAG,CAAC,EAAE;MAC5B3D,gBAAgB,GAAG4D,OAAO,GAAGD,OAAO;MACpC,IAAMqB,OAAO,GAAG,KAAK;EACrBjF,IAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAIuD,OAAO,OAAAvD,MAAA,CAAIsD,OAAO,EAAAtD,cAAAA,CAAAA,CAAAA,MAAA,CAAeT,YAAY,EAAA,4BAAA,CAAA,CAAAS,MAAA,CAA6B2E,OAAO,CAAE,CAAC;EACrG,GAAC,MAAM;EACHhF,IAAAA,gBAAgB,GAAG,CAAC;EACpBD,IAAAA,IAAI,GAAG,EAAE;EACb;IAEA,OAAO;EAAEA,IAAAA,IAAI,EAAJA,IAAI;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;MAAEG,kBAAkB,EAAA,cAAA,CAAAC,MAAA,CAAiBT,YAAY,EAAA,QAAA;KAAU;EAChH,CAAC;;EC/DM,IAAMqF,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAIrF,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAK;IAC9F,IAAIC,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;IACxB,IAAIC,gBAAgB,GAAGJ,gBAAgB;EACvC,EAAA,IAAMqF,gBAAgB,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;IACjD,IAAIC,WAAW,GAAG,CAAC;IACnB,IAAIC,WAAW,GAAG,CAAC;IACnB,IAAIC,iBAAiB,GAAGpE,QAAQ;IAEhC,IAAInB,2BAA2B,GAAG,EAAE,EAAE;EAAE;MACpC,OAAO;EAAEC,MAAAA,IAAI,EAAJA,IAAI;EAAEC,MAAAA,gBAAgB,EAAE,CAAC;EAAEC,MAAAA,gBAAgB,EAAhBA,gBAAgB;QAAEG,kBAAkB,EAAA,qBAAA,CAAAC,MAAA,CAAwBT,YAAY,EAAA,oBAAA;OAAsB;EACtI;EAEA,EAAA,KAAA,IAAAa,EAAA,GAAA,CAAA,EAAA6E,iBAAA,GAAmBJ,gBAAgB,EAAAzE,EAAA,GAAA6E,iBAAA,CAAA3E,MAAA,EAAAF,EAAA,EAAE,EAAA;EAAhC,IAAA,IAAMnB,IAAI,GAAAgG,iBAAA,CAAA7E,EAAA,CAAA;MACX,IAAIX,2BAA2B,IAAIR,IAAI,EAAE;QACrC,IAAI8B,cAAc,GAAGlB,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGR,IAAI,CAAC;EACnE,MAAA,IAAIiC,gBAAgB,GAAGzB,2BAA2B,GAAIsB,cAAc,GAAG9B,IAAK;QAC5E,IAAI8B,cAAc,GAAG,CAAC,EAAE;EAAE;UACtB,IAAIG,gBAAgB,GAAG8D,iBAAiB,EAAE;EACtCA,UAAAA,iBAAiB,GAAG9D,gBAAgB;EACpC4D,UAAAA,WAAW,GAAG7F,IAAI;EAClB8F,UAAAA,WAAW,GAAGhE,cAAc;EAChC,SAAC,MAAM,IAAIG,gBAAgB,KAAK8D,iBAAiB,EAAE;YAC/C,IAAI/F,IAAI,GAAG6F,WAAW,EAAE;EAAE;EACtBA,YAAAA,WAAW,GAAG7F,IAAI;EAClB8F,YAAAA,WAAW,GAAGhE,cAAc;EAChC;EACJ;EACJ;EACJ;EACJ;EAEA,EAAA,IAAIgE,WAAW,KAAK,CAAC,IAAItF,2BAA2B,IAAI,EAAE,EAAE;EACxD;EACA;MACA,IAAIA,2BAA2B,IAAI,EAAE,EAAE;QAClCqF,WAAW,GAAGjF,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAG,EAAE,CAAC,GAAG,EAAE;QAC/D,IAAGqF,WAAW,KAAK,CAAC,EAAEA,WAAW,GAAG,EAAE,CAAC;EAC5C,KAAC,MAAM;EAAE;EACJA,MAAAA,WAAW,GAAG,EAAE;EACrB;EACA,IAAA,IAAIA,WAAW,GAAG,CAAC,EAAEC,WAAW,GAAGlF,IAAI,CAACU,KAAK,CAACd,2BAA2B,GAAGqF,WAAW,CAAC;MACxF,IAAIC,WAAW,GAAGD,WAAW,GAAGrF,2BAA2B,EAAEsF,WAAW,GAAG,CAAC,CAAC;EACjF;;EAEA;EACA,EAAA,IAAIA,WAAW,GAAG,CAAC,IAAID,WAAW,GAAG,CAAC,EAAE;EACpC,IAAA,IAAII,cAAc,GAAGH,WAAW,GAAGD,WAAW;EAE9C,IAAA,IAAII,cAAc,GAAGzF,2BAA2B,GAAG,IAAI,IAAIqF,WAAW,IAAI,GAAG,IAAIC,WAAW,GAAG,CAAC,EAAE;QAC9FI,OAAO,CAACC,GAAG,CAAA,mEAAA,CAAApF,MAAA,CAAqE+E,WAAW,EAAA,GAAA,CAAA,CAAA/E,MAAA,CAAI8E,WAAW,EAAA,uBAAA,CAAuB,CAAC;EAClIC,MAAAA,WAAW,EAAE;EACjB;EACJ;EACA;;EAEA,EAAA,IAAIA,WAAW,GAAG,CAAC,IAAID,WAAW,GAAG,CAAC,EAAE;EAAE;MACtC,IAAIO,QAAQ,GAAG,EAAE;EACjB,IAAA,IAAIP,WAAW,IAAI,GAAG,EAAEO,QAAQ,GAAG,EAAE,CAAC,KACjC,IAAIP,WAAW,IAAI,GAAG,EAAEO,QAAQ,GAAG,EAAE,CAAC,KACtC,IAAIP,WAAW,IAAI,GAAG,EAAEO,QAAQ,GAAG,EAAE,CAAC,KACtCA,QAAQ,GAAG,EAAE;EAClB3F,IAAAA,IAAI,CAAC4B,IAAI,CAAA,EAAA,CAAAtB,MAAA,CAAI+E,WAAW,OAAA/E,MAAA,CAAI8E,WAAW,EAAA9E,SAAAA,CAAAA,CAAAA,MAAA,CAAUT,YAAY,EAAA,WAAA,CAAA,CAAAS,MAAA,CAAYqF,QAAQ,OAAG,CAAC;MACrF1F,gBAAgB,GAAGoF,WAAW,GAAGD,WAAW;EAChD,GAAC,MAAM;EACFnF,IAAAA,gBAAgB,GAAG,CAAC;EACzB;IACA,OAAO;EAAED,IAAAA,IAAI,EAAJA,IAAI;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;EAAEC,IAAAA,gBAAgB,EAAhBA,gBAAgB;MAAEG,kBAAkB,EAAA,qBAAA,CAAAC,MAAA,CAAwBT,YAAY,EAAA,gBAAA;KAAkB;EAC/H,CAAC;;EC7DD,IAAM+F,kBAAkB,GAAG;EACvB,EAAA,gBAAgB,EAAEhG,cAAc;EAChC,EAAA,qBAAqB,EAAEkC,mBAAmB;EAC1C,EAAA,uBAAuB,EAAEU,qBAAqB;EAC9C,EAAA,iBAAiB,EAAEY,eAAe;EAClC,EAAA,YAAY,EAAEmB,UAAU;EACxB,EAAA,mBAAmB,EAAEW;EACzB,CAAC;;ECdD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,SAASW,YAAYA,CAACC,gBAAgB,EAAErG,cAAc,EAAE;IACpD,IAAMsG,SAAS,GAAG5F,IAAI,CAACC,MAAM,EAAE,GAAG,GAAG,CAAC;;IAEtC,IAAI2F,SAAS,IAAID,gBAAgB,IAAIA,gBAAgB,CAAClF,MAAM,GAAG,CAAC,EAAE;EAC9D,IAAA,OAAOkF,gBAAgB,CAAC3F,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAG0F,gBAAgB,CAAClF,MAAM,CAAC,CAAC;EAChF,GAAC,MAAM;EACH,IAAA,OAAOnB,cAAc;EACzB;EACJ;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA,SAASuG,cAAcA,CAACC,kBAAkB,EAAE;EACxC,EAAA,IAAIA,kBAAkB,IAAIA,kBAAkB,CAACrF,MAAM,GAAG,CAAC,EAAE;EACrD,IAAA,OAAOqF,kBAAkB,CAAC9F,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAG6F,kBAAkB,CAACrF,MAAM,CAAC,CAAC;EACpF;IACA,OAAO,IAAI,CAAC;EAChB;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,SAASsF,eAAeA,CAACC,WAAW,EAAEtG,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAE6F,kBAAkB,EAAE;EACnH,EAAA,IAAIQ,SAAS,GAAGR,kBAAkB,CAACO,WAAW,CAAC;EAC/C,EAAA,IAAIE,qBAAqB;IAEzB,IAAI,CAACD,SAAS,EAAE;EACZC,IAAAA,qBAAqB,GAAA/F,wBAAAA,CAAAA,MAAA,CAA4B6F,WAAW,EAAoC,oCAAA,CAAA;EAChGC,IAAAA,SAAS,GAAGR,kBAAkB,CAAC,mBAAmB,CAAC;EACvD;;EAEA;IACA,IAAIU,aAAa,GAAGF,SAAS,CAACvG,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,CAAC;;EAE1F;EACA,EAAA,IAAIuG,aAAa,CAACrG,gBAAgB,GAAG,GAAG,IAAIF,2BAA2B,GAAG,GAAG,IAAIoG,WAAW,KAAK,mBAAmB,EAAE;MAClH,IAAII,eAAe,GAAG,0FAA0F;EAEhH,IAAA,IAAMC,eAAe,GAAGF,aAAa,CAACjG,kBAAkB,CAAC;EACzDiG,IAAAA,aAAa,GAAGV,kBAAkB,CAAC,mBAAmB,CAAC,CAAC/F,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,CAAC,CAAC;;EAErH;MACA,IAAI0G,oBAAoB,GAAGF,eAAe;EAC1C,IAAA,IAAIC,eAAe,EAAE;EAAE;EACnBC,MAAAA,oBAAoB,GAAGD,eAAe,GAAG,GAAG,GAAGD,eAAe;EAClE,KAAC,MAAM,IAAID,aAAa,CAACjG,kBAAkB,EAAE;EAAE;EAC3CoG,MAAAA,oBAAoB,GAAGF,eAAe,GAAG,GAAG,GAAGD,aAAa,CAACjG,kBAAkB;EACnF;MACAiG,aAAa,CAACjG,kBAAkB,GAAGoG,oBAAoB;EAC3D,GAAC,MAAM;EACH;EACA;EACA;EACA,IAAA,IAAIJ,qBAAqB,EAAE;EACvB,MAAA,IAAI,CAACC,aAAa,CAACjG,kBAAkB,EAAE;UACnCiG,aAAa,CAACjG,kBAAkB,GAAGgG,qBAAqB;EAC5D,OAAC,MAAM;EACH;EACA;UACAC,aAAa,CAACjG,kBAAkB,GAAGgG,qBAAqB,GAAG,+BAA+B,GAAGC,aAAa,CAACjG,kBAAkB;EACjI;OACH,MAAM,IAAI8F,WAAW,KAAK,mBAAmB,IAAI,CAACG,aAAa,CAACjG,kBAAkB,EAAE;EACjF;EACAiG,MAAAA,aAAa,CAACjG,kBAAkB,GAAA,qBAAA,CAAAC,MAAA,CAAyBT,YAAY,EAAQ,QAAA,CAAA;EACjF;EACJ;EACA,EAAA,OAAOyG,aAAa;EACxB;EAEA,IAAMI,gBAAgB,GAAG;EACrBb,EAAAA,YAAY,EAAZA,YAAY;EACZG,EAAAA,cAAc,EAAdA,cAAc;EACdE,EAAAA,eAAe,EAAfA;EACJ,CAAC;;EC7FD;EACO,SAASS,qBAAqBA,CAACC,UAAU,EAAE;EAC9C,EAAA,IAAI,OAAOA,UAAU,KAAK,QAAQ,EAAE;EAChC,IAAA,OAAO,IAAI;EACf;EACA,EAAA,IAAMC,KAAK,GAAGD,UAAU,CAACE,KAAK,CAAC,GAAG,CAAC;EACnC,EAAA,IAAID,KAAK,CAACjG,MAAM,KAAK,CAAC,EAAE;MACpB,IAAMmG,OAAO,GAAGC,QAAQ,CAACH,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;MACtC,IAAMI,OAAO,GAAGC,UAAU,CAACL,KAAK,CAAC,CAAC,CAAC,CAAC;MACpC,IAAIM,KAAK,CAACJ,OAAO,CAAC,IAAII,KAAK,CAACF,OAAO,CAAC,EAAE;EAClC,MAAA,OAAO,IAAI;EACf;EACA,IAAA,OAAOF,OAAO,GAAG,EAAE,GAAGE,OAAO;EACjC;IACA,OAAO,IAAI,CAAC;EAChB;;EAEA;EACO,SAASG,mBAAmBA,CAACC,YAAY,EAAE;IAC9C,IAAMN,OAAO,GAAG5G,IAAI,CAACU,KAAK,CAACwG,YAAY,GAAG,EAAE,CAAC;EAC7C,EAAA,IAAMJ,OAAO,GAAG,CAACI,YAAY,GAAG,EAAE,EAAEC,OAAO,CAAC,CAAC,CAAC,CAAC;EAC/C,EAAA,OAAA,EAAA,CAAAhH,MAAA,CAAUyG,OAAO,EAAAzG,GAAAA,CAAAA,CAAAA,MAAA,CAAI2G,OAAO,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,CAAA3G,CAAAA,MAAA,CAAG2G,OAAO,CAAA;EAC1D;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,SAASM,iBAAeA,CAACC,kBAAkB,EAAE3H,YAAY,EAAE4H,WAAW,EAAEtB,WAAW,EAAE;EACjF,EAAA,IAAMuB,4BAA4B,GAAG,GAAG,CAAC;EACzC;EACA;;EAEA,EAAA,IAAM5H,gBAAgB,GAAG6G,qBAAqB,CAACc,WAAW,CAAC;IAC3D,IAAI3H,gBAAgB,KAAK,IAAI,EAAE;EAC3B,IAAA,OAAO,kEAAkE;EAC7E;IAEA,IAAI6H,cAAc,GAAG,EAAE;IACvB,IAAIC,sBAAsB,GAAG,CAAC;EAC9B,EAAA,IAAMC,YAAY,GAAG,OAAO,CAAC;;EAE7B;EACA,EAAA,IAAIC,cAAc;IAClB,IAAIN,kBAAkB,GAAGE,4BAA4B,EAAE;EACnDI,IAAAA,cAAc,GAAAC,cAAA,CAAAA,cAAA,KAAQtI,cAAc,CAAA,EAAA,EAAA,EAAA;EAAEH,MAAAA,IAAI,EAAE;OAA6B,CAAA;EAC7E,GAAC,MAAM;EACH;MACAwI,cAAc,GAAGE,gBAAiB,CAACnC,YAAY,CAACxG,OAAO,EAAEI,cAAc,CAAC,CAAC;EACzE,IAAA,IAAIqI,cAAc,IAAIA,cAAc,CAACvI,IAAI,GAAG,CAAC,EAAE;QAC3C,IAAM0I,mBAAmB,GAAG,GAAG;EAC/B,MAAA,IAAIC,oBAAoB,GAAGV,kBAAkB,GAAGS,mBAAmB;;EAEnE;QACAC,oBAAoB,GAAG/H,IAAI,CAACoB,GAAG,CAAC2G,oBAAoB,EAAEV,kBAAkB,GAAG,GAAG,CAAC;EAE/E,MAAA,IAAIU,oBAAoB,GAAG,CAAC,IAAIV,kBAAkB,GAAG,CAAC,EAAE;EACnDU,QAAAA,oBAAoB,GAAGV,kBAAkB,GAAG,GAAG,CAAC;EACC;EACA;EACjD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACL,OAAC;;EAED,MAAA,IAAIU,oBAAoB,GAAG,EAAE,IAAIV,kBAAkB,IAAI,EAAE,EAAE;EACtDU,QAAAA,oBAAoB,GAAG,EAAE;EAC9B;EACA;EACA,MAAA,IAAIA,oBAAoB,GAAG,CAAC,EAAEA,oBAAoB,GAAG,CAAC;EAGtD,MAAA,IAAIJ,cAAc,CAACvI,IAAI,GAAG2I,oBAAoB,EAAE;EAC5C,QAAA,IAAMC,eAAe,GAAG9I,OAAO,CAAC4C,MAAM,CAAC,UAAAmG,EAAE,EAAA;YAAA,OAAIA,EAAE,CAAC7I,IAAI,IAAI2I,oBAAoB,IAAIE,EAAE,CAAC7I,IAAI,GAAG,CAAC;WAAC,CAAA;EAC5F,QAAA,IAAI4I,eAAe,CAACvH,MAAM,GAAG,CAAC,EAAE;EAC5BkH,UAAAA,cAAc,GAAGK,eAAe,CAAChI,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAG+H,eAAe,CAACvH,MAAM,CAAC,CAAC;EACxF,SAAC,MAAM;EACHkH,UAAAA,cAAc,GAAGrI,cAAc;EACnC;EACJ;OACH,MAAM,IAAI,CAACqI,cAAc,IAAIA,cAAc,CAACvI,IAAI,KAAK,CAAC,EAAE;EACrDuI,MAAAA,cAAc,GAAGrI,cAAc;EACnC;EACJ;EAEA,EAAA,IAAIqI,cAAc,EAAE;MAChBH,cAAc,CAAC/F,IAAI,CAAAtB,MAAAA,CAAAA,MAAA,CAAQwH,cAAc,CAACxI,IAAI,CAAE,CAAC;MACjDsI,sBAAsB,IAAIE,cAAc,CAACvI,IAAI;EACjD;;EAEA;IACA,IAAI8I,kBAAkB,GAAG,WAAW;IACpC,IAAIrI,IAAI,GAAG,EAAE;IACb,IAAIC,gBAAgB,GAAG,CAAC;EACxB,EAAA,IAAIC,gBAAgB;EACpB,EAAA,IAAIH,2BAA2B,GAAGyH,kBAAkB,GAAGI,sBAAsB;EAE7E,EAAA,IAAMU,aAAa,GAAGN,gBAAiB,CAAC9B,eAAe,CAACC,WAAW,EAAEtG,YAAY,EAAEC,gBAAgB,EAAEC,2BAA2B,EAAE6F,kBAAkB,CAAC;IACrJ5F,IAAI,GAAGsI,aAAa,CAACtI,IAAI;IACzBC,gBAAgB,GAAGqI,aAAa,CAACrI,gBAAgB;IACjDC,gBAAgB,GAAGoI,aAAa,CAACpI,gBAAgB;IAEjD,IAAIoI,aAAa,CAACjI,kBAAkB,EAAE;EAClCgI,IAAAA,kBAAkB,QAAA/H,MAAA,CAAQgI,aAAa,CAACjI,kBAAkB,CAAE;EAChE;EAEAsH,EAAAA,cAAc,CAAC/F,IAAI,CAACyG,kBAAkB,CAAC;EACvCrI,EAAAA,IAAI,CAACuI,OAAO,CAAC,UAAAC,GAAG,EAAI;EAChBb,IAAAA,cAAc,CAAC/F,IAAI,CAAA,MAAA,CAAAtB,MAAA,CAAQkI,GAAG,CAAE,CAAC;EACrC,GAAC,CAAC;EACFZ,EAAAA,sBAAsB,IAAI3H,gBAAgB;;EAE1C;EACA,EAAA,IAAIwI,gBAAgB;EACpB,EAAA,IAAMC,wBAAwB,GAAG;EAAEpJ,IAAAA,IAAI,EAAE,6BAA6B;EAAEC,IAAAA,IAAI,EAAE,CAAC;EAAEC,IAAAA,IAAI,EAAE;KAAQ;IAE/F,IAAIgI,kBAAkB,GAAGE,4BAA4B,EAAE;EACnDe,IAAAA,gBAAgB,GAAGC,wBAAwB;EAC/C,GAAC,MAAM;EACH;EACA,IAAA,IAAMC,uBAAuB,GAAG;EAAErJ,MAAAA,IAAI,EAAE,aAAa;EAAEC,MAAAA,IAAI,EAAE,CAAC;EAAEC,MAAAA,IAAI,EAAE;EAAO,KAAC,CAAC;MAC/E,IAAMoJ,oBAAoB,GAAGhB,sBAAsB;EACnD,IAAA,IAAMiB,gBAAgB,GAAGrB,kBAAkB,GAAGoB,oBAAoB;EAElE,IAAA,IAAIA,oBAAoB,IAAIpB,kBAAkB,GAAG,EAAE,EAAE;EACjDiB,MAAAA,gBAAgB,GAAGE,uBAAuB;EAC9C,KAAC,MAAM;EACH;EACA,MAAA,IAAMG,iBAAiB,GAAGpJ,SAAS,CAACuC,MAAM,CAAC,UAAA8G,EAAE,EAAA;EAAA,QAAA,OAAIA,EAAE,CAACxJ,IAAI,IAAIsJ,gBAAgB,GAAG,EAAE;SAAC,CAAA;EAElF,MAAA,IAAIC,iBAAiB,CAAClI,MAAM,GAAG,CAAC,EAAE;EAC9B6H,QAAAA,gBAAgB,GAAGK,iBAAiB,CAAC3I,IAAI,CAACU,KAAK,CAACV,IAAI,CAACC,MAAM,EAAE,GAAG0I,iBAAiB,CAAClI,MAAM,CAAC,CAAC;EAC9F,OAAC,MAAM;EACH6H,QAAAA,gBAAgB,GAAGE,uBAAuB;EAC9C;EACJ;EACJ;EAEA,EAAA,IAAIF,gBAAgB,EAAE;MAClBd,cAAc,CAAC/F,IAAI,CAAAtB,MAAAA,CAAAA,MAAA,CAAQmI,gBAAgB,CAACnJ,IAAI,CAAE,CAAC;MACnDsI,sBAAsB,IAAIa,gBAAgB,CAAClJ,IAAI;EACnD;;EAEA;IACAoI,cAAc,CAAC/F,IAAI,CAAA,8BAAA,CAAAtB,MAAA,CAAgCsH,sBAAsB,EAAA,GAAA,CAAA,CAAAtH,MAAA,CAAIuH,YAAY,CAAE,CAAC;EAC5FF,EAAAA,cAAc,CAAC/F,IAAI,CAAA,OAAA,CAAAtB,MAAA,CAASmH,WAAW,CAAE,CAAC;IAC1CE,cAAc,CAAC/F,IAAI,CAAAtB,gBAAAA,CAAAA,MAAA,CAAkB6F,WAAW,CAAE,CAAC,CAAC;IACpDwB,cAAc,CAAC/F,IAAI,CAAA,uBAAA,CAAAtB,MAAA,CAAyBT,YAAY,CAACmJ,WAAW,EAAE,CAAE,CAAC;EACzE;EACArB,EAAAA,cAAc,CAAC/F,IAAI,CAAAtB,mCAAAA,CAAAA,MAAA,CAAqC8G,mBAAmB,CAAClH,gBAAgB,CAAC,EAAAI,SAAAA,CAAAA,CAAAA,MAAA,CAAUuH,YAAY,CAAE,CAAC;EAEtH,EAAA,OAAOF,cAAc,CAACsB,IAAI,CAAC,IAAI,CAAC;EACpC;;EAIA;EACA;EACA;EACA;EACA;EACA;;ECtLO,SAASC,oBAAoBA,CAACC,GAAG,EAAEC,WAAW,EAAEC,MAAM,EAAc;EAAA,EAAA,IAAZC,MAAM,GAAAC,SAAA,CAAA3I,MAAA,GAAA,CAAA,IAAA2I,SAAA,CAAA,CAAA,CAAA,KAAAC,SAAA,GAAAD,SAAA,CAAA,CAAA,CAAA,GAAG,CAAC;IACvE,IAAIE,cAAc,GAAGC,CAAC,CAACzH,MAAM,CAACoH,MAAM,EAAE,UAAAM,KAAK,EAAA;EAAA,IAAA,OAAKA,KAAK,CAACR,GAAG,CAAC,GAAGG,MAAM,IAAKF,WAAW;KAAC,CAAA;EACpF,EAAA,OAAOM,CAAC,CAACE,MAAM,CAACH,cAAc,CAAC;EACjC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECDO,SAASI,eAAeA,CAACT,WAAW,EAAEU,gBAAgB,EAAE;IAC7D,IAAIV,WAAW,GAAG,EAAE,EAAE;EACpB;EACA,IAAA,OAAOU,gBAAgB;EACzB;;EAEA;;IAEA,IAAI7C,OAAO,GAAG,CAAC;IACf,IAAI8C,YAAY,GAAGb,oBAAoB,CAAC,MAAM,EAAEE,WAAW,EAAEY,KAAK,CAAC;;EAEnE;;EAEA,EAAA,OAAO/C,OAAO,GAAG8C,YAAY,CAACE,IAAI,IAAIb,WAAW,EAAE;EACjD,IAAA,IAAIc,QAAQ,GAAGd,WAAW,GAAGnC,OAAO;MACpC,IAAIkD,aAAa,GAAGhK,IAAI,CAACU,KAAK,CAACqJ,QAAQ,GAAGH,YAAY,CAACE,IAAI,CAAC;;EAE5D;MACAE,aAAa,GAAIA,aAAa,GAAGJ,YAAY,CAACK,QAAQ,GAAI,CAAC,GACzDjK,IAAI,CAACU,KAAK,CAAC,CAAC,GAAGkJ,YAAY,CAACK,QAAQ,CAAC,GACrCD,aAAa;MAEf,IAAIE,cAAc,GAAGX,CAAC,CAACtJ,MAAM,CAAC,CAAC,EAAE+J,aAAa,CAAC;EAC/C,IAAA,IAAIG,YAAY,GAAGP,YAAY,CAACE,IAAI,GAAGI,cAAc;;EAErD;;EAEApD,IAAAA,OAAO,IAAIqD,YAAY;MACvBR,gBAAgB,CAAC7C,OAAO,IAAIqD,YAAY;EACxCR,IAAAA,gBAAgB,CAACS,SAAS,CAAC3I,IAAI,CAC7B;QACEpC,IAAI,EAAEuK,YAAY,CAACS,IAAI;EACvB5J,MAAAA,MAAM,EAAEmJ,YAAY,CAACK,QAAQ,GAAG,EAAE,GAAGC,cAAc;EACnDf,MAAAA,MAAM,EAAE,CAAC;EACTW,MAAAA,IAAI,EAAEK;EACR,KACF,CAAC;EACH;EAEA,EAAA,OAAOR,gBAAgB;EACzB;;ECzCA,SAASW,eAAeA,CAACrB,WAAW,EAAEiB,cAAc,EAAEf,MAAM,EAAE;EAC5D,EAAA,IAAIF,WAAW,GAAG,EAAE,GAAGE,MAAM,EAAE;EAC7B;EACA,IAAA,OAAO,IAAI;EACb;EAEA,EAAA,IAAIoB,UAAU;IACd,IAAIC,SAAS,GAAG,CAAC;EAEjB,EAAA,IAAIC,aAAa,GAAGlB,CAAC,CAACmB,SAAS,CAACb,KAAK,CAAC;IAEtC,OAAO,CAACU,UAAU,EAAE;EAClBC,IAAAA,SAAS,EAAE;EACXD,IAAAA,UAAU,GAAGhB,CAAC,CAACE,MAAM,CAACgB,aAAa,CAAC;EAEpC,IAAA,IAAKF,UAAU,CAACT,IAAI,GAAGX,MAAM,GAAIF,WAAW,EAAE;EAC5C;QACAwB,aAAa,GAAGlB,CAAC,CAACzH,MAAM,CAAC2I,aAAa,EAAE,UAAAE,IAAI,EAAA;EAAA,QAAA,OAAIA,IAAI,CAACb,IAAI,GAAGS,UAAU,CAACT,IAAI;SAAC,CAAA;EAC5ES,MAAAA,UAAU,GAAG,IAAI;EACnB,KAAC,MAAM,IAAKA,UAAU,CAACN,QAAQ,GAAGC,cAAc,IAAMA,cAAc,GAAGK,UAAU,CAACN,QAAQ,KAAK,CAAE,EAAE;EACjG;QACAQ,aAAa,GAAGlB,CAAC,CAACzH,MAAM,CAAC2I,aAAa,EAAE,UAAAE,IAAI,EAAA;EAAA,QAAA,OAAIA,IAAI,CAACV,QAAQ,GAAGM,UAAU,CAACN,QAAQ;SAAC,CAAA;EACpFM,MAAAA,UAAU,GAAG,IAAI;EACnB;MAEA,IAAIC,SAAS,GAAG,EAAE,EAAE;EAAC,MAAA,MAAM,IAAII,KAAK,CAAAzK,OAAAA,CAAAA,MAAA,CAAS8I,WAAW,EAAA,GAAA,CAAA,CAAA9I,MAAA,CAAI+J,cAAc,EAAA/J,GAAAA,CAAAA,CAAAA,MAAA,CAAIgJ,MAAM,CAAE,CAAC;EAAC;EAC1F;EAEA,EAAA,OAAOoB,UAAU;EACnB;EAEA,SAASM,oBAAoBA,CAACC,eAAe,EAAE;EAC7C,EAAA,OAAOvB,CAAC,CAACwB,MAAM,CAACD,eAAe,CAACE,OAAO,EAAE,UAACC,MAAM,EAAE5C,GAAG,EAAK;EACxD,IAAA,IAAI6C,UAAU,GAAG7C,GAAG,CAAC4B,QAAQ,CAAC,CAAC,CAAC;EAEhC,IAAA,IAAG,CAACgB,MAAM,CAAC5C,GAAG,CAAC8C,KAAK,CAAC,EAAE;EACrBF,MAAAA,MAAM,CAAC5C,GAAG,CAAC8C,KAAK,CAAC,GAAG;EAAEhC,QAAAA,MAAM,EAAE,CAAC;EAAEe,QAAAA,cAAc,EAAEgB;SAAW;EAC9D,KAAC,MAAM;QACLD,MAAM,CAAC5C,GAAG,CAAC8C,KAAK,CAAC,CAAChC,MAAM,IAAI,CAAC;QAC7B8B,MAAM,CAAC5C,GAAG,CAAC8C,KAAK,CAAC,CAACjB,cAAc,GAAGX,CAAC,CAACnI,GAAG,CAAC,CAAC6J,MAAM,CAAC5C,GAAG,CAAC8C,KAAK,CAAC,CAACjB,cAAc,EAAEgB,UAAU,CAAC,CAAC;EAC1F;EAEA,IAAA,OAAOD,MAAM;KACd,EAAE,EAAE,CAAC;EACR;EAEA,SAASG,oBAAoBA,CAACnC,WAAW,EAAE6B,eAAe,EAAEO,eAAe,EAAE;IAC3E,IAAIC,cAAc,GAAG,EAAE;EAEvB,EAAA,IAAIzL,IAAI,GAAGiL,eAAe,CAACE,OAAO,CAACvK,MAAM;;EAEzC;IACA8I,CAAC,CAACnB,OAAO,CAACiD,eAAe,EAAE,UAACE,SAAS,EAAEvC,GAAG,EAAK;EAC7C,IAAA,IAAIwC,YAAY,GAAGV,eAAe,CAACU,YAAY;MAC/C,IAAIC,aAAa,GAAG,CAAC5L,IAAI,GAAG0L,SAAS,CAACpC,MAAM,IAAIqC,YAAY,GAAG,EAAE;EACjE,IAAA,IAAI5B,YAAY,GAAGU,eAAe,CAChCrB,WAAW,GAAGwC,aAAa,EAC3BF,SAAS,CAACrB,cAAc,EACxBqB,SAAS,CAACpC,MAAM,GAAGqC,YACrB,CAAC;EAEDF,IAAAA,cAAc,CAACtC,GAAG,CAAC,GAAGY,YAAY;EACpC,GAAC,CAAC;EAEF,EAAA,OAAO0B,cAAc;EACvB;EAEO,SAASI,sBAAsBA,CAACzC,WAAW,EAAEU,gBAAgB,EAAEmB,eAAe,EAAE;IACrF,IAAI7B,WAAW,GAAG,EAAE,EAAE;EACpB;EACA,IAAA,OAAOU,gBAAgB;EACzB;EAEA,EAAA,IAAI0B,eAAe,GAAGR,oBAAoB,CAACC,eAAe,CAAC;IAC3D,IAAIQ,cAAc,GAAGF,oBAAoB,CAACnC,WAAW,EAAE6B,eAAe,EAAEO,eAAe,CAAC;;EAExF;IACA9B,CAAC,CAACnB,OAAO,CAAC0C,eAAe,CAACE,OAAO,EAAE,UAAAA,OAAO,EAAI;EAC5C,IAAA,IAAIpB,YAAY,GAAG0B,cAAc,CAACN,OAAO,CAACG,KAAK,CAAC;EAChD,IAAA,IAAIQ,YAAY,GAAGX,OAAO,CAACf,QAAQ,CAAC,CAAC,CAAC;EACtC,IAAA,IAAIiB,UAAU,GAAGF,OAAO,CAACf,QAAQ,CAAC,CAAC,CAAC;;EAEpC;EACA,IAAA,IAAI2B,kBAAkB,GAAGV,UAAU,GAAGtB,YAAY,CAACK,QAAQ;MAC3D,IAAI4B,aAAa,GAAGjC,YAAY,CAACE,IAAI,GAAG6B,YAAY,GAAIC,kBAAmB;MAE3EjC,gBAAgB,CAAC7C,OAAO,IAAI+E,aAAa;EACzClC,IAAAA,gBAAgB,CAACS,SAAS,CAAC3I,IAAI,CAC7B;QACEpC,IAAI,EAAEuK,YAAY,CAACS,IAAI;QACvB5J,MAAM,EAAEyK,UAAU,GAAG,EAAE;EACvB/B,MAAAA,MAAM,EAAEwC,YAAY;EACpB7B,MAAAA,IAAI,EAAEF,YAAY,CAACE,IAAI,GAAG8B;EAC5B,KACF,CAAC;EACH,GAAC,CAAC;EAEF,EAAA,OAAOjC,gBAAgB;EACzB;;EC9FA,SAASmC,UAAUA,CAACC,SAAS,EAAEC,SAAS,EAAE;IACxC,OAAOD,SAAS,CAAC1M,IAAI,KAAK2M,SAAS,CAAC3M,IAAI,IACnC0M,SAAS,CAACtL,MAAM,KAAKuL,SAAS,CAACvL,MAAM,IACrCsL,SAAS,CAACjC,IAAI,KAAKkC,SAAS,CAAClC,IAAI;EACxC;EAEA,SAASmC,aAAaA,CAACjB,OAAO,EAAE;EAC9B;IACAA,OAAO,CAAClE,OAAO,IAAI,CAAC;IAEpByC,CAAC,CAACnB,OAAO,CAAC4C,OAAO,CAACZ,SAAS,EAAE,UAAAH,QAAQ,EAAI;MACvCA,QAAQ,CAACxJ,MAAM,IAAI,CAAC;MACpBwJ,QAAQ,CAACH,IAAI,IAAI,CAAC;EACpB,GAAC,CAAC;EACJ;EAEA,SAASoC,eAAeA,CAAClB,OAAO,EAAE;EAChC;IACAA,OAAO,CAAClE,OAAO,IAAI,CAAC;IAEpByC,CAAC,CAACnB,OAAO,CAAC4C,OAAO,CAACZ,SAAS,EAAE,UAAAH,QAAQ,EAAI;MACvCA,QAAQ,CAACd,MAAM,IAAI,CAAC;EACtB,GAAC,CAAC;EACJ;EAEA,SAASgD,eAAeA,CAACnB,OAAO,EAAE;EAChCA,EAAAA,OAAO,CAACZ,SAAS,GAAGY,OAAO,CAACZ,SAAS,CAACW,MAAM,CAAC,UAACqB,IAAI,EAAEnC,QAAQ,EAAK;EAC/D,IAAA,IAAIoC,eAAe,GAAGD,IAAI,CAAC3L,MAAM;MAEjC,IAAG4L,eAAe,KAAK,CAAC,EAAE;EACxBD,MAAAA,IAAI,CAAC3K,IAAI,CAACwI,QAAQ,CAAC;EACnB,MAAA,OAAOmC,IAAI;EACb;MAEA,IAAIN,UAAU,CAACM,IAAI,CAACC,eAAe,GAAE,CAAC,CAAC,EAAEpC,QAAQ,CAAC,EAAE;EAClD;QACAmC,IAAI,CAACC,eAAe,GAAG,CAAC,CAAC,CAAClD,MAAM,IAAIc,QAAQ,CAACd,MAAM;EACrD,KAAC,MAAM;EACLiD,MAAAA,IAAI,CAAC3K,IAAI,CAACwI,QAAQ,CAAC;EACrB;EAEA,IAAA,OAAOmC,IAAI;KACZ,EAAE,EAAE,CAAC;;EAEN;;EAEA,EAAA,OAAOpB,OAAO;EAChB;EAIO,SAASsB,eAAeA,CAACxF,OAAO,EAAoD;IAAA,IAAlD6C,gBAAgB,GAAAP,SAAA,CAAA3I,MAAA,GAAA2I,CAAAA,IAAAA,SAAA,CAAAC,CAAAA,CAAAA,KAAAA,SAAA,GAAAD,SAAA,CAAG,CAAA,CAAA,GAAA;EAAEtC,IAAAA,OAAO,EAAE,CAAC;EAAEsD,IAAAA,SAAS,EAAE;KAAI;IACvF,IAAItD,OAAO,GAAG,EAAE,EAAE;EAChB;EACA,IAAA,OAAO6C,gBAAgB;EACzB;;EAEA;;EAEA,EAAA,IAAII,QAAQ,GAAGjD,OAAO,GAAG6C,gBAAgB,CAAC7C,OAAO;IACjD,IAAIgE,eAAe,GAAG/B,oBAAoB,CAAC,SAAS,EAAEgB,QAAQ,EAAEwC,QAAQ,CAAC;;EAEzE;;EAEA,EAAA,IAAIzB,eAAe,CAAC0B,MAAM,KAAK,IAAI,EAAE;EACnC,IAAA,OAAO9C,eAAe,CAACK,QAAQ,EAAEJ,gBAAgB,CAAC;EACpD,GAAC,MAAM;EACL,IAAA,OAAO+B,sBAAsB,CAAC3B,QAAQ,EAAEJ,gBAAgB,EAAEmB,eAAe,CAAC;EAC5E;EACF;EAEO,SAAS1D,eAAeA,CAACN,OAAO,EAAE;IACvC,IAAI,CAACA,OAAO,EAAE;EAAE,IAAA,MAAM,IAAI8D,KAAK,CAAC,eAAe,CAAC;EAAE;EAElD,EAAA,IAAII,OAAO,GAAGsB,eAAe,CAACxF,OAAO,CAAC;EAEtC,EAAA,OAAQkE,OAAO,CAAClE,OAAO,GAAIA,OAAO,GAAG,CAAE,IAAMkE,OAAO,CAAClE,OAAO,IAAI,EAAG,EAAE;EACnE,IAAA,QAAOyC,CAAC,CAACtJ,MAAM,CAAC,CAAC,EAAC,CAAC,CAAC;EAClB,MAAA,KAAK,CAAC;UACJgM,aAAa,CAACjB,OAAO,CAAC;EACtB,QAAA;EACF,MAAA,KAAK,CAAC;UACJkB,eAAe,CAAClB,OAAO,CAAC;EACxB,QAAA;EACF,MAAA,KAAK,CAAC;EACJ;EACAsB,QAAAA,eAAe,CAACxF,OAAO,EAAEkE,OAAO,CAAC;EACjC,QAAA;EACJ;EACF;EAEA,EAAA,OAAOlE,OAAO,GAAGkE,OAAO,CAAClE,OAAO,IAAI,EAAE,EAAE;EACtCwF,IAAAA,eAAe,CAACxF,OAAO,EAAEkE,OAAO,CAAC;EACnC;EAEAA,EAAAA,OAAO,GAAGmB,eAAe,CAACnB,OAAO,CAAC;EAElC,EAAA,OAAOA,OAAO;EAChB;;;;;;;;;;"}